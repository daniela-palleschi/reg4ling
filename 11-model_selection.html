<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniela Palleschi">
<meta name="dcterms.date" content="2024-02-09">

<title>Regression for Linguists - 12&nbsp; Model selection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./12-model_selection_example.html" rel="next">
<link href="./10-shrinkage.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: {autoNumber: "AMS"} },
  tex2jax: {inlineMath: [ ['$','$'], ["\\(","\\)"] ]}
});
</script>

<!-- This is what works with Quarto -->
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Regression for Linguists - 12&nbsp; Model selection">
<meta name="twitter:description" content="Strolling through the garden of forking paths">
<meta name="twitter:image" content="media/sonderegger_2023_convergence_table10.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Regression for Linguists</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://daniela-palleschi.github.io/" rel="" target=""><i class="bi bi-home" role="img">
</i> 
 <span class="menu-text">D. Palleschi</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/daniela-palleschi/reg4ling" rel="" target=""><i class="bi bi-github" role="img" aria-label="Source Code">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://moodle.hu-berlin.de/course/view.php?id=121978" rel="" target=""><i class="bi bi-life-preserver" role="img" aria-label="Course Moodle">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
    <a href="./Regression-for-Linguists.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-independence_assumption.html">Mixed models</a></li><li class="breadcrumb-item"><a href="./11-model_selection.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model selection</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course_overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources and Set-up</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Day 1: Simple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-equation_of_a_line.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Understanding straight lines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-simple_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-continuous_predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Continuous predictors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Day 2: Multiple regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-multiple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multiple Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-categorical_predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Categorical predictors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Day 3: Logistic regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-logistic_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Report 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reports/report 1/report1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Report 1</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Mixed models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-independence_assumption.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Independence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-mixed_models1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Random intercepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-mixed_models2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Random slopes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-shrinkage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Shrinkage and Partial Pooling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-model_selection.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-model_selection_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Model selection: Example</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Report 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reports/report 2/report2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Report 2</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#review-random-intercepts-and-slopes" id="toc-review-random-intercepts-and-slopes" class="nav-link active" data-scroll-target="#review-random-intercepts-and-slopes"><span class="header-section-number">12.1</span> Review: random intercepts and slopes</a></li>
  <li><a href="#history-of-lmms-revisited" id="toc-history-of-lmms-revisited" class="nav-link" data-scroll-target="#history-of-lmms-revisited"><span class="header-section-number">12.2</span> History of LMMs revisited</a>
  <ul class="collapse">
  <li><a href="#keep-it-maximal" id="toc-keep-it-maximal" class="nav-link" data-scroll-target="#keep-it-maximal"><span class="header-section-number">12.2.1</span> 2013: Keep it maximal</a></li>
  <li><a href="#parsimonious-models" id="toc-parsimonious-models" class="nav-link" data-scroll-target="#parsimonious-models"><span class="header-section-number">12.2.2</span> 2015 &amp; 2017: Parsimonious models</a></li>
  </ul></li>
  <li><a href="#model-building" id="toc-model-building" class="nav-link" data-scroll-target="#model-building"><span class="header-section-number">12.3</span> Model building</a>
  <ul class="collapse">
  <li><a href="#choosing-predictors" id="toc-choosing-predictors" class="nav-link" data-scroll-target="#choosing-predictors"><span class="header-section-number">12.3.1</span> Choosing predictors</a></li>
  <li><a href="#choosing-a-maximal-random-effects-structure-res" id="toc-choosing-a-maximal-random-effects-structure-res" class="nav-link" data-scroll-target="#choosing-a-maximal-random-effects-structure-res"><span class="header-section-number">12.3.2</span> Choosing a maximal random effects structure (RES)</a></li>
  <li><a href="#observations-per-cell" id="toc-observations-per-cell" class="nav-link" data-scroll-target="#observations-per-cell"><span class="header-section-number">12.3.3</span> Observations per cell</a></li>
  <li><a href="#data-structure" id="toc-data-structure" class="nav-link" data-scroll-target="#data-structure"><span class="header-section-number">12.3.4</span> Data structure</a></li>
  </ul></li>
  <li><a href="#variability-in-methods" id="toc-variability-in-methods" class="nav-link" data-scroll-target="#variability-in-methods"><span class="header-section-number">12.4</span> Variability in methods</a>
  <ul class="collapse">
  <li><a href="#researcher-degrees-of-freedom" id="toc-researcher-degrees-of-freedom" class="nav-link" data-scroll-target="#researcher-degrees-of-freedom"><span class="header-section-number">12.4.1</span> Researcher degrees of freedom</a></li>
  <li><a href="#justify-and-document" id="toc-justify-and-document" class="nav-link" data-scroll-target="#justify-and-document"><span class="header-section-number">12.4.2</span> Justify and document</a></li>
  </ul></li>
  <li><a href="#a-practical-example" id="toc-a-practical-example" class="nav-link" data-scroll-target="#a-practical-example"><span class="header-section-number">12.5</span> A practical example</a>
  <ul class="collapse">
  <li><a href="#set-up" id="toc-set-up" class="nav-link" data-scroll-target="#set-up"><span class="header-section-number">12.5.1</span> Set-up</a></li>
  <li><a href="#start-maximal" id="toc-start-maximal" class="nav-link" data-scroll-target="#start-maximal"><span class="header-section-number">12.5.2</span> Start maximal</a></li>
  <li><a href="#convergence-issues" id="toc-convergence-issues" class="nav-link" data-scroll-target="#convergence-issues"><span class="header-section-number">12.5.3</span> Convergence issues</a></li>
  <li><a href="#non-intrusive-methods" id="toc-non-intrusive-methods" class="nav-link" data-scroll-target="#non-intrusive-methods"><span class="header-section-number">12.5.4</span> Non-intrusive methods</a></li>
  <li><a href="#intrusive-methods" id="toc-intrusive-methods" class="nav-link" data-scroll-target="#intrusive-methods"><span class="header-section-number">12.5.5</span> Intrusive methods</a></li>
  <li><a href="#comparing-to-bad-models" id="toc-comparing-to-bad-models" class="nav-link" data-scroll-target="#comparing-to-bad-models"><span class="header-section-number">12.5.6</span> Comparing to ‘bad’ models</a></li>
  <li><a href="#reporting" id="toc-reporting" class="nav-link" data-scroll-target="#reporting"><span class="header-section-number">12.5.7</span> Reporting</a></li>
  </ul></li>
  <li><a href="#alternatives-to-lme4" id="toc-alternatives-to-lme4" class="nav-link" data-scroll-target="#alternatives-to-lme4"><span class="header-section-number">12.6</span> Alternatives to <code>lme4</code></a></li>
  <li><a href="#important-terms" id="toc-important-terms" class="nav-link" data-scroll-target="#important-terms">Important terms</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model selection</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Strolling through the garden of forking paths</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Daniela Palleschi </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Humboldt-Universität zu Berlin
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 9, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 11, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Under construction
</div>
</div>
<div class="callout-body-container callout-body">
<p>This chapter is not fully translated from bullet points (from my slides) to prose. This will happen eventually (hopefully by spring 2024).</p>
</div>
</div>
<section id="learning-objectives" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<p>Today we will learn about…</p>
<ul>
<li>the history of mixed models (again)</li>
<li>strategies for model selection</li>
<li>variability in model selection</li>
</ul>
<p>and how to…</p>
<ul>
<li>apply remedies for nonconvergence</li>
<li>reduce our RES with a data-driven approach</li>
<li>compare a parsimonious model to maximal and intercept-only models</li>
</ul>
</section>
<section id="resources" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="resources">Resources</h2>
<ul>
<li>relevant papers for this topic
<ul>
<li><span class="citation" data-cites="barr_random_maximal_2013">Barr et al. (<a href="00-course_overview.html#ref-barr_random_maximal_2013" role="doc-biblioref">2013</a>)</span></li>
<li><span class="citation" data-cites="bates_parsimonious_2015">Bates et al. (<a href="00-course_overview.html#ref-bates_parsimonious_2015" role="doc-biblioref">2015</a>)</span></li>
<li><span class="citation" data-cites="matuschek_balancing_2017">Matuschek et al. (<a href="00-course_overview.html#ref-matuschek_balancing_2017" role="doc-biblioref">2017</a>)</span></li>
<li><span class="citation" data-cites="brauer_linear_2018">Brauer &amp; Curtin (<a href="00-course_overview.html#ref-brauer_linear_2018" role="doc-biblioref">2018</a>)</span></li>
<li><span class="citation" data-cites="meteyard_best_2020">Meteyard &amp; Davies (<a href="00-course_overview.html#ref-meteyard_best_2020" role="doc-biblioref">2020</a>)</span></li>
</ul></li>
<li>practical resources covered in the practical application:
<ul>
<li>Sections 10.3-5 in <span class="citation" data-cites="sonderegger_regression_2023">Sonderegger (<a href="00-course_overview.html#ref-sonderegger_regression_2023" role="doc-biblioref">2023</a>)</span></li>
<li>Section 15.7.3 ‘Convergence Issues’ in <span class="citation" data-cites="winter_statistics_2019">Winter (<a href="00-course_overview.html#ref-winter_statistics_2019" role="doc-biblioref">2019</a>)</span></li>
<li><span class="citation" data-cites="brauer_linear_2018">Brauer &amp; Curtin (<a href="00-course_overview.html#ref-brauer_linear_2018" role="doc-biblioref">2018</a>)</span></li>
<li><span class="citation" data-cites="meteyard_best_2020">Meteyard &amp; Davies (<a href="00-course_overview.html#ref-meteyard_best_2020" role="doc-biblioref">2020</a>)</span></li>
</ul></li>
<li>we will continue using the data from <span class="citation" data-cites="biondo_yesterday_2022">Biondo et al. (<a href="00-course_overview.html#ref-biondo_yesterday_2022" role="doc-biblioref">2022</a>)</span></li>
</ul>
</section>
<section id="review-random-intercepts-and-slopes" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="review-random-intercepts-and-slopes"><span class="header-section-number">12.1</span> Review: random intercepts and slopes</h2>
<ul>
<li>violation of independence assumption –&gt; increased Type I error (false positive)
<ul>
<li>include random effects per plausible grouping factor <span class="citation" data-cites="barr_random_maximal_2013">(herein “unit,” à la <a href="00-course_overview.html#ref-barr_random_maximal_2013" role="doc-biblioref">Barr et al., 2013</a>)</span></li>
</ul></li>
<li>random-intercepts only models –&gt; increased Type I error (false positive)
<ul>
<li>add random slopes per within-unit manipulation, i.e., “maximal” models <span class="citation" data-cites="barr_random_maximal_2013">(<a href="00-course_overview.html#ref-barr_random_maximal_2013" role="doc-biblioref">Barr et al., 2013</a>)</span></li>
</ul></li>
<li>but such models often fail to “converge”
<ul>
<li>and have been shown to increase Type II error (false negative) <span class="citation" data-cites="bates_parsimonious_2015 matuschek_balancing_2017">(<a href="00-course_overview.html#ref-bates_parsimonious_2015" role="doc-biblioref">Bates et al., 2015</a>; <a href="00-course_overview.html#ref-matuschek_balancing_2017" role="doc-biblioref">Matuschek et al., 2017</a>)</span></li>
</ul></li>
<li>some questions remain:
<ul>
<li>how to define our maximal model</li>
<li>how to handle convergence issues</li>
</ul></li>
</ul>
</section>
<section id="history-of-lmms-revisited" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="history-of-lmms-revisited"><span class="header-section-number">12.2</span> History of LMMs revisited</h2>
<ul>
<li>recall <span class="citation" data-cites="clark_language-as-fixed-effect_1973">Clark (<a href="00-course_overview.html#ref-clark_language-as-fixed-effect_1973" role="doc-biblioref">1973</a>)</span>’s language-as-fixed-effect fallacy and the issue of generalisability <span class="citation" data-cites="winter_independence_2021 yarkoni_generalizability_2022">(see also <a href="00-course_overview.html#ref-winter_independence_2021" role="doc-biblioref">Winter &amp; Grice, 2021</a>; <a href="00-course_overview.html#ref-yarkoni_generalizability_2022" role="doc-biblioref">Yarkoni, 2022</a>)</span></li>
<li><span class="citation" data-cites="baayen_mixed-effects_2008">Baayen et al. (<a href="00-course_overview.html#ref-baayen_mixed-effects_2008" role="doc-biblioref">2008</a>)</span> motivated LMM’s for linguistic data in the JML special issue
<ul>
<li>effect: everybody adopted random-intercepts only models</li>
</ul></li>
<li><span class="citation" data-cites="barr_random_maximal_2013">Barr et al. (<a href="00-course_overview.html#ref-barr_random_maximal_2013" role="doc-biblioref">2013</a>)</span>: random-intercepts only models are overconfident, “keep it maximal!”
<ul>
<li>effect: everybody adopted maximal models</li>
</ul></li>
<li><span class="citation" data-cites="matuschek_balancing_2017">Matuschek et al. (<a href="00-course_overview.html#ref-matuschek_balancing_2017" role="doc-biblioref">2017</a>)</span> and <span class="citation" data-cites="bates_parsimonious_2015">Bates et al. (<a href="00-course_overview.html#ref-bates_parsimonious_2015" role="doc-biblioref">2015</a>)</span>: maximal models are underconfident and lower statistical power! Use data-driven model selection to find a “parsimonious” model!
<ul>
<li>effect: some people adopt this method, but many psycholinguists just want a “recipe” to follow</li>
</ul></li>
</ul>
<section id="keep-it-maximal" class="level3" data-number="12.2.1">
<h3 data-number="12.2.1" class="anchored" data-anchor-id="keep-it-maximal"><span class="header-section-number">12.2.1</span> 2013: Keep it maximal</h3>
<blockquote class="blockquote">
<p>A maximal model should optimize generalization of the findings to new subjects and new items.</p>
<p>– <span class="citation" data-cites="barr_random_maximal_2013">Barr et al. (<a href="00-course_overview.html#ref-barr_random_maximal_2013" role="doc-biblioref">2013</a>)</span>, p.&nbsp;261</p>
</blockquote>
<ul>
<li>random-intercepts-only models tend to be underpowered</li>
<li>for this reason, <span class="citation" data-cites="barr_random_maximal_2013">Barr et al. (<a href="00-course_overview.html#ref-barr_random_maximal_2013" role="doc-biblioref">2013</a>)</span> suggested using a maximal random effects structure justified by the experimental design</li>
</ul>
</section>
<section id="parsimonious-models" class="level3" data-number="12.2.2">
<h3 data-number="12.2.2" class="anchored" data-anchor-id="parsimonious-models"><span class="header-section-number">12.2.2</span> 2015 &amp; 2017: Parsimonious models</h3>
<blockquote class="blockquote">
<p>[W]hile the maximal model indeed performs well as far as Type I error rates were concerned, power decreases substantially with model complexity.</p>
<p>— <span class="citation" data-cites="matuschek_balancing_2017">Matuschek et al. (<a href="00-course_overview.html#ref-matuschek_balancing_2017" role="doc-biblioref">2017</a>)</span>, p.&nbsp;310-311</p>
</blockquote>
<ul>
<li>there is a trade-off between Type I (overconfidence) and Type II error (underconfidence)</li>
<li>i.e., maximal models can lead to over-fitting
<ul>
<li>lowers statistical power, which increases Type II error (false rejection)</li>
</ul></li>
<li>but we should strive for the most <em>parsimonious</em> model
<ul>
<li>parsimonous models are a compromise between the maximal model justified by your design and theory, and a given data set</li>
</ul></li>
<li>best way to maintain low Type I and II error: collect lots of data</li>
</ul>
</section>
</section>
<section id="model-building" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="model-building"><span class="header-section-number">12.3</span> Model building</h2>
<blockquote class="blockquote">
<p>Every statistical model is a description of some real or hypothetical state of affairs in the world.</p>
<p>– <span class="citation" data-cites="yarkoni_generalizability_2022">Yarkoni (<a href="00-course_overview.html#ref-yarkoni_generalizability_2022" role="doc-biblioref">2022</a>)</span>, p.&nbsp;2</p>
</blockquote>
<ul>
<li>our models reflect not only our hypotheses or effects of interest, but any other plausible or known co-variates</li>
<li>our predictors should reflect our research questions or theories tested
<ul>
<li>plus any plausible or previously motivated co-variates (e.g., trial order)</li>
<li>plus known sources of nonindependence, i.e., our random effects</li>
</ul></li>
</ul>
<section id="choosing-predictors" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="choosing-predictors"><span class="header-section-number">12.3.1</span> Choosing predictors</h3>
<ul>
<li>your model should be defined <em>a priori</em>
<ul>
<li>i.e., you should define what predictors you will include and any covariates</li>
<li>e.g., if you have a prediction about the effect of phonological neighbours on vowel duration
<ul>
<li>define what phonological characteristics you will include (e.g., place of articulation? manner?)</li>
<li>these should be related to specific hypotheses/research questions</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="choosing-a-maximal-random-effects-structure-res" class="level3" data-number="12.3.2">
<h3 data-number="12.3.2" class="anchored" data-anchor-id="choosing-a-maximal-random-effects-structure-res"><span class="header-section-number">12.3.2</span> Choosing a maximal random effects structure (RES)</h3>
<ul>
<li>how do we define our maximal model? Some tips from <span class="citation" data-cites="barr_random_maximal_2013">Barr et al. (<a href="00-course_overview.html#ref-barr_random_maximal_2013" role="doc-biblioref">2013</a>)</span>
<ul>
<li>between-unit factor (e.g., age): include random intercept only</li>
<li>within-unit factor with multiple observations per unit-level (e.g., age in longitudinal data): include random slopes</li>
</ul></li>
<li>all factors in an interaction are within-unit: include by-unit random slopes for interaction terms</li>
</ul>
<section id="example-biondo_yesterday_2022" class="level4" data-number="12.3.2.1">
<h4 data-number="12.3.2.1" class="anchored" data-anchor-id="example-biondo_yesterday_2022"><span class="header-section-number">12.3.2.1</span> Example: <span class="citation" data-cites="biondo_yesterday_2022">Biondo et al. (<a href="00-course_overview.html#ref-biondo_yesterday_2022" role="doc-biblioref">2022</a>)</span></h4>
<ul>
<li><span class="citation" data-cites="biondo_yesterday_2022">Biondo et al. (<a href="00-course_overview.html#ref-biondo_yesterday_2022" role="doc-biblioref">2022</a>)</span>: 2x2 design
<ul>
<li>verb-tense (past, future) and grammaticality (grammatical, ungrammatical)</li>
<li>repeated-measures: within-participant and -item design
<ul>
<li>so we should have by-participant and -item random intercepts (multiple observations per unit level)</li>
</ul></li>
<li>each participant and item contributed multiple data points <em>per condition</em> (i.e., tense and grammaticality were manipulated within each unit level)
<ul>
<li>so we should have varying tense and grammaticality slopes by- item and -participant</li>
</ul></li>
</ul></li>
</ul>
<div class="cell" data-output-location="fragment">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>item),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="observations-per-cell" class="level3" data-number="12.3.3">
<h3 data-number="12.3.3" class="anchored" data-anchor-id="observations-per-cell"><span class="header-section-number">12.3.3</span> Observations per cell</h3>
<ul>
<li>if there is only a single observation per cell, e.g., you collected one observation from each participant per condition, then you can’t fit random intercepts or slopes</li>
<li>ideally you would have at least 5 observations per cell (per unit level per condition, e.g., each participant has at least 5 observations per condition)</li>
<li>this is also a question of statistical power</li>
</ul>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obvz per sj per condition</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df_biondo <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sj, verb_t, gramm) <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
      n    nn
  &lt;int&gt; &lt;int&gt;
1    16   240</code></pre>
</div>
</div>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obvz per item per condition</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_biondo <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item, verb_t, gramm) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
      n    nn
  &lt;int&gt; &lt;int&gt;
1    10   384</code></pre>
</div>
</div>
</section>
<section id="data-structure" class="level3" data-number="12.3.4">
<h3 data-number="12.3.4" class="anchored" data-anchor-id="data-structure"><span class="header-section-number">12.3.4</span> Data structure</h3>
<ul>
<li>random effects must be factors/categorical</li>
<li>single observation per row
<ul>
<li>generally speaking, there should be n(participants) * n(items) rows</li>
<li>every fixed or random effect in your model should correspond to a column in your dataset</li>
</ul></li>
</ul>
</section>
</section>
<section id="variability-in-methods" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="variability-in-methods"><span class="header-section-number">12.4</span> Variability in methods</h2>
<ul>
<li><span class="citation" data-cites="meteyard_best_2020">Meteyard &amp; Davies (<a href="00-course_overview.html#ref-meteyard_best_2020" role="doc-biblioref">2020</a>)</span>
<ul>
<li>survey of (psychology) researchers</li>
<li>review of papers using LMMs</li>
</ul></li>
<li>insecurity in researchers re: choosing models</li>
<li>great variation in papers in how models are built and reported</li>
</ul>
<section id="researcher-degrees-of-freedom" class="level3" data-number="12.4.1">
<h3 data-number="12.4.1" class="anchored" data-anchor-id="researcher-degrees-of-freedom"><span class="header-section-number">12.4.1</span> Researcher degrees of freedom</h3>
<blockquote class="blockquote">
<p>What we hope to make clear is that there is no single correct way in which LMM analyses should be conducted, and this has important implications for how the reporting of LMMs should be approached.</p>
<p>— <span class="citation" data-cites="meteyard_best_2020">Meteyard &amp; Davies (<a href="00-course_overview.html#ref-meteyard_best_2020" role="doc-biblioref">2020</a>)</span>, p.&nbsp;9</p>
</blockquote>
<ul>
<li>the problem:
<ul>
<li>‘researcher degrees of freedom’ <span class="citation" data-cites="simmons_false-positive_2011">(<a href="00-course_overview.html#ref-simmons_false-positive_2011" role="doc-biblioref">Simmons et al., 2011</a>)</span>, or ‘the garden of forking paths’ <span class="citation" data-cites="gelman_garden_2013">(<a href="00-course_overview.html#ref-gelman_garden_2013" role="doc-biblioref">Gelman &amp; Loken, 2013</a>)</span></li>
<li>the same data can be analysed in a variety of ways</li>
</ul></li>
<li>this leads to insecurity for many researchers</li>
</ul>
</section>
<section id="justify-and-document" class="level3" data-number="12.4.2">
<h3 data-number="12.4.2" class="anchored" data-anchor-id="justify-and-document"><span class="header-section-number">12.4.2</span> Justify and document</h3>
<blockquote class="blockquote">
<p>Replicability and reproducibility are critical for scientific progress, so the way in which researchers have implemented LMM analysis must be entirely transparent. We also hope that the sharing of analysis code and data becomes widespread, enabling the periodic re-analysis of raw data over multiple experiments as studies accumulate over time.</p>
<p>— <span class="citation" data-cites="meteyard_best_2020">Meteyard &amp; Davies (<a href="00-course_overview.html#ref-meteyard_best_2020" role="doc-biblioref">2020</a>)</span>, p.&nbsp;9</p>
</blockquote>
<ul>
<li>the (partial) solution:
<ul>
<li>make model building/selection decisions a priori</li>
<li>be transparent</li>
<li>share your data and code</li>
</ul></li>
</ul>
</section>
</section>
<section id="a-practical-example" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="a-practical-example"><span class="header-section-number">12.5</span> A practical example</h2>
<p>We’ll now look at an example of a model that encounters convergence issues, and take some steps to reach convergence. We are considering a case where your predictors and covariates are already selected, and will focus on selecting model options and random effects structure that achieve model convergence.</p>
<section id="set-up" class="level3" data-number="12.5.1">
<h3 data-number="12.5.1" class="anchored" data-anchor-id="set-up"><span class="header-section-number">12.5.1</span> Set-up</h3>
<p>We first need to set up our environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## suppress scientific notation</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-packages" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="load-packages">Load packages</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## load libraries</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>               tidyverse,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>               here,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>               janitor,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>               <span class="do">## new packages for mixed models:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>               lme4,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>               lmerTest,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>               broom.mixed,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>               lattice)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lmer <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span>lmer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="load-data">Load data</h4>
<ul>
<li>data from <span class="citation" data-cites="biondo_yesterday_2022">Biondo et al. (<a href="00-course_overview.html#ref-biondo_yesterday_2022" role="doc-biblioref">2022</a>)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_biondo <span class="ot">&lt;-</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"Biondo.Soilemezidi.Mancini_dataset_ET.csv"</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">"Latin1"</span>) <span class="do">### for special characters in Spanish</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">|&gt;</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gramm =</span> <span class="fu">ifelse</span>(gramm <span class="sc">==</span> <span class="st">"0"</span>, <span class="st">"ungramm"</span>, <span class="st">"gramm"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as_factor) <span class="sc">|&gt;</span> <span class="do">## all character variables as factors</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(adv_type <span class="sc">==</span> <span class="st">"Deic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-contrasts" class="level4" data-number="12.5.1.1">
<h4 data-number="12.5.1.1" class="anchored" data-anchor-id="set-contrasts"><span class="header-section-number">12.5.1.1</span> Set contrasts</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_biondo<span class="sc">$</span>verb_t) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="sc">+</span><span class="fl">0.5</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_biondo<span class="sc">$</span>gramm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="sc">+</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_biondo<span class="sc">$</span>verb_t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]
Past   -0.5
Future  0.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_biondo<span class="sc">$</span>gramm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]
gramm   -0.5
ungramm  0.5</code></pre>
</div>
</div>
</section>
</section>
<section id="start-maximal" class="level3" data-number="12.5.2">
<h3 data-number="12.5.2" class="anchored" data-anchor-id="start-maximal"><span class="header-section-number">12.5.2</span> Start maximal</h3>
<ul>
<li>model structure should be decided <em>a priori</em>
<ul>
<li>included fixed (predictors and covariates) and random effects</li>
</ul></li>
</ul>
<section id="maximal-model" class="level4" data-number="12.5.2.1">
<h4 data-number="12.5.2.1" class="anchored" data-anchor-id="maximal-model"><span class="header-section-number">12.5.2.1</span> Maximal model</h4>
<ul>
<li>starting point: most maximal model structure justified by your design
<ul>
<li>if this converges, great!</li>
<li>if it doesn’t, what does this mean and what should we do?</li>
</ul></li>
</ul>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>item),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>we get a warning of singular fit</li>
</ul>
</section>
</section>
<section id="convergence-issues" class="level3" data-number="12.5.3">
<h3 data-number="12.5.3" class="anchored" data-anchor-id="convergence-issues"><span class="header-section-number">12.5.3</span> Convergence issues</h3>
<ul>
<li>“<em>Convergence is not a metric of model quality</em>” <span class="citation" data-cites="sonderegger_regression_2023">(<a href="00-course_overview.html#ref-sonderegger_regression_2023" role="doc-biblioref">Sonderegger, 2023, p. 365</a>, Box 10.2)</span>
<ul>
<li>convergence does not always indicate “overfitting” or “overparameterisation”</li>
<li>can also be due to optimizer choice
<ul>
<li>since default optimizer was changed to <code>nloptwrap</code> from <code>bobyqa</code>, there seem to be more ‘false positive’ convergence warnings</li>
</ul></li>
</ul></li>
<li>false-positive convergence: you get a convergence warning, but changing the optimizer and/or iteration count does not produce a warning</li>
<li>false-negative convergence: you do not get a warning, but your variance-covariance matrix might indicate overfitting</li>
</ul>
<section id="nonconvergence-remedies" class="level4" data-number="12.5.3.1">
<h4 data-number="12.5.3.1" class="anchored" data-anchor-id="nonconvergence-remedies"><span class="header-section-number">12.5.3.1</span> Nonconvergence remedies</h4>
<ul>
<li>unfortunately there is no one “right” way to deal with convergence issues
<ul>
<li>important is to transparently report and justify your method</li>
</ul></li>
<li>Table 17 in <span class="citation" data-cites="brauer_linear_2018">Brauer &amp; Curtin (<a href="00-course_overview.html#ref-brauer_linear_2018" role="doc-biblioref">2018</a>)</span> (p.&nbsp;404) suggests 20 remedies, whittled down to 10 suggestions in <span class="citation" data-cites="sonderegger_regression_2023">Sonderegger (<a href="00-course_overview.html#ref-sonderegger_regression_2023" role="doc-biblioref">2023</a>)</span></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="fig-table10" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="media/sonderegger_2023_convergence_table10.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;12.1: From <span class="citation" data-cites="sonderegger_regression_2023">Sonderegger (<a href="00-course_overview.html#ref-sonderegger_regression_2023" role="doc-biblioref">2023</a>)</span>, p.&nbsp;366</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="intrusive-vs.-non-intrusive-remedies" class="level4" data-number="12.5.3.2">
<h4 data-number="12.5.3.2" class="anchored" data-anchor-id="intrusive-vs.-non-intrusive-remedies"><span class="header-section-number">12.5.3.2</span> Intrusive vs.&nbsp;Non-intrusive remedies</h4>
<ul>
<li><p>non-intrusive remedies amount to checking/adjusting data and model specifications</p></li>
<li><p>intrusive remedies involve reducing random effects structure</p>
<ul>
<li>there are different schools of thought
<ul>
<li>random-intercepts only: increased Type I error rate = overconfident estimates</li>
<li>maximal-but-singular-fit model <span class="citation" data-cites="barr_random_maximal_2013">(<a href="00-course_overview.html#ref-barr_random_maximal_2013" role="doc-biblioref">Barr et al., 2013</a>)</span>: reduces power = underconfident estimates</li>
<li>data-driven approach <span class="citation" data-cites="bates_parsimonious_2015">(<a href="00-course_overview.html#ref-bates_parsimonious_2015" role="doc-biblioref">Bates et al., 2015</a>)</span>: can lose the forest for the trees, e.g., removing random slopes for predictors of interest</li>
</ul></li>
</ul></li>
<li><p>each strategy has its drawback</p>
<ul>
<li>important is to choose your strategy <em>a priori</em> and transparently report and justify your strategy</li>
<li>even better: share/publish your data and code, which should be reproducible</li>
</ul></li>
</ul>
</section>
<section id="convergence" class="level4" data-number="12.5.3.3">
<h4 data-number="12.5.3.3" class="anchored" data-anchor-id="convergence"><span class="header-section-number">12.5.3.3</span> <code>?convergence</code></h4>
<ul>
<li>type <code>?convergence</code> in the Console and read the vignette
<ul>
<li>what suggestions does it make?</li>
</ul></li>
<li>compare this to <code>?isSingular</code></li>
</ul>
</section>
</section>
<section id="non-intrusive-methods" class="level3" data-number="12.5.4">
<h3 data-number="12.5.4" class="anchored" data-anchor-id="non-intrusive-methods"><span class="header-section-number">12.5.4</span> Non-intrusive methods</h3>
<ul>
<li>check your data structure/variables
<ul>
<li>check model assumptions (e.g., normality, missing transformations of variables)</li>
<li>check your RES is justified by your experimental design/data structure</li>
<li>centre your predictors (e.g., sum contrasts, or centring/standardizing) to reduce multicollinearity; reduces collinearity in the random effects (a possible source of nonconvergence)</li>
<li>check observations per cell (e.g., is there a participant very few observations, or few observations per one condition? Should be at least &gt;5 per cell)</li>
</ul></li>
<li>alter model controls:
<ul>
<li>increase iterations</li>
<li>check optimizer</li>
</ul></li>
</ul>
<section id="check-optimzer" class="level4" data-number="12.5.4.1">
<h4 data-number="12.5.4.1" class="anchored" data-anchor-id="check-optimzer"><span class="header-section-number">12.5.4.1</span> Check optimzer</h4>
<ul>
<li>optimizer
<ul>
<li><code>lme4::allFit(model)</code> (can take a while to run)</li>
</ul></li>
</ul>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>all_fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">allFit</span>(fit_verb_fp_mm)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="do">## bobyqa : boundary (singular) fit: see help('isSingular')</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [OK]</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Nelder_Mead : [OK]</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="do">## nlminbwrap : boundary (singular) fit: see help('isSingular')</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [OK]</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="do">## nmkbw : [OK]</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="do">## optimx.L-BFGS-B : boundary (singular) fit: see help('isSingular')</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [OK]</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="do">## nloptwrap.NLOPT_LN_NELDERMEAD : boundary (singular) fit: see help('isSingular')</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [OK]</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="do">## nloptwrap.NLOPT_LN_BOBYQA : boundary (singular) fit: see help('isSingular')</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [OK]</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="do">## There were 11 warnings (use warnings() to see them)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="optimizers" class="level4" data-number="12.5.4.2">
<h4 data-number="12.5.4.2" class="anchored" data-anchor-id="optimizers"><span class="header-section-number">12.5.4.2</span> Optimizers</h4>
<ul>
<li><p>default optimizer for <code>lmer()</code> is <code>nloptwrap</code>, formerly <code>bobyqa</code> (Bound Optimization by Quaradric Approximiation)</p>
<ul>
<li>usually changing to <code>bobyqa</code> helps</li>
</ul></li>
<li><p>see <code>?lmerControl</code> for more info</p></li>
<li><p>if fits are very similar (or all optimizeres except the default), the nonconvergent fit was a false positive</p>
<ul>
<li>it’s safe to use the new optimizer</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(all_fit_verb_fp_mm)<span class="sc">$</span>llik</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       bobyqa                   Nelder_Mead 
                    -2105.109                     -2179.479 
                   nlminbwrap                         nmkbw 
                    -2105.106                     -2105.109 
              optimx.L-BFGS-B nloptwrap.NLOPT_LN_NELDERMEAD 
                    -2105.106                     -2105.106 
    nloptwrap.NLOPT_LN_BOBYQA 
                    -2105.106 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(all_fit_verb_fp_mm)<span class="sc">$</span>fixef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              (Intercept)    verb_t1      gramm1 verb_t1:gramm1
bobyqa                           5.956403 0.06170602 0.003369634    -0.01418865
Nelder_Mead                      5.956350 0.06188102 0.003488675    -0.01397531
nlminbwrap                       5.956403 0.06170726 0.003369637    -0.01419047
nmkbw                            5.956404 0.06170653 0.003369153    -0.01419036
optimx.L-BFGS-B                  5.956403 0.06170717 0.003369787    -0.01419044
nloptwrap.NLOPT_LN_NELDERMEAD    5.956403 0.06170725 0.003369649    -0.01419046
nloptwrap.NLOPT_LN_BOBYQA        5.956403 0.06170771 0.003369203    -0.01419184</code></pre>
</div>
</div>
</section>
<section id="increase-iterations" class="level4" data-number="12.5.4.3">
<h4 data-number="12.5.4.3" class="anchored" data-anchor-id="increase-iterations"><span class="header-section-number">12.5.4.3</span> Increase iterations</h4>
<ul>
<li>and/or increase number of iterations
<ul>
<li>default is 10 000 (<code>1e5</code> in scientific notation)</li>
<li>you can try 20 000, 100 000, etc.</li>
<li>this usually helps with larger data or models with complex RES</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## check n of iterations</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_mm<span class="sc">@</span>optinfo<span class="sc">$</span>feval</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2318</code></pre>
</div>
</div>
</section>
<section id="lmercontrol" class="level4" data-number="12.5.4.4">
<h4 data-number="12.5.4.4" class="anchored" data-anchor-id="lmercontrol"><span class="header-section-number">12.5.4.4</span> <code>lmerControl()</code></h4>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>item),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>or you can just ‘update’ the model to save some syntax</li>
</ul>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">update</span>(fit_verb_fp_mm,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Model failed to converge with 1 negative eigenvalue: -5.3e-01</code></pre>
</div>
</div>
</section>
<section id="removing-parameters" class="level4" data-number="12.5.4.5">
<h4 data-number="12.5.4.5" class="anchored" data-anchor-id="removing-parameters"><span class="header-section-number">12.5.4.5</span> Removing parameters</h4>
<ul>
<li>still won’t converge?
<ul>
<li>it’s time to consider intrusive remedies: removing random effects parameters</li>
</ul></li>
</ul>
</section>
</section>
<section id="intrusive-methods" class="level3" data-number="12.5.5">
<h3 data-number="12.5.5" class="anchored" data-anchor-id="intrusive-methods"><span class="header-section-number">12.5.5</span> Intrusive methods</h3>
<ul>
<li>nonconvergence in maximal models is often due to overfitting
<ul>
<li>i.e., the model is overly complex given your data</li>
<li>this is typically due to an overly complex random effects structure</li>
</ul></li>
<li>if the non-intrusive methods don’t lead to convergence, the problem is likely overfitting</li>
</ul>
<section id="parsimonious-vs.-maximal" class="level4" data-number="12.5.5.1">
<h4 data-number="12.5.5.1" class="anchored" data-anchor-id="parsimonious-vs.-maximal"><span class="header-section-number">12.5.5.1</span> Parsimonious vs.&nbsp;maximal</h4>
<ul>
<li>there are different camps on how to deal with this issue</li>
<li>I personally follow the suggestions in <span class="citation" data-cites="bates_parsimonious_2015">Bates et al. (<a href="00-course_overview.html#ref-bates_parsimonious_2015" role="doc-biblioref">2015</a>)</span> (for now)
<ol type="1">
<li>run random effects Principal Components Analysis (<code>summary(rePCA(model))</code>, <code>lme4</code> package)
<ul>
<li>informs by how many parameters our model is overfit</li>
</ul></li>
<li>check variance-covariance matrix (<code>VarCorr(model)</code>)</li>
<li>remove parameters with very high or low Correlation terms and/or much lower variance compared to other terms</li>
<li>fit simplified model</li>
<li>wash, rinse, repeat</li>
</ol></li>
<li>we’ll practice this method today, but keep in mind that it’s up to you to decide and justify which method you use</li>
</ul>
</section>
<section id="random-effects-principal-components-analysis" class="level4" data-number="12.5.5.2">
<h4 data-number="12.5.5.2" class="anchored" data-anchor-id="random-effects-principal-components-analysis"><span class="header-section-number">12.5.5.2</span> Random effects Principal Components Analysis</h4>
<ul>
<li>gives us a ranking of all parameters (‘components’) in our RES per unit</li>
</ul>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(fit_verb_fp_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$item
Importance of components:
                         [,1]   [,2]    [,3]                    [,4]
Standard deviation     0.3638 0.2493 0.08366 0.000000000000000001309
Proportion of Variance 0.6567 0.3085 0.03474 0.000000000000000000000
Cumulative Proportion  0.6567 0.9653 1.00000 1.000000000000000000000

$sj
Importance of components:
                         [,1]    [,2]        [,3]          [,4]
Standard deviation     0.6490 0.01470 0.000001281 0.00000001467
Proportion of Variance 0.9995 0.00051 0.000000000 0.00000000000
Cumulative Proportion  0.9995 1.00000 1.000000000 1.00000000000</code></pre>
</div>
</div>
</section>
<section id="section" class="level4" data-number="12.5.5.3">
<h4 data-number="12.5.5.3" class="anchored" data-anchor-id="section"><span class="header-section-number">12.5.5.3</span> </h4>
<ul>
<li>important is the Cumulative Proportion
<ul>
<li>how much of the cumulative variance explained by all the by-unit parameters does this one parameter contribute?</li>
<li>we see for item, the first component accounts for 66% of the variance explained, and the next contributes an additional 31%, and the next 3%</li>
<li>so two components account for roughly 97% of variance explained by our RES</li>
<li>in other words, we can remove one component for sure, and possibly another</li>
<li>we could potentially remove 3 components from participant</li>
</ul></li>
</ul>
</section>
<section id="variance-covariance-matrix" class="level4" data-number="12.5.5.4">
<h4 data-number="12.5.5.4" class="anchored" data-anchor-id="variance-covariance-matrix"><span class="header-section-number">12.5.5.4</span> Variance-covariance matrix</h4>
<ul>
<li>so we can remove 2 parameters from item and participant
<ul>
<li>so either the varying intercept, or slope for tense, grammaticality, or their interaction</li>
</ul></li>
<li>we can check this with <code>VarCorr(fit_verb_fp_mm)</code></li>
</ul>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(fit_verb_fp_mm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name           Std.Dev. Corr                
 item     (Intercept)    0.139189                     
          verb_t1        0.055890  0.488              
          gramm1         0.022569 -0.109 -0.921       
          verb_t1:gramm1 0.095314 -0.283  0.456 -0.646
 sj       (Intercept)    0.257535                     
          verb_t1        0.018296 0.974               
          gramm1         0.012055 0.960  0.872        
          verb_t1:gramm1 0.017731 0.991  0.934  0.990 
 Residual                0.399095                     </code></pre>
</div>
</div>
<ul>
<li>for item I would remove <code>gramm</code> because it has the lowest variance, and has a pretty high correlation with <code>verb_t</code> (which is unlikely to be true)</li>
<li>I would also remove <code>gramm</code> for participant for the same reason, as well as its high correlation with the intercept and <code>verb_t</code></li>
</ul>
<section id="alternate-model-1" class="level5" data-number="12.5.5.4.1">
<h5 data-number="12.5.5.4.1" class="anchored" data-anchor-id="alternate-model-1"><span class="header-section-number">12.5.5.4.1</span> Alternate model 1</h5>
<ul>
<li>for now let’s just remove the interaction term
<ul>
<li>for reproducibility reasons, do not delete the code for a model that did not converge</li>
<li>rather, write a comment on what decision was made (and why) for the new model</li>
</ul></li>
</ul>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">+</span>gramm<span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">+</span>gramm<span class="sc">|</span>item),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
<section id="repca" class="level6" data-number="12.5.5.4.1.1">
<h6 data-number="12.5.5.4.1.1" class="anchored" data-anchor-id="repca"><span class="header-section-number">12.5.5.4.1.1</span> <code>rePCA()</code></h6>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(fit_verb_fp_m1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$item
Importance of components:
                         [,1]   [,2]          [,3]
Standard deviation     0.3559 0.1291 0.00000007181
Proportion of Variance 0.8837 0.1163 0.00000000000
Cumulative Proportion  0.8837 1.0000 1.00000000000

$sj
Importance of components:
                         [,1]         [,2] [,3]
Standard deviation     0.6465 0.0000006824    0
Proportion of Variance 1.0000 0.0000000000    0
Cumulative Proportion  1.0000 1.0000000000    1</code></pre>
</div>
</div>
</section>
<section id="varcorr" class="level6" data-number="12.5.5.4.1.2">
<h6 data-number="12.5.5.4.1.2" class="anchored" data-anchor-id="varcorr"><span class="header-section-number">12.5.5.4.1.2</span> <code>VarCorr()</code></h6>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(fit_verb_fp_m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev. Corr         
 item     (Intercept) 0.139274              
          verb_t1     0.055550  0.489       
          gramm1      0.020747 -0.117 -0.924
 sj       (Intercept) 0.257657              
          verb_t1     0.017584 1.000        
          gramm1      0.011554 1.000  1.000 
 Residual             0.399869              </code></pre>
</div>
</div>
<ul>
<li>when we see Corr +/-1, this tells us there was an error computing correlations between parameters
<ul>
<li>it is an invitation to explore</li>
</ul></li>
<li>this is not plausible, and indicates overfitting in our model
<ul>
<li>we can remove all slopes from sj</li>
</ul></li>
</ul>
</section>
<section id="by-item-random-effects" class="level6" data-number="12.5.5.4.1.3">
<h6 data-number="12.5.5.4.1.3" class="anchored" data-anchor-id="by-item-random-effects"><span class="header-section-number">12.5.5.4.1.3</span> by-item random effects</h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">dotplot</span>(<span class="fu">ranef</span>(fit_verb_fp_m1))<span class="sc">$</span>item</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11-model_selection_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="by-participant-random-effects-with-1-correlations" class="level6" data-number="12.5.5.4.1.4">
<h6 data-number="12.5.5.4.1.4" class="anchored" data-anchor-id="by-participant-random-effects-with-1-correlations"><span class="header-section-number">12.5.5.4.1.4</span> by-participant random effects (with +1 correlations)</h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">dotplot</span>(<span class="fu">ranef</span>(fit_verb_fp_m1))<span class="sc">$</span>sj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11-model_selection_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="alternate-model-2" class="level5" data-number="12.5.5.4.2">
<h5 data-number="12.5.5.4.2" class="anchored" data-anchor-id="alternate-model-2"><span class="header-section-number">12.5.5.4.2</span> Alternate model 2</h5>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_m2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">+</span>gramm<span class="sc">|</span>item),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
<section id="repca-1" class="level6" data-number="12.5.5.4.2.1">
<h6 data-number="12.5.5.4.2.1" class="anchored" data-anchor-id="repca-1"><span class="header-section-number">12.5.5.4.2.1</span> <code>rePCA()</code></h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(fit_verb_fp_m2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$item
Importance of components:
                         [,1]   [,2]          [,3]
Standard deviation     0.3559 0.1297 0.00000001647
Proportion of Variance 0.8827 0.1173 0.00000000000
Cumulative Proportion  0.8827 1.0000 1.00000000000

$sj
Importance of components:
                         [,1]
Standard deviation     0.6441
Proportion of Variance 1.0000
Cumulative Proportion  1.0000</code></pre>
</div>
</div>
</section>
<section id="varcorr-1" class="level6" data-number="12.5.5.4.2.2">
<h6 data-number="12.5.5.4.2.2" class="anchored" data-anchor-id="varcorr-1"><span class="header-section-number">12.5.5.4.2.2</span> <code>VarCorr()</code></h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(fit_verb_fp_m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev. Corr         
 item     (Intercept) 0.139364              
          verb_t1     0.055805  0.485       
          gramm1      0.020546 -0.097 -0.917
 sj       (Intercept) 0.257648              
 Residual             0.399995              </code></pre>
</div>
</div>
<ul>
<li>by-item slopes for <code>gramm</code> and <code>verb_t</code> are highly correlated</li>
<li><code>gramm</code> has least variance, so let’s remove it</li>
</ul>
</section>
<section id="by-item-random-effects-1" class="level6" data-number="12.5.5.4.2.3">
<h6 data-number="12.5.5.4.2.3" class="anchored" data-anchor-id="by-item-random-effects-1"><span class="header-section-number">12.5.5.4.2.3</span> by-item random effects</h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">dotplot</span>(<span class="fu">ranef</span>(fit_verb_fp_m2))<span class="sc">$</span>item</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11-model_selection_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="alternate-model-3" class="level5" data-number="12.5.5.4.3">
<h5 data-number="12.5.5.4.3" class="anchored" data-anchor-id="alternate-model-3"><span class="header-section-number">12.5.5.4.3</span> Alternate model 3</h5>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_m3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">|</span>item),</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>))</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>converged!</li>
</ul>
<section id="repca-2" class="level6" data-number="12.5.5.4.3.1">
<h6 data-number="12.5.5.4.3.1" class="anchored" data-anchor-id="repca-2"><span class="header-section-number">12.5.5.4.3.1</span> <code>rePCA()</code></h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(fit_verb_fp_m3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$item
Importance of components:
                         [,1]    [,2]
Standard deviation     0.3553 0.10311
Proportion of Variance 0.9223 0.07768
Cumulative Proportion  0.9223 1.00000

$sj
Importance of components:
                         [,1]
Standard deviation     0.6438
Proportion of Variance 1.0000
Cumulative Proportion  1.0000</code></pre>
</div>
</div>
</section>
<section id="varcorr-2" class="level6" data-number="12.5.5.4.3.2">
<h6 data-number="12.5.5.4.3.2" class="anchored" data-anchor-id="varcorr-2"><span class="header-section-number">12.5.5.4.3.2</span> <code>VarCorr()</code></h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(fit_verb_fp_m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev. Corr 
 item     (Intercept) 0.139365      
          verb_t1     0.050134 0.542
 sj       (Intercept) 0.257714      
 Residual             0.400315      </code></pre>
</div>
</div>
</section>
</section>
<section id="alternate-model-4" class="level5" data-number="12.5.5.4.4">
<h5 data-number="12.5.5.4.4" class="anchored" data-anchor-id="alternate-model-4"><span class="header-section-number">12.5.5.4.4</span> Alternate model 4</h5>
<ul>
<li>but we might’ve also decided to remove <code>verb_t</code>, so let’s run that model</li>
</ul>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_m4 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> gramm<span class="sc">|</span>item),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>))</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
<ul>
<li>does not converge, so we’re justified in keeping by-item <code>verb_t</code> slopes</li>
</ul>
</section>
</section>
<section id="final-model" class="level4" data-number="12.5.5.5">
<h4 data-number="12.5.5.5" class="anchored" data-anchor-id="final-model"><span class="header-section-number">12.5.5.5</span> Final model</h4>
<ul>
<li>the final model name should be some sort of convention to make your life easier
<ul>
<li>so remove model index</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>fit_verb_fp <span class="ot">&lt;-</span> fit_verb_fp_m3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="by-item-random-effects-2" class="level6" data-number="12.5.5.5.0.1">
<h6 data-number="12.5.5.5.0.1" class="anchored" data-anchor-id="by-item-random-effects-2"><span class="header-section-number">12.5.5.5.0.1</span> by-item random effects</h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">dotplot</span>(<span class="fu">ranef</span>(fit_verb_fp))<span class="sc">$</span>sj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11-model_selection_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="by-participant-random-effects" class="level6" data-number="12.5.5.5.0.2">
<h6 data-number="12.5.5.5.0.2" class="anchored" data-anchor-id="by-participant-random-effects"><span class="header-section-number">12.5.5.5.0.2</span> by-participant random effects</h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">dotplot</span>(<span class="fu">ranef</span>(fit_verb_fp))<span class="sc">$</span>item</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="11-model_selection_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="summary" class="level6" data-number="12.5.5.5.0.3">
<h6 data-number="12.5.5.5.0.3" class="anchored" data-anchor-id="summary"><span class="header-section-number">12.5.5.5.0.3</span> <code>summary()</code></h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_verb_fp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: log(fp) ~ verb_t * gramm + (1 | sj) + (1 + verb_t | item)
   Data: df_biondo
Control: lmerControl(optimizer = "bobyqa", optCtrl = list(maxfun = 200000))
 Subset: roi == 4

REML criterion at convergence: 4216.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.1758 -0.6096 -0.0227  0.6060  4.0568 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 item     (Intercept) 0.019423 0.13936      
          verb_t1     0.002513 0.05013  0.54
 sj       (Intercept) 0.066417 0.25771      
 Residual             0.160252 0.40032      
Number of obs: 3795, groups:  item, 96; sj, 60

Fixed effects:
                  Estimate  Std. Error          df t value             Pr(&gt;|t|)
(Intercept)       5.956384    0.036763   79.243172 162.021 &lt; 0.0000000000000002
verb_t1           0.061733    0.013971   93.410519   4.419            0.0000267
gramm1            0.003298    0.012999 3544.451690   0.254                 0.80
verb_t1:gramm1   -0.014380    0.025998 3544.762213  -0.553                 0.58
                  
(Intercept)    ***
verb_t1        ***
gramm1            
verb_t1:gramm1    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) vrb_t1 gramm1
verb_t1      0.077              
gramm1       0.000 -0.002       
vrb_t1:grm1  0.000  0.002  0.000</code></pre>
</div>
</div>
<ul>
<li>IMPORTANTLY, only look at the fixed effects after you’ve got your final model!!!!
<ul>
<li>i.e., run model -&gt; convergence error -&gt; <code>rePCA()</code> + <code>VarCorr()</code> -&gt; run model -&gt; … -&gt; converges -&gt; only NOW run <code>summary(model)</code></li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="comparing-to-bad-models" class="level3" data-number="12.5.6">
<h3 data-number="12.5.6" class="anchored" data-anchor-id="comparing-to-bad-models"><span class="header-section-number">12.5.6</span> Comparing to ‘bad’ models</h3>
<ul>
<li>let’s compare our final model to our ‘bad’ models
<ul>
<li>random intercepts-only model (overconfident)</li>
<li>maximal model (underconfident)</li>
</ul></li>
</ul>
<section id="random-intercepts-only" class="level4" data-number="12.5.6.1">
<h4 data-number="12.5.6.1" class="anchored" data-anchor-id="random-intercepts-only"><span class="header-section-number">12.5.6.1</span> Random-intercepts only</h4>
<div class="cell" data-output-location="fragment">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_intercepts <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span>item),</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>converges</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>sum_fit_verb_fp <span class="ot">&lt;-</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(fit_verb_fp,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_value =</span> p.value,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">model =</span> <span class="st">"parsimonious"</span>) </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>sum_fit_verb_fp_mm <span class="ot">&lt;-</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(fit_verb_fp_mm,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_value =</span> p.value,</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">model =</span> <span class="st">"maximal"</span>) </span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>sum_fit_verb_fp_intercepts <span class="ot">&lt;-</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(fit_verb_fp_intercepts,</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_value =</span> p.value,</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">model =</span> <span class="st">"intercepts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="coefficient-estimates" class="level4 smaller" data-number="12.5.6.2">
<h4 class="smaller anchored" data-number="12.5.6.2" data-anchor-id="coefficient-estimates"><span class="header-section-number">12.5.6.2</span> coefficient estimates</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sum_fit_verb_fp, sum_fit_verb_fp_intercepts, sum_fit_verb_fp_mm) <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, model) <span class="sc">|&gt;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">round</span>(estimate,<span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(term),</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> model,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> estimate</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"estimate"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-estimates" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;12.1: Coefficient estimates for our parsimonious model, a random-intercepts only model, and a maximal model</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">parsimonious</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">intercepts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">maximal</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">measure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">5.9564</td>
<td style="text-align: right;">5.9564</td>
<td style="text-align: right;">5.9564</td>
<td style="text-align: left;">estimate</td>
</tr>
<tr class="even">
<td style="text-align: left;">verb_t1</td>
<td style="text-align: right;">0.0617</td>
<td style="text-align: right;">0.0619</td>
<td style="text-align: right;">0.0617</td>
<td style="text-align: left;">estimate</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gramm1</td>
<td style="text-align: right;">0.0033</td>
<td style="text-align: right;">0.0032</td>
<td style="text-align: right;">0.0034</td>
<td style="text-align: left;">estimate</td>
</tr>
<tr class="even">
<td style="text-align: left;">verb_t1:gramm1</td>
<td style="text-align: right;">-0.0144</td>
<td style="text-align: right;">-0.0143</td>
<td style="text-align: right;">-0.0142</td>
<td style="text-align: left;">estimate</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section>
<section id="standard-error" class="level4 smaller" data-number="12.5.6.3">
<h4 class="smaller anchored" data-number="12.5.6.3" data-anchor-id="standard-error"><span class="header-section-number">12.5.6.3</span> standard error</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sum_fit_verb_fp, sum_fit_verb_fp_intercepts, sum_fit_verb_fp_mm) <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, std.error, model) <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">std.error =</span> <span class="fu">round</span>(std.error,<span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(term),</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> model,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> std.error</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"std.error"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-std_error" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;12.2: Standard error of coefficient estimates for our parsimonious model, a random-intercepts only model, and a maximal model</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">parsimonious</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">intercepts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">maximal</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">measure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0368</td>
<td style="text-align: right;">0.0368</td>
<td style="text-align: right;">0.0367</td>
<td style="text-align: left;">std.error</td>
</tr>
<tr class="even">
<td style="text-align: left;">verb_t1</td>
<td style="text-align: right;">0.0140</td>
<td style="text-align: right;">0.0130</td>
<td style="text-align: right;">0.0144</td>
<td style="text-align: left;">std.error</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gramm1</td>
<td style="text-align: right;">0.0130</td>
<td style="text-align: right;">0.0130</td>
<td style="text-align: right;">0.0133</td>
<td style="text-align: left;">std.error</td>
</tr>
<tr class="even">
<td style="text-align: left;">verb_t1:gramm1</td>
<td style="text-align: right;">0.0260</td>
<td style="text-align: right;">0.0260</td>
<td style="text-align: right;">0.0278</td>
<td style="text-align: left;">std.error</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<ul>
<li>standard error (\<span class="math inline">\(SE = \frac{\sigma}{\sqrt{n}}\\\)</span>) is a measure of uncertainty
<ul>
<li>larger values reflect greater uncertainty</li>
<li>because <span class="math inline">\(n\)</span> is in the denominator, SE gets smaller with more observations</li>
</ul></li>
<li>compared to our parsimonious model with by-item varying <code>verb_t</code> slopes:
<ul>
<li>smaller SE for our overconfident (intercepts) model</li>
<li>larger SE for our underconfident (maximal) model</li>
<li>but only for the estimate also included in the random effects</li>
</ul></li>
</ul>
</section>
<section id="t-values" class="level4 smaller" data-number="12.5.6.4">
<h4 class="smaller anchored" data-number="12.5.6.4" data-anchor-id="t-values"><span class="header-section-number">12.5.6.4</span> t-values</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sum_fit_verb_fp, sum_fit_verb_fp_intercepts, sum_fit_verb_fp_mm) <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, statistic, model) <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">statistic =</span> <span class="fu">round</span>(statistic,<span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(term),</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> model,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> statistic</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"statistic"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-t_value" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;12.3: t-values of each estimates for our parsimonious model, a random-intercepts only model, and a maximal model</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">parsimonious</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">intercepts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">maximal</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">measure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">162.0213</td>
<td style="text-align: right;">161.9025</td>
<td style="text-align: right;">162.1605</td>
<td style="text-align: left;">statistic</td>
</tr>
<tr class="even">
<td style="text-align: left;">verb_t1</td>
<td style="text-align: right;">4.4188</td>
<td style="text-align: right;">4.7517</td>
<td style="text-align: right;">4.2982</td>
<td style="text-align: left;">statistic</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gramm1</td>
<td style="text-align: right;">0.2537</td>
<td style="text-align: right;">0.2466</td>
<td style="text-align: right;">0.2542</td>
<td style="text-align: left;">statistic</td>
</tr>
<tr class="even">
<td style="text-align: left;">verb_t1:gramm1</td>
<td style="text-align: right;">-0.5531</td>
<td style="text-align: right;">-0.5496</td>
<td style="text-align: right;">-0.5108</td>
<td style="text-align: left;">statistic</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<ul>
<li>t-value (\<span class="math inline">\(t = \frac{\bar{x}_1 - \bar{x}_2}{SE}\\\)</span>) is a measure of uncertainty
<ul>
<li>larger values reflect greater effect</li>
<li>more <span class="math inline">\(n\)</span> increases <span class="math inline">\(t\)</span></li>
</ul></li>
<li>again, <code>verb_t</code>: <span class="math inline">\(t_{max}\)</span> &lt; <span class="math inline">\(t_{pars}\)</span> &lt; <span class="math inline">\(t_{int}\)</span></li>
</ul>
</section>
<section id="degrees-of-freedom" class="level4 smaller" data-number="12.5.6.5">
<h4 class="smaller anchored" data-number="12.5.6.5" data-anchor-id="degrees-of-freedom"><span class="header-section-number">12.5.6.5</span> degrees of freedom</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sum_fit_verb_fp, sum_fit_verb_fp_intercepts, sum_fit_verb_fp_mm) <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, model) <span class="sc">|&gt;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">df =</span> <span class="fu">round</span>(df,<span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(term),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> model,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> df</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"df"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-df" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;12.4: Degrees of freedom of each estimates for our parsimonious model, a random-intercepts only model, and a maximal model</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">parsimonious</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">intercepts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">maximal</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">measure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">79.2432</td>
<td style="text-align: right;">79.2008</td>
<td style="text-align: right;">79.1789</td>
<td style="text-align: left;">df</td>
</tr>
<tr class="even">
<td style="text-align: left;">verb_t1</td>
<td style="text-align: right;">93.4105</td>
<td style="text-align: right;">3637.1332</td>
<td style="text-align: right;">71.4491</td>
<td style="text-align: left;">df</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gramm1</td>
<td style="text-align: right;">3544.4517</td>
<td style="text-align: right;">3637.1834</td>
<td style="text-align: right;">179.9254</td>
<td style="text-align: left;">df</td>
</tr>
<tr class="even">
<td style="text-align: left;">verb_t1:gramm1</td>
<td style="text-align: right;">3544.7622</td>
<td style="text-align: right;">3637.1023</td>
<td style="text-align: right;">91.8597</td>
<td style="text-align: left;">df</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<ul>
<li>degrees of freedom: not trivially defined in mixed models; we’re using Satterthwaite approximiation (default in <code>lmerTest::lmer()</code>)
<ul>
<li>larger degrees of freedom corresponds to larger <span class="math inline">\(n\)</span></li>
<li>including more random effects reduces our <span class="math inline">\(n\)</span> and therefore reduces <span class="math inline">\(df\)</span></li>
</ul></li>
<li>again, <code>verb_t</code>: <span class="math inline">\(df_{max}\)</span> &lt; <span class="math inline">\(df_{pars}\)</span> &lt; <span class="math inline">\(df_{int}\)</span>
<ul>
<li>and large differences between our maximal model and the other two for other terms</li>
</ul></li>
</ul>
</section>
<section id="p-values" class="level4 smaller" data-number="12.5.6.6">
<h4 class="smaller anchored" data-number="12.5.6.6" data-anchor-id="p-values"><span class="header-section-number">12.5.6.6</span> p-values</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sum_fit_verb_fp, sum_fit_verb_fp_intercepts, sum_fit_verb_fp_mm) <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, p.value, model) <span class="sc">|&gt;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">round</span>(p.value, <span class="dv">8</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(term),</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> model,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> p.value</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"p.value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-p_value" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;12.5: p-values of coefficient estimates for our parsimonious model, a random-intercepts only model, and a maximal model</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">parsimonious</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">intercepts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">maximal</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">measure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">p.value</td>
</tr>
<tr class="even">
<td style="text-align: left;">verb_t1</td>
<td style="text-align: right;">0.0000267</td>
<td style="text-align: right;">0.0000021</td>
<td style="text-align: right;">0.0000535</td>
<td style="text-align: left;">p.value</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gramm1</td>
<td style="text-align: right;">0.7997645</td>
<td style="text-align: right;">0.8052568</td>
<td style="text-align: right;">0.7996181</td>
<td style="text-align: left;">p.value</td>
</tr>
<tr class="even">
<td style="text-align: left;">verb_t1:gramm1</td>
<td style="text-align: right;">0.5802114</td>
<td style="text-align: right;">0.5826522</td>
<td style="text-align: right;">0.6107496</td>
<td style="text-align: left;">p.value</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<ul>
<li>p-values: inversely related to t-values (larger t-values = smaller p-values)</li>
<li>again, <code>verb_t</code>: <span class="math inline">\(p_{max}\)</span> &lt; <span class="math inline">\(p_{pars}\)</span> &lt; <span class="math inline">\(p_{int}\)</span>
<ul>
<li>this would be important for ‘signicance’ if the values were closer to the convential alpha-levels (p &lt; .05, p &lt; .01, p &lt; .001)</li>
<li>but here the different random effects structures don’t qualitatively change (all are &lt; .001)</li>
</ul></li>
<li>this is not always the case, however!
<ul>
<li>this is why we do not peek at the fixed effects until we have our final model</li>
<li>we don’t want to be influenced (consciously or not) by seeing small p-values in one model but not another</li>
</ul></li>
</ul>
</section>
</section>
<section id="reporting" class="level3" data-number="12.5.7">
<h3 data-number="12.5.7" class="anchored" data-anchor-id="reporting"><span class="header-section-number">12.5.7</span> Reporting</h3>
<ul>
<li>in Data Analysis section, e.g.,</li>
</ul>
<blockquote class="blockquote">
<p>We included Time Reference (past, future), and Verb Match (match, mismatch) as fixed-effect factors in the models used to investigate the processing of past–future violations (Q1), by adopting sum contrast coding (Schad et al., 2020): past and match conditions were coded as –.5. while future and mismatch conditions were coded as .5. […] Moreover, we included crossed random intercepts and random slopes for all fixed-effect parameters for subject and item grouping factors (Barr et al., 2013) in all models.</p>
<p>We reduced the complexity of the random effect structure of the maximal model by performing a principal component analysis so as to identify the most parsimonious model properly supported by the data (Bates et al., 2015). […] all reading time data were log transformed before performing the analyses.</p>
<p>— <span class="citation" data-cites="biondo_yesterday_2022">Biondo et al. (<a href="00-course_overview.html#ref-biondo_yesterday_2022" role="doc-biblioref">2022</a>)</span>, p.&nbsp;9</p>
</blockquote>
<section id="formatted-p-values" class="level4" data-number="12.5.7.1">
<h4 data-number="12.5.7.1" class="anchored" data-anchor-id="formatted-p-values"><span class="header-section-number">12.5.7.1</span> Formatted p-values</h4>
<p>We can create our own function, which we will call <code>format_pval()</code>, to produce formatted p-values. Here we use the <code>case_when()</code> function to print <code>&lt; .05</code>, <code>&lt; .01</code> or <code>&lt; .001</code> when the p-value is smaller than these values (which is a convention). Otherwise (<code>TRUE</code>), round the p-value to 3 decimal points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">## function to format p-values to APA7 guidelines</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>format_pval <span class="ot">&lt;-</span> <span class="cf">function</span>(pval){</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>        pval <span class="sc">&lt;</span> .<span class="dv">001</span> <span class="sc">~</span> <span class="st">"&lt; .001"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">str_remove</span>(<span class="fu">round</span>(pval, <span class="dv">3</span>), <span class="st">"^0+"</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now use our <code>format_pval()</code> function to format our p-values and print them in a table, as in <a href="12-model_selection_example.html#tbl-format_pval">Table&nbsp;<span>13.6</span></a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(fit_verb_fp,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_value =</span> <span class="fu">format_pval</span>(p.value)) <span class="sc">|&gt;</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>p.value) <span class="sc">|&gt;</span> </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-format_pval" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;12.6: Table with formatted p-values from <code>format_pval()</code></caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">effect</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">5.9563839</td>
<td style="text-align: right;">0.0367630</td>
<td style="text-align: right;">162.0213327</td>
<td style="text-align: right;">79.24317</td>
<td style="text-align: left;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">verb_t1</td>
<td style="text-align: right;">0.0617330</td>
<td style="text-align: right;">0.0139706</td>
<td style="text-align: right;">4.4187865</td>
<td style="text-align: right;">93.41052</td>
<td style="text-align: left;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">gramm1</td>
<td style="text-align: right;">0.0032976</td>
<td style="text-align: right;">0.0129994</td>
<td style="text-align: right;">0.2536709</td>
<td style="text-align: right;">3544.45169</td>
<td style="text-align: left;">.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">fixed</td>
<td style="text-align: left;">verb_t1:gramm1</td>
<td style="text-align: right;">-0.0143804</td>
<td style="text-align: right;">0.0259984</td>
<td style="text-align: right;">-0.5531269</td>
<td style="text-align: right;">3544.76221</td>
<td style="text-align: left;">.58</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
APA 7 guidelines: formatting p-values
</div>
</div>
<div class="callout-body-container callout-body">
<p>The guidelines from the 7th edition from the American Psychological Association pertaining to numbers and statistics define how we should be formatting <em>p</em>-values, summarised in the <a href="https://apastyle.apa.org/instructional-aids/numbers-statistics-guide.pdf">Guide for Numbers and Statistics</a> <span class="citation" data-cites="apa_numbers_2022">(<a href="00-course_overview.html#ref-apa_numbers_2022" role="doc-biblioref">American Psychological Association, 2022</a>)</span>. A summary:</p>
<ul>
<li>Don’t use leading 0’s (i.e., zero before a decimal) when the statistic cannot be greater than 1 (proportion, correlation, level of statistical significance).</li>
<li>Report exact <em>p</em>-values to two or three decimals (e.g., p = .006, p = .03). i.e., no trailing 0’s</li>
<li>Report <em>p</em>-values less than .001 as “p &lt; .001”.</li>
<li>Do not repeat statistics in both the text and a table or figure</li>
</ul>
<p>We used the <code>round()</code> function from base R to round <em>p</em>-values to 3 decimal points. This function drops trailing 0’s, so <code>0.030</code> will become <code>0.03</code>. We also use the <code>str_remove()</code> function from the <code>stringr</code> package (Tidyverse), which takes the results from <code>round()</code> and removes any leading 0’s (i.e., those before the decimal) as defined by the regular expression (<code>regex</code>) <code>^0+</code>. This will take <code>0.03</code> and print <code>.03</code>.</p>
<p>Here is some example output using <code>round()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fl">0.020001</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02</code></pre>
</div>
</div>
<p>And removing the leading 0 using <code>str_remove()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_remove</span>(<span class="fu">round</span>(<span class="fl">0.020001</span>,<span class="dv">3</span>), <span class="st">"^0+"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] ".02"</code></pre>
</div>
</div>
<p>If our <em>p</em>-value is smaller than .001, then it will be written as <code>&lt; .001</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format_pval</span>(<span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.02</span>, <span class="fl">0.002</span>, <span class="fl">0.0002</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] ".2"     ".02"    ".002"   "&lt; .001"</code></pre>
</div>
</div>
<p>So now our <em>p</em>-values are formatted according to APA 7 guidelines, as long as we pass them through <code>format_pval()</code>.</p>
</div>
</div>
</section>
</section>
</section>
<section id="alternatives-to-lme4" class="level2" data-number="12.6">
<h2 data-number="12.6" class="anchored" data-anchor-id="alternatives-to-lme4"><span class="header-section-number">12.6</span> Alternatives to <code>lme4</code></h2>
<ul>
<li>other alternatives that have fewer convergence issues:
<ul>
<li>Julia
<ul>
<li>e.g., in VS Code IDE</li>
</ul></li>
<li>Bayesian framework (e.g., <code>brms</code> R package)
<ul>
<li>also run (G)LMMs, but abandons arbitrary p-values</li>
<li>instead quantifies uncertainty</li>
</ul></li>
</ul></li>
<li>both are more more computationally powerful
<ul>
<li>the are not (yet) as widely used in the field</li>
</ul></li>
</ul>
</section>
<section id="learning-objectives-1" class="level2 unnumbered unlisted uncounted">
<h2 class="unnumbered unlisted uncounted anchored" data-anchor-id="learning-objectives-1">Learning objectives 🏁</h2>
<p>Today we learned…</p>
<ul>
<li>the history of mixed models (again) ✅</li>
<li>strategies for model selection ✅</li>
<li>variability in model selection ✅</li>
</ul>
<p>and how to…</p>
<ul>
<li>apply remedies for nonconvergence ✅</li>
<li>reduce our RES with a data-driven approach ✅</li>
<li>compare a parsimonious model to maximal and intercept-only models ✅</li>
</ul>
</section>
<section id="important-terms" class="level2 unnumbered smaller uncounted">
<h2 class="unnumbered smaller uncounted anchored" data-anchor-id="important-terms">Important terms</h2>
<div class="cell">
<div class="cell-output-display">

<div id="qfspytgopq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qfspytgopq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qfspytgopq thead, #qfspytgopq tbody, #qfspytgopq tfoot, #qfspytgopq tr, #qfspytgopq td, #qfspytgopq th {
  border-style: none;
}

#qfspytgopq p {
  margin: 0;
  padding: 0;
}

#qfspytgopq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qfspytgopq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qfspytgopq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qfspytgopq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qfspytgopq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qfspytgopq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qfspytgopq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qfspytgopq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qfspytgopq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qfspytgopq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qfspytgopq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qfspytgopq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qfspytgopq .gt_spanner_row {
  border-bottom-style: hidden;
}

#qfspytgopq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qfspytgopq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qfspytgopq .gt_from_md > :first-child {
  margin-top: 0;
}

#qfspytgopq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qfspytgopq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qfspytgopq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qfspytgopq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qfspytgopq .gt_row_group_first td {
  border-top-width: 2px;
}

#qfspytgopq .gt_row_group_first th {
  border-top-width: 2px;
}

#qfspytgopq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qfspytgopq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qfspytgopq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qfspytgopq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qfspytgopq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qfspytgopq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qfspytgopq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qfspytgopq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qfspytgopq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qfspytgopq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qfspytgopq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qfspytgopq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qfspytgopq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qfspytgopq .gt_left {
  text-align: left;
}

#qfspytgopq .gt_center {
  text-align: center;
}

#qfspytgopq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qfspytgopq .gt_font_normal {
  font-weight: normal;
}

#qfspytgopq .gt_font_bold {
  font-weight: bold;
}

#qfspytgopq .gt_font_italic {
  font-style: italic;
}

#qfspytgopq .gt_super {
  font-size: 65%;
}

#qfspytgopq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qfspytgopq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qfspytgopq .gt_indent_1 {
  text-indent: 5px;
}

#qfspytgopq .gt_indent_2 {
  text-indent: 10px;
}

#qfspytgopq .gt_indent_3 {
  text-indent: 15px;
}

#qfspytgopq .gt_indent_4 {
  text-indent: 20px;
}

#qfspytgopq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Term">Term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Definition">Definition</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Equation/Code">Equation/Code</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Term" class="gt_row gt_left">linear mixed (effects) model</td>
<td headers="Definition" class="gt_row gt_left">NA</td>
<td headers="Equation/Code" class="gt_row gt_left">NA</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="references" class="level2 unlisted unnumbered" data-visibility="uncounted">
<h2 class="unlisted unnumbered anchored" data-visibility="uncounted" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-custom-style="Bibliography" data-line-spacing="2" role="list" style="display: none">
<div id="ref-apa_numbers_2022" class="csl-entry" role="listitem">
American Psychological Association. (2022). <em><span>APA Style</span> numbers and statistics guide</em>. <span>American Psychological Association</span>.
</div>
<div id="ref-baayen_mixed-effects_2008" class="csl-entry" role="listitem">
Baayen, R. H., Davidson, D. J., &amp; Bates, D. M. (2008). Mixed-effects modeling with crossed random effects for subjects and items. <em>Journal of Memory and Language</em>, <em>59</em>(4), 390–412. <a href="https://doi.org/10.1016/j.jml.2007.12.005">https://doi.org/10.1016/j.jml.2007.12.005</a>
</div>
<div id="ref-barr_random_maximal_2013" class="csl-entry" role="listitem">
Barr, D. J., Levy, R., Scheepers, C., &amp; Tily, H. J. (2013). Random effects structure for confirmatory hypothesis testing: <span>Keep</span> it maximal. <em>Journal of Memory and Language</em>, <em>68</em>(3), 255–278. <a href="https://doi.org/10.1016/j.jml.2012.11.001">https://doi.org/10.1016/j.jml.2012.11.001</a>
</div>
<div id="ref-bates_parsimonious_2015" class="csl-entry" role="listitem">
Bates, D., Kliegl, R., Vasishth, S., &amp; Baayen, H. (2015). Parsimonious <span>Mixed Models</span>. <em>arXiv Preprint</em>, 1–27. <a href="https://doi.org/10.48550/arXiv.1506.04967">https://doi.org/10.48550/arXiv.1506.04967</a>
</div>
<div id="ref-biondo_yesterday_2022" class="csl-entry" role="listitem">
Biondo, N., Soilemezidi, M., &amp; Mancini, S. (2022). Yesterday is history, tomorrow is a mystery: <span>An</span> eye-tracking investigation of the processing of past and future time reference during sentence reading. <em>Journal of Experimental Psychology: Learning, Memory, and Cognition</em>, <em>48</em>(7), 1001–1018. <a href="https://doi.org/10.1037/xlm0001053">https://doi.org/10.1037/xlm0001053</a>
</div>
<div id="ref-brauer_linear_2018" class="csl-entry" role="listitem">
Brauer, M., &amp; Curtin, J. J. (2018). Linear mixed-effects models and the analysis of nonindependent data: <span>A</span> unified framework to analyze categorical and continuous independent variables that vary within-subjects and/or within-items. <em>Psychological Methods</em>, <em>23</em>(3), 389–411. <a href="https://doi.org/10.1037/met0000159">https://doi.org/10.1037/met0000159</a>
</div>
<div id="ref-clark_language-as-fixed-effect_1973" class="csl-entry" role="listitem">
Clark, H. H. (1973). The language-as-fixed-effect fallacy: <span>A</span> critique of language statistics in psychological research. <em>Journal of Verbal Learning and Verbal Behavior</em>, <em>12</em>(4), 335–359. <a href="https://doi.org/10.1016/S0022-5371(73)80014-3">https://doi.org/10.1016/S0022-5371(73)80014-3</a>
</div>
<div id="ref-gelman_garden_2013" class="csl-entry" role="listitem">
Gelman, A., &amp; Loken, E. (2013). <em>The garden of forking paths: <span>Why</span> multiple comparisons can be a problem, even when there is no <span>“fishing expedition”</span> or <span>“p-hacking”</span> and the research hypothesis was posited ahead of time</em>.
</div>
<div id="ref-matuschek_balancing_2017" class="csl-entry" role="listitem">
Matuschek, H., Kliegl, R., Vasishth, S., Baayen, H., &amp; Bates, D. (2017). Balancing <span>Type I</span> error and power in linear mixed models. <em>Journal of Memory and Language</em>, <em>94</em>, 305–315. <a href="https://doi.org/10.1016/j.jml.2017.01.001">https://doi.org/10.1016/j.jml.2017.01.001</a>
</div>
<div id="ref-meteyard_best_2020" class="csl-entry" role="listitem">
Meteyard, L., &amp; Davies, R. A. I. (2020). Best practice guidance for linear mixed-effects models in psychological science. <em>Journal of Memory and Language</em>, <em>112</em>, 104092. <a href="https://doi.org/10.1016/j.jml.2020.104092">https://doi.org/10.1016/j.jml.2020.104092</a>
</div>
<div id="ref-simmons_false-positive_2011" class="csl-entry" role="listitem">
Simmons, J. P., Nelson, L. D., &amp; Simonsohn, U. (2011). False-<span>Positive Psychology</span>: <span>Undisclosed Flexibility</span> in <span>Data Collection</span> and <span>Analysis Allows Presenting Anything</span> as <span>Significant</span>. <em>Psychological Science</em>, <em>22</em>(11), 1359–1366. <a href="https://doi.org/10.1177/0956797611417632">https://doi.org/10.1177/0956797611417632</a>
</div>
<div id="ref-sonderegger_regression_2023" class="csl-entry" role="listitem">
Sonderegger, M. (2023). <em>Regression <span>Modeling</span> for <span>Linguistic Data</span></em>.
</div>
<div id="ref-winter_statistics_2019" class="csl-entry" role="listitem">
Winter, B. (2019). Statistics for <span>Linguists</span>: <span>An Introduction Using R</span>. In <em>Statistics for Linguists: An Introduction Using R</em>. <span>Routledge</span>. <a href="https://doi.org/10.4324/9781315165547">https://doi.org/10.4324/9781315165547</a>
</div>
<div id="ref-winter_independence_2021" class="csl-entry" role="listitem">
Winter, B., &amp; Grice, M. (2021). Independence and generalizability in linguistics. <em>Linguistics</em>, <em>59</em>(5), 1251–1277. <a href="https://doi.org/10.1515/ling-2019-0049">https://doi.org/10.1515/ling-2019-0049</a>
</div>
<div id="ref-yarkoni_generalizability_2022" class="csl-entry" role="listitem">
Yarkoni, T. (2022). The generalizability crisis. <em>Behavioral and Brain Sciences</em>, <em>45</em>, e1. <a href="https://doi.org/10.1017/S0140525X20001685">https://doi.org/10.1017/S0140525X20001685</a>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script>
var custom_title = document.querySelectorAll('.custom .theorem-title');

for (let i = 0; i < custom_title.length; i++ ) {
   var mod_name = custom_title[i].innerHTML;
   custom_title[i].innerHTML = mod_name.replace("Example", "");
};
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./10-shrinkage.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Shrinkage and Partial Pooling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./12-model_selection_example.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Model selection: Example</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb73" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Model selection"</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Strolling through the garden of forking paths"</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Daniela Palleschi"</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="an">institute:</span><span class="co"> Humboldt-Universität zu Berlin</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># footer: "Lecture 1.1 - R und RStudio"</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="an">lang:</span><span class="co"> en</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "02/09/2024"</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> last-modified</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="an">shift-heading-level-by:</span><span class="co"> +1</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="fu"># Under construction {.unnumbered .uncounted .unlisted}</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>This chapter is not fully translated from bullet points (from my slides) to prose. This will happen eventually (hopefully by spring 2024).</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, eval = T, echo = F}</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> T, <span class="co"># print chunks?</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">eval =</span> T, <span class="co"># run chunks?</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">error =</span> F, <span class="co"># print errors?</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warning =</span> F, <span class="co"># print warnings?</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> F, <span class="co"># print messages?</span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cache =</span> F <span class="co"># cache?; be careful with this!</span></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a><span class="fu"># Learning Objectives {.unnumbered .unlisted}</span></span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>Today we will learn about...</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the history of mixed models (again)</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>strategies for model selection</span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>variability in model selection</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>and how to...</span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>apply remedies for nonconvergence</span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>reduce our RES with a data-driven approach</span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>compare a parsimonious model to maximal and intercept-only models</span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a><span class="fu"># Resources {.unnumbered .unlisted}</span></span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>relevant papers for this topic</span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>@barr_random_maximal_2013</span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>@bates_parsimonious_2015</span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>@matuschek_balancing_2017</span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>@brauer_linear_2018</span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>@meteyard_best_2020</span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-52"><a href="#cb73-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>practical resources covered in the practical application:</span>
<span id="cb73-53"><a href="#cb73-53" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>Sections 10.3-5 in @sonderegger_regression_2023</span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>Section 15.7.3 'Convergence Issues' in @winter_statistics_2019</span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>@brauer_linear_2018</span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>@meteyard_best_2020 </span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>we will continue using the data from @biondo_yesterday_2022</span>
<span id="cb73-58"><a href="#cb73-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-59"><a href="#cb73-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-60"><a href="#cb73-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r hidden_packages}</span></span>
<span id="cb73-61"><a href="#cb73-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-62"><a href="#cb73-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb73-63"><a href="#cb73-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-64"><a href="#cb73-64" aria-hidden="true" tabindex="-1"></a><span class="co"># extra packages for the lecture notes/slides</span></span>
<span id="cb73-65"><a href="#cb73-65" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb73-66"><a href="#cb73-66" aria-hidden="true" tabindex="-1"></a>  tidyverse,</span>
<span id="cb73-67"><a href="#cb73-67" aria-hidden="true" tabindex="-1"></a>  here, janitor,</span>
<span id="cb73-68"><a href="#cb73-68" aria-hidden="true" tabindex="-1"></a>               googlesheets4,</span>
<span id="cb73-69"><a href="#cb73-69" aria-hidden="true" tabindex="-1"></a>               gt)</span>
<span id="cb73-70"><a href="#cb73-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-71"><a href="#cb73-71" aria-hidden="true" tabindex="-1"></a><span class="co"># tell googlesheets4 we don't want private</span></span>
<span id="cb73-72"><a href="#cb73-72" aria-hidden="true" tabindex="-1"></a><span class="fu">gs4_deauth</span>()</span>
<span id="cb73-73"><a href="#cb73-73" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-74"><a href="#cb73-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-77"><a href="#cb73-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-78"><a href="#cb73-78" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-79"><a href="#cb73-79" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb73-80"><a href="#cb73-80" aria-hidden="true" tabindex="-1"></a>df_biondo <span class="ot">&lt;-</span></span>
<span id="cb73-81"><a href="#cb73-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"Biondo.Soilemezidi.Mancini_dataset_ET.csv"</span>),</span>
<span id="cb73-82"><a href="#cb73-82" aria-hidden="true" tabindex="-1"></a>           <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">"Latin1"</span>) <span class="do">## for special characters in Spanish</span></span>
<span id="cb73-83"><a href="#cb73-83" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">|&gt;</span> </span>
<span id="cb73-84"><a href="#cb73-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-85"><a href="#cb73-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gramm =</span> <span class="fu">ifelse</span>(gramm <span class="sc">==</span> <span class="st">"0"</span>, <span class="st">"ungramm"</span>, <span class="st">"gramm"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb73-86"><a href="#cb73-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as_factor) <span class="sc">|&gt;</span> <span class="co"># all character variables as factors</span></span>
<span id="cb73-87"><a href="#cb73-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-88"><a href="#cb73-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(adv_type <span class="sc">==</span> <span class="st">"Deic"</span>)</span>
<span id="cb73-89"><a href="#cb73-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-90"><a href="#cb73-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-91"><a href="#cb73-91" aria-hidden="true" tabindex="-1"></a><span class="fu"># Review: random intercepts and slopes</span></span>
<span id="cb73-92"><a href="#cb73-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-93"><a href="#cb73-93" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>violation of independence assumption --&gt; increased Type I error (false positive)</span>
<span id="cb73-94"><a href="#cb73-94" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>include random effects per plausible grouping factor <span class="co">[</span><span class="ot">herein "unit", à la @barr_random_maximal_2013</span><span class="co">]</span></span>
<span id="cb73-95"><a href="#cb73-95" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>random-intercepts only models --&gt; increased Type I error (false positive)</span>
<span id="cb73-96"><a href="#cb73-96" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>add random slopes per within-unit manipulation, i.e., "maximal" models <span class="co">[</span><span class="ot">@barr_random_maximal_2013</span><span class="co">]</span></span>
<span id="cb73-97"><a href="#cb73-97" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>but such models often fail to "converge"</span>
<span id="cb73-98"><a href="#cb73-98" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>and have been shown to increase Type II error (false negative) <span class="co">[</span><span class="ot">@bates_parsimonious_2015; @matuschek_balancing_2017</span><span class="co">]</span></span>
<span id="cb73-99"><a href="#cb73-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-100"><a href="#cb73-100" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>some questions remain:</span>
<span id="cb73-101"><a href="#cb73-101" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>how to define our maximal model</span>
<span id="cb73-102"><a href="#cb73-102" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>how to handle convergence issues</span>
<span id="cb73-103"><a href="#cb73-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-104"><a href="#cb73-104" aria-hidden="true" tabindex="-1"></a><span class="fu"># History of LMMs revisited</span></span>
<span id="cb73-105"><a href="#cb73-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-106"><a href="#cb73-106" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>recall @clark_language-as-fixed-effect_1973's language-as-fixed-effect fallacy and the issue of generalisability <span class="co">[</span><span class="ot">see also @winter_independence_2021; @yarkoni_generalizability_2022</span><span class="co">]</span></span>
<span id="cb73-107"><a href="#cb73-107" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@baayen_mixed-effects_2008 motivated LMM's for linguistic data in the JML special issue</span>
<span id="cb73-108"><a href="#cb73-108" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>effect: everybody adopted random-intercepts only models</span>
<span id="cb73-109"><a href="#cb73-109" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@barr_random_maximal_2013: random-intercepts only models are overconfident, "keep it maximal!"</span>
<span id="cb73-110"><a href="#cb73-110" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>effect: everybody adopted maximal models</span>
<span id="cb73-111"><a href="#cb73-111" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@matuschek_balancing_2017 and @bates_parsimonious_2015: maximal models are underconfident and lower statistical power! Use data-driven model selection to find a "parsimonious" model!</span>
<span id="cb73-112"><a href="#cb73-112" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>effect: some people adopt this method, but many psycholinguists just want a "recipe" to follow</span>
<span id="cb73-113"><a href="#cb73-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-114"><a href="#cb73-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2013: Keep it maximal</span></span>
<span id="cb73-115"><a href="#cb73-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-116"><a href="#cb73-116" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A maximal model should optimize generalization of the findings to new subjects and new items.</span></span>
<span id="cb73-117"><a href="#cb73-117" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb73-118"><a href="#cb73-118" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; -- @barr_random_maximal_2013, p. 261</span></span>
<span id="cb73-119"><a href="#cb73-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-120"><a href="#cb73-120" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>random-intercepts-only models tend to be underpowered</span>
<span id="cb73-121"><a href="#cb73-121" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>for this reason, @barr_random_maximal_2013 suggested using a maximal random effects structure justified by the experimental design</span>
<span id="cb73-122"><a href="#cb73-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-123"><a href="#cb73-123" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2015 &amp; 2017: Parsimonious models</span></span>
<span id="cb73-124"><a href="#cb73-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-125"><a href="#cb73-125" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="co">[</span><span class="ot">W</span><span class="co">]</span><span class="at">hile the maximal model indeed performs well as far as Type I error rates were concerned, power decreases substantially with model complexity.</span></span>
<span id="cb73-126"><a href="#cb73-126" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb73-127"><a href="#cb73-127" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; --- @matuschek_balancing_2017, p. 310-311</span></span>
<span id="cb73-128"><a href="#cb73-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-129"><a href="#cb73-129" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>there is a trade-off between Type I (overconfidence) and Type II error (underconfidence)</span>
<span id="cb73-130"><a href="#cb73-130" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>i.e., maximal models can lead to over-fitting</span>
<span id="cb73-131"><a href="#cb73-131" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>lowers statistical power, which increases Type II error (false rejection)</span>
<span id="cb73-132"><a href="#cb73-132" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>but we should strive for the most *parsimonious* model</span>
<span id="cb73-133"><a href="#cb73-133" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>parsimonous models are a compromise between the maximal model justified by your design and theory, and a given data set</span>
<span id="cb73-134"><a href="#cb73-134" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>best way to maintain low Type I and II error: collect lots of data</span>
<span id="cb73-135"><a href="#cb73-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-136"><a href="#cb73-136" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model building</span></span>
<span id="cb73-137"><a href="#cb73-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-138"><a href="#cb73-138" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Every statistical model is a description of some real or hypothetical state of affairs in the world.</span></span>
<span id="cb73-139"><a href="#cb73-139" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb73-140"><a href="#cb73-140" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; -- @yarkoni_generalizability_2022, p. 2</span></span>
<span id="cb73-141"><a href="#cb73-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-142"><a href="#cb73-142" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>our models reflect not only our hypotheses or effects of interest, but any other plausible or known co-variates</span>
<span id="cb73-143"><a href="#cb73-143" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>our predictors should reflect our research questions or theories tested</span>
<span id="cb73-144"><a href="#cb73-144" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>plus any plausible or previously motivated co-variates (e.g., trial order)</span>
<span id="cb73-145"><a href="#cb73-145" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>plus known sources of nonindependence, i.e., our random effects</span>
<span id="cb73-146"><a href="#cb73-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-147"><a href="#cb73-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-148"><a href="#cb73-148" aria-hidden="true" tabindex="-1"></a><span class="fu">## Choosing predictors</span></span>
<span id="cb73-149"><a href="#cb73-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-150"><a href="#cb73-150" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>your model should be defined *a priori*</span>
<span id="cb73-151"><a href="#cb73-151" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>i.e., you should define what predictors you will include and any covariates</span>
<span id="cb73-152"><a href="#cb73-152" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>e.g., if you have a prediction about the effect of phonological neighbours on vowel duration</span>
<span id="cb73-153"><a href="#cb73-153" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>define what phonological characteristics you will include (e.g., place of articulation? manner?)</span>
<span id="cb73-154"><a href="#cb73-154" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>these should be related to specific hypotheses/research questions</span>
<span id="cb73-155"><a href="#cb73-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-156"><a href="#cb73-156" aria-hidden="true" tabindex="-1"></a><span class="fu">## Choosing a maximal random effects structure (RES)</span></span>
<span id="cb73-157"><a href="#cb73-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-158"><a href="#cb73-158" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how do we define our maximal model? Some tips from @barr_random_maximal_2013</span>
<span id="cb73-159"><a href="#cb73-159" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>between-unit factor (e.g., age): include random intercept only</span>
<span id="cb73-160"><a href="#cb73-160" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>within-unit factor with multiple observations per unit-level (e.g., age in longitudinal data): include random slopes</span>
<span id="cb73-161"><a href="#cb73-161" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>all factors in an interaction are within-unit: include by-unit random slopes for interaction terms</span>
<span id="cb73-162"><a href="#cb73-162" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb73-163"><a href="#cb73-163" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: @biondo_yesterday_2022</span></span>
<span id="cb73-164"><a href="#cb73-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-165"><a href="#cb73-165" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@biondo_yesterday_2022: 2x2 design</span>
<span id="cb73-166"><a href="#cb73-166" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>verb-tense (past, future) and grammaticality (grammatical, ungrammatical)</span>
<span id="cb73-167"><a href="#cb73-167" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>repeated-measures: within-participant and -item design</span>
<span id="cb73-168"><a href="#cb73-168" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>so we should have by-participant and -item random intercepts (multiple observations per unit level)</span>
<span id="cb73-169"><a href="#cb73-169" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>each participant and item contributed multiple data points *per condition* (i.e., tense and grammaticality were manipulated within each unit level)</span>
<span id="cb73-170"><a href="#cb73-170" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>so we should have varying tense and grammaticality slopes by- item and -participant</span>
<span id="cb73-171"><a href="#cb73-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-174"><a href="#cb73-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-175"><a href="#cb73-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb73-176"><a href="#cb73-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: true</span></span>
<span id="cb73-177"><a href="#cb73-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-178"><a href="#cb73-178" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-179"><a href="#cb73-179" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb73-180"><a href="#cb73-180" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb73-181"><a href="#cb73-181" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>item),</span>
<span id="cb73-182"><a href="#cb73-182" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb73-183"><a href="#cb73-183" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>)</span>
<span id="cb73-184"><a href="#cb73-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-185"><a href="#cb73-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-186"><a href="#cb73-186" aria-hidden="true" tabindex="-1"></a><span class="fu">## Observations per cell</span></span>
<span id="cb73-187"><a href="#cb73-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-188"><a href="#cb73-188" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>if there is only a single observation per cell, e.g., you collected one observation from each participant per condition, then you can't fit random intercepts or slopes</span>
<span id="cb73-189"><a href="#cb73-189" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ideally you would have at least 5 observations per cell (per unit level per condition, e.g., each participant has at least 5 observations per condition)</span>
<span id="cb73-190"><a href="#cb73-190" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>this is also a question of statistical power</span>
<span id="cb73-191"><a href="#cb73-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-194"><a href="#cb73-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-195"><a href="#cb73-195" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: column-fragment</span></span>
<span id="cb73-196"><a href="#cb73-196" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb73-197"><a href="#cb73-197" aria-hidden="true" tabindex="-1"></a><span class="co"># obvz per sj per condition</span></span>
<span id="cb73-198"><a href="#cb73-198" aria-hidden="true" tabindex="-1"></a>df_biondo <span class="sc">|&gt;</span> </span>
<span id="cb73-199"><a href="#cb73-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-200"><a href="#cb73-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sj, verb_t, gramm) <span class="sc">|&gt;</span> </span>
<span id="cb73-201"><a href="#cb73-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n)</span>
<span id="cb73-202"><a href="#cb73-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-203"><a href="#cb73-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-206"><a href="#cb73-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-207"><a href="#cb73-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb73-208"><a href="#cb73-208" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: column-fragment</span></span>
<span id="cb73-209"><a href="#cb73-209" aria-hidden="true" tabindex="-1"></a><span class="co"># obvz per item per condition</span></span>
<span id="cb73-210"><a href="#cb73-210" aria-hidden="true" tabindex="-1"></a>df_biondo <span class="sc">|&gt;</span> </span>
<span id="cb73-211"><a href="#cb73-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-212"><a href="#cb73-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(item, verb_t, gramm) <span class="sc">|&gt;</span> </span>
<span id="cb73-213"><a href="#cb73-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb73-214"><a href="#cb73-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n)</span>
<span id="cb73-215"><a href="#cb73-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-216"><a href="#cb73-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-217"><a href="#cb73-217" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data structure</span></span>
<span id="cb73-218"><a href="#cb73-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-219"><a href="#cb73-219" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>random effects must be factors/categorical</span>
<span id="cb73-220"><a href="#cb73-220" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>single observation per row</span>
<span id="cb73-221"><a href="#cb73-221" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>generally speaking, there should be n(participants) * n(items) rows</span>
<span id="cb73-222"><a href="#cb73-222" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>every fixed or random effect in your model should correspond to a column in your dataset</span>
<span id="cb73-223"><a href="#cb73-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-224"><a href="#cb73-224" aria-hidden="true" tabindex="-1"></a><span class="fu"># Variability in methods</span></span>
<span id="cb73-225"><a href="#cb73-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-226"><a href="#cb73-226" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@meteyard_best_2020</span>
<span id="cb73-227"><a href="#cb73-227" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>survey of (psychology) researchers</span>
<span id="cb73-228"><a href="#cb73-228" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>review of papers using LMMs</span>
<span id="cb73-229"><a href="#cb73-229" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>insecurity in researchers re: choosing models</span>
<span id="cb73-230"><a href="#cb73-230" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>great variation in papers in how models are built and reported</span>
<span id="cb73-231"><a href="#cb73-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-232"><a href="#cb73-232" aria-hidden="true" tabindex="-1"></a><span class="fu">## Researcher degrees of freedom</span></span>
<span id="cb73-233"><a href="#cb73-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-234"><a href="#cb73-234" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; What we hope to make clear is that there is no single correct way in which LMM analyses should be conducted, and this has important implications for how the reporting of LMMs should be approached.</span></span>
<span id="cb73-235"><a href="#cb73-235" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb73-236"><a href="#cb73-236" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; --- @meteyard_best_2020, p. 9</span></span>
<span id="cb73-237"><a href="#cb73-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-238"><a href="#cb73-238" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the problem:</span>
<span id="cb73-239"><a href="#cb73-239" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>'researcher degrees of freedom' <span class="co">[</span><span class="ot">@simmons_false-positive_2011</span><span class="co">]</span>, or 'the garden of forking paths' <span class="co">[</span><span class="ot">@gelman_garden_2013</span><span class="co">]</span></span>
<span id="cb73-240"><a href="#cb73-240" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>the same data can be analysed in a variety of ways</span>
<span id="cb73-241"><a href="#cb73-241" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>this leads to insecurity for many researchers</span>
<span id="cb73-242"><a href="#cb73-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-243"><a href="#cb73-243" aria-hidden="true" tabindex="-1"></a><span class="fu">## Justify and document</span></span>
<span id="cb73-244"><a href="#cb73-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-245"><a href="#cb73-245" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Replicability and reproducibility are critical for scientific progress, so the way in which researchers have implemented LMM analysis must be entirely transparent. We also hope that the sharing of analysis code and data becomes widespread, enabling the periodic re-analysis of raw data over multiple experiments as studies accumulate over time.</span></span>
<span id="cb73-246"><a href="#cb73-246" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb73-247"><a href="#cb73-247" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; --- @meteyard_best_2020, p. 9</span></span>
<span id="cb73-248"><a href="#cb73-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-249"><a href="#cb73-249" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the (partial) solution: </span>
<span id="cb73-250"><a href="#cb73-250" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>make model building/selection decisions a priori</span>
<span id="cb73-251"><a href="#cb73-251" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>be transparent</span>
<span id="cb73-252"><a href="#cb73-252" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>share your data and code</span>
<span id="cb73-253"><a href="#cb73-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-254"><a href="#cb73-254" aria-hidden="true" tabindex="-1"></a><span class="fu"># A practical example</span></span>
<span id="cb73-255"><a href="#cb73-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-256"><a href="#cb73-256" aria-hidden="true" tabindex="-1"></a>We'll now look at an example of a model that encounters convergence issues, and take some steps to reach convergence. We are considering a case where your predictors and covariates are already selected, and will focus on selecting model options and  random effects structure that achieve model convergence.</span>
<span id="cb73-257"><a href="#cb73-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-258"><a href="#cb73-258" aria-hidden="true" tabindex="-1"></a><span class="fu">## Set-up</span></span>
<span id="cb73-259"><a href="#cb73-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-260"><a href="#cb73-260" aria-hidden="true" tabindex="-1"></a>We first need to set up our environment.</span>
<span id="cb73-261"><a href="#cb73-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-264"><a href="#cb73-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-265"><a href="#cb73-265" aria-hidden="true" tabindex="-1"></a><span class="do">## suppress scientific notation</span></span>
<span id="cb73-266"><a href="#cb73-266" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb73-267"><a href="#cb73-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-268"><a href="#cb73-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-269"><a href="#cb73-269" aria-hidden="true" tabindex="-1"></a><span class="fu">### Load packages {.unnumbered}</span></span>
<span id="cb73-270"><a href="#cb73-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-273"><a href="#cb73-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-274"><a href="#cb73-274" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb73-275"><a href="#cb73-275" aria-hidden="true" tabindex="-1"></a><span class="do">## load libraries</span></span>
<span id="cb73-276"><a href="#cb73-276" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb73-277"><a href="#cb73-277" aria-hidden="true" tabindex="-1"></a>               tidyverse,</span>
<span id="cb73-278"><a href="#cb73-278" aria-hidden="true" tabindex="-1"></a>               here,</span>
<span id="cb73-279"><a href="#cb73-279" aria-hidden="true" tabindex="-1"></a>               janitor,</span>
<span id="cb73-280"><a href="#cb73-280" aria-hidden="true" tabindex="-1"></a>               <span class="do">## new packages for mixed models:</span></span>
<span id="cb73-281"><a href="#cb73-281" aria-hidden="true" tabindex="-1"></a>               lme4,</span>
<span id="cb73-282"><a href="#cb73-282" aria-hidden="true" tabindex="-1"></a>               lmerTest,</span>
<span id="cb73-283"><a href="#cb73-283" aria-hidden="true" tabindex="-1"></a>               broom.mixed,</span>
<span id="cb73-284"><a href="#cb73-284" aria-hidden="true" tabindex="-1"></a>               lattice)</span>
<span id="cb73-285"><a href="#cb73-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-286"><a href="#cb73-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-289"><a href="#cb73-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-290"><a href="#cb73-290" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-291"><a href="#cb73-291" aria-hidden="true" tabindex="-1"></a><span class="do">## set preferred ggplot2 theme</span></span>
<span id="cb73-292"><a href="#cb73-292" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)))</span>
<span id="cb73-293"><a href="#cb73-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-294"><a href="#cb73-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-297"><a href="#cb73-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-298"><a href="#cb73-298" aria-hidden="true" tabindex="-1"></a>lmer <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span>lmer</span>
<span id="cb73-299"><a href="#cb73-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-300"><a href="#cb73-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-303"><a href="#cb73-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-304"><a href="#cb73-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-305"><a href="#cb73-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-306"><a href="#cb73-306" aria-hidden="true" tabindex="-1"></a><span class="do">## extra packages for the lecture notes/slides</span></span>
<span id="cb73-307"><a href="#cb73-307" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb73-308"><a href="#cb73-308" aria-hidden="true" tabindex="-1"></a>               patchwork,</span>
<span id="cb73-309"><a href="#cb73-309" aria-hidden="true" tabindex="-1"></a>               knitr,</span>
<span id="cb73-310"><a href="#cb73-310" aria-hidden="true" tabindex="-1"></a>               kableExtra,</span>
<span id="cb73-311"><a href="#cb73-311" aria-hidden="true" tabindex="-1"></a>               googlesheets4,</span>
<span id="cb73-312"><a href="#cb73-312" aria-hidden="true" tabindex="-1"></a>               gt)</span>
<span id="cb73-313"><a href="#cb73-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-314"><a href="#cb73-314" aria-hidden="true" tabindex="-1"></a><span class="do">## tell googlesheets4 we don't want private</span></span>
<span id="cb73-315"><a href="#cb73-315" aria-hidden="true" tabindex="-1"></a><span class="fu">gs4_deauth</span>()</span>
<span id="cb73-316"><a href="#cb73-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-317"><a href="#cb73-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-318"><a href="#cb73-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-319"><a href="#cb73-319" aria-hidden="true" tabindex="-1"></a><span class="fu">### Load data {.unnumbered}</span></span>
<span id="cb73-320"><a href="#cb73-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-321"><a href="#cb73-321" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>data from @biondo_yesterday_2022</span>
<span id="cb73-322"><a href="#cb73-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-325"><a href="#cb73-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-326"><a href="#cb73-326" aria-hidden="true" tabindex="-1"></a>df_biondo <span class="ot">&lt;-</span></span>
<span id="cb73-327"><a href="#cb73-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"Biondo.Soilemezidi.Mancini_dataset_ET.csv"</span>),</span>
<span id="cb73-328"><a href="#cb73-328" aria-hidden="true" tabindex="-1"></a>           <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">"Latin1"</span>) <span class="do">### for special characters in Spanish</span></span>
<span id="cb73-329"><a href="#cb73-329" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">|&gt;</span> </span>
<span id="cb73-330"><a href="#cb73-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-331"><a href="#cb73-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gramm =</span> <span class="fu">ifelse</span>(gramm <span class="sc">==</span> <span class="st">"0"</span>, <span class="st">"ungramm"</span>, <span class="st">"gramm"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb73-332"><a href="#cb73-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as_factor) <span class="sc">|&gt;</span> <span class="do">## all character variables as factors</span></span>
<span id="cb73-333"><a href="#cb73-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-334"><a href="#cb73-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(adv_type <span class="sc">==</span> <span class="st">"Deic"</span>)</span>
<span id="cb73-335"><a href="#cb73-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-336"><a href="#cb73-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-337"><a href="#cb73-337" aria-hidden="true" tabindex="-1"></a><span class="fu">### Set contrasts</span></span>
<span id="cb73-338"><a href="#cb73-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-341"><a href="#cb73-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-342"><a href="#cb73-342" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_biondo<span class="sc">$</span>verb_t) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="sc">+</span><span class="fl">0.5</span>)</span>
<span id="cb73-343"><a href="#cb73-343" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_biondo<span class="sc">$</span>gramm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="sc">+</span><span class="fl">0.5</span>)</span>
<span id="cb73-344"><a href="#cb73-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-345"><a href="#cb73-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-346"><a href="#cb73-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-349"><a href="#cb73-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-350"><a href="#cb73-350" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_biondo<span class="sc">$</span>verb_t)</span>
<span id="cb73-351"><a href="#cb73-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-352"><a href="#cb73-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-355"><a href="#cb73-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-356"><a href="#cb73-356" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_biondo<span class="sc">$</span>gramm)</span>
<span id="cb73-357"><a href="#cb73-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-358"><a href="#cb73-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-359"><a href="#cb73-359" aria-hidden="true" tabindex="-1"></a><span class="fu">## Start maximal</span></span>
<span id="cb73-360"><a href="#cb73-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-361"><a href="#cb73-361" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>model structure should be decided *a priori*</span>
<span id="cb73-362"><a href="#cb73-362" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>included fixed (predictors and covariates) and random effects</span>
<span id="cb73-363"><a href="#cb73-363" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-364"><a href="#cb73-364" aria-hidden="true" tabindex="-1"></a><span class="fu">### Maximal model</span></span>
<span id="cb73-365"><a href="#cb73-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-366"><a href="#cb73-366" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>starting point: most maximal model structure justified by your design</span>
<span id="cb73-367"><a href="#cb73-367" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>if this converges, great!</span>
<span id="cb73-368"><a href="#cb73-368" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>if it doesn't, what does this mean and what should we do?</span>
<span id="cb73-369"><a href="#cb73-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-372"><a href="#cb73-372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-373"><a href="#cb73-373" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb73-374"><a href="#cb73-374" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: true</span></span>
<span id="cb73-375"><a href="#cb73-375" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb73-376"><a href="#cb73-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-377"><a href="#cb73-377" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb73-378"><a href="#cb73-378" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb73-379"><a href="#cb73-379" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>item),</span>
<span id="cb73-380"><a href="#cb73-380" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb73-381"><a href="#cb73-381" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>)</span>
<span id="cb73-382"><a href="#cb73-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-383"><a href="#cb73-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-384"><a href="#cb73-384" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>we get a warning of singular fit</span>
<span id="cb73-385"><a href="#cb73-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-388"><a href="#cb73-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-389"><a href="#cb73-389" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-390"><a href="#cb73-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb73-391"><a href="#cb73-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-392"><a href="#cb73-392" aria-hidden="true" tabindex="-1"></a><span class="do">## saveRDS(fit_verb_fp_mm, here::here("slides", "12-model_selection_example", "rds", "fit_verb_fp_mm.rds"))</span></span>
<span id="cb73-393"><a href="#cb73-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-394"><a href="#cb73-394" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"slides"</span>, <span class="st">"12-model_selection_example"</span>, <span class="st">"rds"</span>, <span class="st">"fit_verb_fp_mm.rds"</span>))</span>
<span id="cb73-395"><a href="#cb73-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-396"><a href="#cb73-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-397"><a href="#cb73-397" aria-hidden="true" tabindex="-1"></a><span class="fu">## Convergence issues</span></span>
<span id="cb73-398"><a href="#cb73-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-399"><a href="#cb73-399" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>"*Convergence is not a metric of model quality*" <span class="co">[</span><span class="ot">@sonderegger_regression_2023, p. 365, Box 10.2</span><span class="co">]</span></span>
<span id="cb73-400"><a href="#cb73-400" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>convergence does not always indicate "overfitting" or "overparameterisation"</span>
<span id="cb73-401"><a href="#cb73-401" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>can also be due to optimizer choice</span>
<span id="cb73-402"><a href="#cb73-402" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>since default optimizer was changed to <span class="in">`nloptwrap`</span> from <span class="in">`bobyqa`</span>, there seem to be more 'false positive' convergence warnings</span>
<span id="cb73-403"><a href="#cb73-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-404"><a href="#cb73-404" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>false-positive convergence: you get a convergence warning, but changing the optimizer and/or iteration count does not produce a warning</span>
<span id="cb73-405"><a href="#cb73-405" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>false-negative convergence: you do not get a warning, but your variance-covariance matrix might indicate overfitting</span>
<span id="cb73-406"><a href="#cb73-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-407"><a href="#cb73-407" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nonconvergence remedies</span></span>
<span id="cb73-408"><a href="#cb73-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-409"><a href="#cb73-409" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>unfortunately there is no one "right" way to deal with convergence issues</span>
<span id="cb73-410"><a href="#cb73-410" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>important is to transparently report and justify your method</span>
<span id="cb73-411"><a href="#cb73-411" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Table 17 in @brauer_linear_2018 (p. 404) suggests 20 remedies, whittled down to 10 suggestions in @sonderegger_regression_2023</span>
<span id="cb73-412"><a href="#cb73-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-415"><a href="#cb73-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-416"><a href="#cb73-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-table10</span></span>
<span id="cb73-417"><a href="#cb73-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "From @sonderegger_regression_2023, p. 366"</span></span>
<span id="cb73-418"><a href="#cb73-418" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-419"><a href="#cb73-419" aria-hidden="true" tabindex="-1"></a><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"media"</span>, <span class="st">"sonderegger_2023_convergence_table10.png"</span>))</span>
<span id="cb73-420"><a href="#cb73-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-421"><a href="#cb73-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-422"><a href="#cb73-422" aria-hidden="true" tabindex="-1"></a><span class="fu">### Intrusive vs. Non-intrusive remedies</span></span>
<span id="cb73-423"><a href="#cb73-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-424"><a href="#cb73-424" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>non-intrusive remedies amount to checking/adjusting data and model specifications</span>
<span id="cb73-425"><a href="#cb73-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-426"><a href="#cb73-426" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>intrusive remedies involve reducing random effects structure</span>
<span id="cb73-427"><a href="#cb73-427" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>there are different schools of thought</span>
<span id="cb73-428"><a href="#cb73-428" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>random-intercepts only: increased Type I error rate = overconfident estimates</span>
<span id="cb73-429"><a href="#cb73-429" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>maximal-but-singular-fit model <span class="co">[</span><span class="ot">@barr_random_maximal_2013</span><span class="co">]</span>: reduces power = underconfident estimates</span>
<span id="cb73-430"><a href="#cb73-430" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>data-driven approach <span class="co">[</span><span class="ot">@bates_parsimonious_2015</span><span class="co">]</span>: can lose the forest for the trees, e.g., removing random slopes for predictors of interest</span>
<span id="cb73-431"><a href="#cb73-431" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>each strategy has its drawback</span>
<span id="cb73-432"><a href="#cb73-432" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>important is to choose your strategy *a priori* and transparently report and justify your strategy</span>
<span id="cb73-433"><a href="#cb73-433" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>even better: share/publish your data and code, which should be reproducible</span>
<span id="cb73-434"><a href="#cb73-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-435"><a href="#cb73-435" aria-hidden="true" tabindex="-1"></a><span class="fu">### `?convergence`</span></span>
<span id="cb73-436"><a href="#cb73-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-437"><a href="#cb73-437" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>type <span class="in">`?convergence`</span> in the Console and read the vignette</span>
<span id="cb73-438"><a href="#cb73-438" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>what suggestions does it make?</span>
<span id="cb73-439"><a href="#cb73-439" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>compare this to <span class="in">`?isSingular`</span></span>
<span id="cb73-440"><a href="#cb73-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-441"><a href="#cb73-441" aria-hidden="true" tabindex="-1"></a><span class="fu">## Non-intrusive methods</span></span>
<span id="cb73-442"><a href="#cb73-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-443"><a href="#cb73-443" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>check your data structure/variables</span>
<span id="cb73-444"><a href="#cb73-444" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>check model assumptions (e.g., normality, missing transformations of variables)</span>
<span id="cb73-445"><a href="#cb73-445" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>check your RES is justified by your experimental design/data structure</span>
<span id="cb73-446"><a href="#cb73-446" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>centre your predictors (e.g., sum contrasts, or centring/standardizing) to reduce multicollinearity; reduces collinearity in the random effects (a possible source of nonconvergence)</span>
<span id="cb73-447"><a href="#cb73-447" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>check observations per cell (e.g., is there a participant very few observations, or few observations per one condition? Should be at least &gt;5 per cell)</span>
<span id="cb73-448"><a href="#cb73-448" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>alter model controls:</span>
<span id="cb73-449"><a href="#cb73-449" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>increase iterations</span>
<span id="cb73-450"><a href="#cb73-450" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>check optimizer</span>
<span id="cb73-451"><a href="#cb73-451" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-452"><a href="#cb73-452" aria-hidden="true" tabindex="-1"></a><span class="fu">### Check optimzer</span></span>
<span id="cb73-453"><a href="#cb73-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-454"><a href="#cb73-454" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>optimizer</span>
<span id="cb73-455"><a href="#cb73-455" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span><span class="in">`lme4::allFit(model)`</span> (can take a while to run)</span>
<span id="cb73-456"><a href="#cb73-456" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-459"><a href="#cb73-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-460"><a href="#cb73-460" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: column-fragment</span></span>
<span id="cb73-461"><a href="#cb73-461" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb73-462"><a href="#cb73-462" aria-hidden="true" tabindex="-1"></a>all_fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">allFit</span>(fit_verb_fp_mm)</span>
<span id="cb73-463"><a href="#cb73-463" aria-hidden="true" tabindex="-1"></a><span class="do">## bobyqa : boundary (singular) fit: see help('isSingular')</span></span>
<span id="cb73-464"><a href="#cb73-464" aria-hidden="true" tabindex="-1"></a><span class="do">## [OK]</span></span>
<span id="cb73-465"><a href="#cb73-465" aria-hidden="true" tabindex="-1"></a><span class="do">## Nelder_Mead : [OK]</span></span>
<span id="cb73-466"><a href="#cb73-466" aria-hidden="true" tabindex="-1"></a><span class="do">## nlminbwrap : boundary (singular) fit: see help('isSingular')</span></span>
<span id="cb73-467"><a href="#cb73-467" aria-hidden="true" tabindex="-1"></a><span class="do">## [OK]</span></span>
<span id="cb73-468"><a href="#cb73-468" aria-hidden="true" tabindex="-1"></a><span class="do">## nmkbw : [OK]</span></span>
<span id="cb73-469"><a href="#cb73-469" aria-hidden="true" tabindex="-1"></a><span class="do">## optimx.L-BFGS-B : boundary (singular) fit: see help('isSingular')</span></span>
<span id="cb73-470"><a href="#cb73-470" aria-hidden="true" tabindex="-1"></a><span class="do">## [OK]</span></span>
<span id="cb73-471"><a href="#cb73-471" aria-hidden="true" tabindex="-1"></a><span class="do">## nloptwrap.NLOPT_LN_NELDERMEAD : boundary (singular) fit: see help('isSingular')</span></span>
<span id="cb73-472"><a href="#cb73-472" aria-hidden="true" tabindex="-1"></a><span class="do">## [OK]</span></span>
<span id="cb73-473"><a href="#cb73-473" aria-hidden="true" tabindex="-1"></a><span class="do">## nloptwrap.NLOPT_LN_BOBYQA : boundary (singular) fit: see help('isSingular')</span></span>
<span id="cb73-474"><a href="#cb73-474" aria-hidden="true" tabindex="-1"></a><span class="do">## [OK]</span></span>
<span id="cb73-475"><a href="#cb73-475" aria-hidden="true" tabindex="-1"></a><span class="do">## There were 11 warnings (use warnings() to see them)</span></span>
<span id="cb73-476"><a href="#cb73-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-477"><a href="#cb73-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-480"><a href="#cb73-480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-481"><a href="#cb73-481" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-482"><a href="#cb73-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-483"><a href="#cb73-483" aria-hidden="true" tabindex="-1"></a><span class="do">## saveRDS(all_fit_verb_fp_mm, here::here("slides", "12-model_selection_example", "rds", "all_fit_verb_fp_mm.rds"))</span></span>
<span id="cb73-484"><a href="#cb73-484" aria-hidden="true" tabindex="-1"></a>all_fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"slides"</span>, <span class="st">"12-model_selection_example"</span>, <span class="st">"rds"</span>, <span class="st">"all_fit_verb_fp_mm.rds"</span>))</span>
<span id="cb73-485"><a href="#cb73-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-486"><a href="#cb73-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-487"><a href="#cb73-487" aria-hidden="true" tabindex="-1"></a><span class="fu">### Optimizers</span></span>
<span id="cb73-488"><a href="#cb73-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-489"><a href="#cb73-489" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>default optimizer for <span class="in">`lmer()`</span> is <span class="in">`nloptwrap`</span>, formerly <span class="in">`bobyqa`</span> (Bound Optimization by Quaradric Approximiation)</span>
<span id="cb73-490"><a href="#cb73-490" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>usually changing to <span class="in">`bobyqa`</span> helps</span>
<span id="cb73-491"><a href="#cb73-491" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>see <span class="in">`?lmerControl`</span> for more info</span>
<span id="cb73-492"><a href="#cb73-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-493"><a href="#cb73-493" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>if fits are very similar (or all optimizeres except the default), the nonconvergent fit was a false positive</span>
<span id="cb73-494"><a href="#cb73-494" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>it's safe to use the new optimizer</span>
<span id="cb73-495"><a href="#cb73-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-498"><a href="#cb73-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-499"><a href="#cb73-499" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(all_fit_verb_fp_mm)<span class="sc">$</span>llik</span>
<span id="cb73-500"><a href="#cb73-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-501"><a href="#cb73-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-504"><a href="#cb73-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-505"><a href="#cb73-505" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(all_fit_verb_fp_mm)<span class="sc">$</span>fixef</span>
<span id="cb73-506"><a href="#cb73-506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-507"><a href="#cb73-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-508"><a href="#cb73-508" aria-hidden="true" tabindex="-1"></a><span class="fu">### Increase iterations</span></span>
<span id="cb73-509"><a href="#cb73-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-510"><a href="#cb73-510" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>and/or increase number of iterations</span>
<span id="cb73-511"><a href="#cb73-511" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>default is 10 000 (<span class="in">`1e5`</span> in scientific notation)</span>
<span id="cb73-512"><a href="#cb73-512" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>you can try 20 000, 100 000, etc.</span>
<span id="cb73-513"><a href="#cb73-513" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>this usually helps with larger data or models with complex RES</span>
<span id="cb73-514"><a href="#cb73-514" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-517"><a href="#cb73-517" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-518"><a href="#cb73-518" aria-hidden="true" tabindex="-1"></a><span class="do">## check n of iterations</span></span>
<span id="cb73-519"><a href="#cb73-519" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_mm<span class="sc">@</span>optinfo<span class="sc">$</span>feval</span>
<span id="cb73-520"><a href="#cb73-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-521"><a href="#cb73-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-522"><a href="#cb73-522" aria-hidden="true" tabindex="-1"></a><span class="fu">### `lmerControl()`</span></span>
<span id="cb73-523"><a href="#cb73-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-526"><a href="#cb73-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-527"><a href="#cb73-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb73-528"><a href="#cb73-528" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: true</span></span>
<span id="cb73-529"><a href="#cb73-529" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-530"><a href="#cb73-530" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb73-531"><a href="#cb73-531" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb73-532"><a href="#cb73-532" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">*</span>gramm<span class="sc">|</span>item),</span>
<span id="cb73-533"><a href="#cb73-533" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb73-534"><a href="#cb73-534" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb73-535"><a href="#cb73-535" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>,</span>
<span id="cb73-536"><a href="#cb73-536" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>))</span>
<span id="cb73-537"><a href="#cb73-537" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-538"><a href="#cb73-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-539"><a href="#cb73-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-540"><a href="#cb73-540" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>or you can just 'update' the model to save some syntax</span>
<span id="cb73-541"><a href="#cb73-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-544"><a href="#cb73-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-545"><a href="#cb73-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb73-546"><a href="#cb73-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: true</span></span>
<span id="cb73-547"><a href="#cb73-547" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-548"><a href="#cb73-548" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_mm <span class="ot">&lt;-</span> <span class="fu">update</span>(fit_verb_fp_mm,</span>
<span id="cb73-549"><a href="#cb73-549" aria-hidden="true" tabindex="-1"></a>                         <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>, </span>
<span id="cb73-550"><a href="#cb73-550" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>)))</span>
<span id="cb73-551"><a href="#cb73-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-552"><a href="#cb73-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-553"><a href="#cb73-553" aria-hidden="true" tabindex="-1"></a><span class="fu">### Removing parameters</span></span>
<span id="cb73-554"><a href="#cb73-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-555"><a href="#cb73-555" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>still won't converge?</span>
<span id="cb73-556"><a href="#cb73-556" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>it's time to consider intrusive remedies: removing random effects parameters</span>
<span id="cb73-557"><a href="#cb73-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-558"><a href="#cb73-558" aria-hidden="true" tabindex="-1"></a><span class="fu">## Intrusive methods</span></span>
<span id="cb73-559"><a href="#cb73-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-560"><a href="#cb73-560" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>nonconvergence in maximal models is often due to overfitting</span>
<span id="cb73-561"><a href="#cb73-561" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>i.e., the model is overly complex given your data</span>
<span id="cb73-562"><a href="#cb73-562" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>this is typically due to an overly complex random effects structure</span>
<span id="cb73-563"><a href="#cb73-563" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>if the non-intrusive methods don't lead to convergence, the problem is likely overfitting</span>
<span id="cb73-564"><a href="#cb73-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-565"><a href="#cb73-565" aria-hidden="true" tabindex="-1"></a><span class="fu">### Parsimonious vs. maximal</span></span>
<span id="cb73-566"><a href="#cb73-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-567"><a href="#cb73-567" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>there are different camps on how to deal with this issue</span>
<span id="cb73-568"><a href="#cb73-568" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>I personally follow the suggestions in @bates_parsimonious_2015 (for now)</span>
<span id="cb73-569"><a href="#cb73-569" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>run random effects Principal Components Analysis (<span class="in">`summary(rePCA(model))`</span>, <span class="in">`lme4`</span> package)</span>
<span id="cb73-570"><a href="#cb73-570" aria-hidden="true" tabindex="-1"></a><span class="ss">        + </span>informs by how many parameters our model is overfit</span>
<span id="cb73-571"><a href="#cb73-571" aria-hidden="true" tabindex="-1"></a><span class="ss">    2.  </span>check variance-covariance matrix (<span class="in">`VarCorr(model)`</span>)</span>
<span id="cb73-572"><a href="#cb73-572" aria-hidden="true" tabindex="-1"></a><span class="ss">    3. </span>remove parameters with very high or low Correlation terms and/or much lower variance compared to other terms</span>
<span id="cb73-573"><a href="#cb73-573" aria-hidden="true" tabindex="-1"></a><span class="ss">    4. </span>fit simplified model</span>
<span id="cb73-574"><a href="#cb73-574" aria-hidden="true" tabindex="-1"></a><span class="ss">    5. </span>wash, rinse, repeat</span>
<span id="cb73-575"><a href="#cb73-575" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>we'll practice this method today, but keep in mind that it's up to you to decide and justify which method you use</span>
<span id="cb73-576"><a href="#cb73-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-577"><a href="#cb73-577" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random effects Principal Components Analysis</span></span>
<span id="cb73-578"><a href="#cb73-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-579"><a href="#cb73-579" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>gives us a ranking of all parameters ('components') in our RES per unit</span>
<span id="cb73-580"><a href="#cb73-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-583"><a href="#cb73-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-584"><a href="#cb73-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-585"><a href="#cb73-585" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(fit_verb_fp_mm))</span>
<span id="cb73-586"><a href="#cb73-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-587"><a href="#cb73-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-588"><a href="#cb73-588" aria-hidden="true" tabindex="-1"></a>###</span>
<span id="cb73-589"><a href="#cb73-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-590"><a href="#cb73-590" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>important is the Cumulative Proportion</span>
<span id="cb73-591"><a href="#cb73-591" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>how much of the cumulative variance explained by all the by-unit parameters does this one parameter contribute? </span>
<span id="cb73-592"><a href="#cb73-592" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>we see for item, the first component accounts for 66% of the variance explained, and the next contributes an additional 31%, and the next 3%</span>
<span id="cb73-593"><a href="#cb73-593" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>so two components account for roughly 97% of variance explained by our RES</span>
<span id="cb73-594"><a href="#cb73-594" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>in other words, we can remove one component for sure, and possibly another</span>
<span id="cb73-595"><a href="#cb73-595" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>we could potentially remove 3 components from participant</span>
<span id="cb73-596"><a href="#cb73-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-597"><a href="#cb73-597" aria-hidden="true" tabindex="-1"></a><span class="fu">### Variance-covariance matrix</span></span>
<span id="cb73-598"><a href="#cb73-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-599"><a href="#cb73-599" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>so we can remove 2 parameters from item and participant</span>
<span id="cb73-600"><a href="#cb73-600" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>so either the varying intercept, or slope for tense, grammaticality, or their interaction</span>
<span id="cb73-601"><a href="#cb73-601" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>we can check this with <span class="in">`VarCorr(fit_verb_fp_mm)`</span></span>
<span id="cb73-602"><a href="#cb73-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-605"><a href="#cb73-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-606"><a href="#cb73-606" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-607"><a href="#cb73-607" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(fit_verb_fp_mm)</span>
<span id="cb73-608"><a href="#cb73-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-609"><a href="#cb73-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-610"><a href="#cb73-610" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>for item I would remove <span class="in">`gramm`</span> because it has the lowest variance, and has a pretty high correlation with <span class="in">`verb_t`</span> (which is unlikely to be true)</span>
<span id="cb73-611"><a href="#cb73-611" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>I would also remove <span class="in">`gramm`</span> for participant for the same reason, as well as its high correlation with the intercept and <span class="in">`verb_t`</span></span>
<span id="cb73-612"><a href="#cb73-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-613"><a href="#cb73-613" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Alternate model 1</span></span>
<span id="cb73-614"><a href="#cb73-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-615"><a href="#cb73-615" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>for now let's just remove the interaction term</span>
<span id="cb73-616"><a href="#cb73-616" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>for reproducibility reasons, do not delete the code for a model that did not converge</span>
<span id="cb73-617"><a href="#cb73-617" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>rather, write a comment on what decision was made (and why) for the new model</span>
<span id="cb73-618"><a href="#cb73-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-621"><a href="#cb73-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-622"><a href="#cb73-622" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb73-623"><a href="#cb73-623" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: true</span></span>
<span id="cb73-624"><a href="#cb73-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-625"><a href="#cb73-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-626"><a href="#cb73-626" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_m1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb73-627"><a href="#cb73-627" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">+</span>gramm<span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb73-628"><a href="#cb73-628" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">+</span>gramm<span class="sc">|</span>item),</span>
<span id="cb73-629"><a href="#cb73-629" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb73-630"><a href="#cb73-630" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb73-631"><a href="#cb73-631" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>,</span>
<span id="cb73-632"><a href="#cb73-632" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>))</span>
<span id="cb73-633"><a href="#cb73-633" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-634"><a href="#cb73-634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-635"><a href="#cb73-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-636"><a href="#cb73-636" aria-hidden="true" tabindex="-1"></a><span class="fu">##### `rePCA()`</span></span>
<span id="cb73-639"><a href="#cb73-639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-640"><a href="#cb73-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-641"><a href="#cb73-641" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(fit_verb_fp_m1))</span>
<span id="cb73-642"><a href="#cb73-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-643"><a href="#cb73-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-644"><a href="#cb73-644" aria-hidden="true" tabindex="-1"></a><span class="fu">##### `VarCorr()`</span></span>
<span id="cb73-645"><a href="#cb73-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-648"><a href="#cb73-648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-649"><a href="#cb73-649" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-650"><a href="#cb73-650" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(fit_verb_fp_m1)</span>
<span id="cb73-651"><a href="#cb73-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-652"><a href="#cb73-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-653"><a href="#cb73-653" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>when we see Corr +/-1, this tells us there was an error computing correlations between parameters</span>
<span id="cb73-654"><a href="#cb73-654" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>it is an invitation to explore</span>
<span id="cb73-655"><a href="#cb73-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-656"><a href="#cb73-656" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>this is not plausible, and indicates overfitting in our model</span>
<span id="cb73-657"><a href="#cb73-657" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>we can remove all slopes from sj</span>
<span id="cb73-658"><a href="#cb73-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-659"><a href="#cb73-659" aria-hidden="true" tabindex="-1"></a><span class="fu">##### by-item random effects</span></span>
<span id="cb73-660"><a href="#cb73-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-663"><a href="#cb73-663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-664"><a href="#cb73-664" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">dotplot</span>(<span class="fu">ranef</span>(fit_verb_fp_m1))<span class="sc">$</span>item</span>
<span id="cb73-665"><a href="#cb73-665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-666"><a href="#cb73-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-667"><a href="#cb73-667" aria-hidden="true" tabindex="-1"></a><span class="fu">##### by-participant random effects (with +1 correlations)</span></span>
<span id="cb73-668"><a href="#cb73-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-671"><a href="#cb73-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-672"><a href="#cb73-672" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">dotplot</span>(<span class="fu">ranef</span>(fit_verb_fp_m1))<span class="sc">$</span>sj</span>
<span id="cb73-673"><a href="#cb73-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-674"><a href="#cb73-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-675"><a href="#cb73-675" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-676"><a href="#cb73-676" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Alternate model 2</span></span>
<span id="cb73-677"><a href="#cb73-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-680"><a href="#cb73-680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-681"><a href="#cb73-681" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb73-682"><a href="#cb73-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: true</span></span>
<span id="cb73-683"><a href="#cb73-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-684"><a href="#cb73-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-685"><a href="#cb73-685" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_m2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb73-686"><a href="#cb73-686" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb73-687"><a href="#cb73-687" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">+</span>gramm<span class="sc">|</span>item),</span>
<span id="cb73-688"><a href="#cb73-688" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb73-689"><a href="#cb73-689" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb73-690"><a href="#cb73-690" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>,</span>
<span id="cb73-691"><a href="#cb73-691" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>))</span>
<span id="cb73-692"><a href="#cb73-692" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-693"><a href="#cb73-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-694"><a href="#cb73-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-695"><a href="#cb73-695" aria-hidden="true" tabindex="-1"></a><span class="fu">##### `rePCA()`</span></span>
<span id="cb73-696"><a href="#cb73-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-699"><a href="#cb73-699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-700"><a href="#cb73-700" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(fit_verb_fp_m2))</span>
<span id="cb73-701"><a href="#cb73-701" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-702"><a href="#cb73-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-703"><a href="#cb73-703" aria-hidden="true" tabindex="-1"></a><span class="fu">##### `VarCorr()`</span></span>
<span id="cb73-704"><a href="#cb73-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-707"><a href="#cb73-707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-708"><a href="#cb73-708" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(fit_verb_fp_m2)</span>
<span id="cb73-709"><a href="#cb73-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-710"><a href="#cb73-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-711"><a href="#cb73-711" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>by-item slopes for <span class="in">`gramm`</span> and <span class="in">`verb_t`</span> are highly correlated</span>
<span id="cb73-712"><a href="#cb73-712" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`gramm`</span> has least variance, so let's remove it</span>
<span id="cb73-713"><a href="#cb73-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-714"><a href="#cb73-714" aria-hidden="true" tabindex="-1"></a><span class="fu">##### by-item random effects</span></span>
<span id="cb73-715"><a href="#cb73-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-718"><a href="#cb73-718" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-719"><a href="#cb73-719" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">dotplot</span>(<span class="fu">ranef</span>(fit_verb_fp_m2))<span class="sc">$</span>item</span>
<span id="cb73-720"><a href="#cb73-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-721"><a href="#cb73-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-722"><a href="#cb73-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-723"><a href="#cb73-723" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Alternate model 3</span></span>
<span id="cb73-724"><a href="#cb73-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-727"><a href="#cb73-727" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-728"><a href="#cb73-728" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb73-729"><a href="#cb73-729" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: true</span></span>
<span id="cb73-730"><a href="#cb73-730" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-731"><a href="#cb73-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-732"><a href="#cb73-732" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_m3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb73-733"><a href="#cb73-733" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb73-734"><a href="#cb73-734" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> verb_t<span class="sc">|</span>item),</span>
<span id="cb73-735"><a href="#cb73-735" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb73-736"><a href="#cb73-736" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb73-737"><a href="#cb73-737" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>,</span>
<span id="cb73-738"><a href="#cb73-738" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>))</span>
<span id="cb73-739"><a href="#cb73-739" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-740"><a href="#cb73-740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-741"><a href="#cb73-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-742"><a href="#cb73-742" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>converged!</span>
<span id="cb73-743"><a href="#cb73-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-744"><a href="#cb73-744" aria-hidden="true" tabindex="-1"></a><span class="fu">##### `rePCA()`</span></span>
<span id="cb73-745"><a href="#cb73-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-748"><a href="#cb73-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-749"><a href="#cb73-749" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rePCA</span>(fit_verb_fp_m3))</span>
<span id="cb73-750"><a href="#cb73-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-751"><a href="#cb73-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-752"><a href="#cb73-752" aria-hidden="true" tabindex="-1"></a><span class="fu">##### `VarCorr()`</span></span>
<span id="cb73-753"><a href="#cb73-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-756"><a href="#cb73-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-757"><a href="#cb73-757" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(fit_verb_fp_m3)</span>
<span id="cb73-758"><a href="#cb73-758" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-759"><a href="#cb73-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-760"><a href="#cb73-760" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Alternate model 4</span></span>
<span id="cb73-761"><a href="#cb73-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-762"><a href="#cb73-762" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>but we might've also decided to remove <span class="in">`verb_t`</span>, so let's run that model</span>
<span id="cb73-763"><a href="#cb73-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-766"><a href="#cb73-766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-767"><a href="#cb73-767" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb73-768"><a href="#cb73-768" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: true</span></span>
<span id="cb73-769"><a href="#cb73-769" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-770"><a href="#cb73-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-771"><a href="#cb73-771" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_m4 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb73-772"><a href="#cb73-772" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb73-773"><a href="#cb73-773" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> gramm<span class="sc">|</span>item),</span>
<span id="cb73-774"><a href="#cb73-774" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb73-775"><a href="#cb73-775" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb73-776"><a href="#cb73-776" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>,</span>
<span id="cb73-777"><a href="#cb73-777" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="fl">2e5</span>))</span>
<span id="cb73-778"><a href="#cb73-778" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-779"><a href="#cb73-779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-780"><a href="#cb73-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-781"><a href="#cb73-781" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>does not converge, so we're justified in keeping by-item <span class="in">`verb_t`</span> slopes</span>
<span id="cb73-782"><a href="#cb73-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-783"><a href="#cb73-783" aria-hidden="true" tabindex="-1"></a><span class="fu">### Final model</span></span>
<span id="cb73-784"><a href="#cb73-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-785"><a href="#cb73-785" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the final model name should be some sort of convention to make your life easier</span>
<span id="cb73-786"><a href="#cb73-786" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>so remove model index</span>
<span id="cb73-787"><a href="#cb73-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-790"><a href="#cb73-790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-791"><a href="#cb73-791" aria-hidden="true" tabindex="-1"></a>fit_verb_fp <span class="ot">&lt;-</span> fit_verb_fp_m3</span>
<span id="cb73-792"><a href="#cb73-792" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-793"><a href="#cb73-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-794"><a href="#cb73-794" aria-hidden="true" tabindex="-1"></a><span class="fu">##### by-item random effects</span></span>
<span id="cb73-795"><a href="#cb73-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-798"><a href="#cb73-798" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-799"><a href="#cb73-799" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">dotplot</span>(<span class="fu">ranef</span>(fit_verb_fp))<span class="sc">$</span>sj</span>
<span id="cb73-800"><a href="#cb73-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-801"><a href="#cb73-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-802"><a href="#cb73-802" aria-hidden="true" tabindex="-1"></a><span class="fu">##### by-participant random effects</span></span>
<span id="cb73-803"><a href="#cb73-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-806"><a href="#cb73-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-807"><a href="#cb73-807" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">dotplot</span>(<span class="fu">ranef</span>(fit_verb_fp))<span class="sc">$</span>item</span>
<span id="cb73-808"><a href="#cb73-808" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-809"><a href="#cb73-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-810"><a href="#cb73-810" aria-hidden="true" tabindex="-1"></a><span class="fu">##### `summary()`</span></span>
<span id="cb73-811"><a href="#cb73-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-814"><a href="#cb73-814" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-815"><a href="#cb73-815" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_verb_fp)</span>
<span id="cb73-816"><a href="#cb73-816" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-817"><a href="#cb73-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-818"><a href="#cb73-818" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>IMPORTANTLY, only look at the fixed effects after you've got your final model!!!!</span>
<span id="cb73-819"><a href="#cb73-819" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>i.e., run model -&gt; convergence error -&gt; <span class="in">`rePCA()`</span> + <span class="in">`VarCorr()`</span> -&gt; run model -&gt; ... -&gt; converges -&gt; only NOW run <span class="in">`summary(model)`</span></span>
<span id="cb73-820"><a href="#cb73-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-821"><a href="#cb73-821" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparing to 'bad' models</span></span>
<span id="cb73-822"><a href="#cb73-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-823"><a href="#cb73-823" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>let's compare our final model to our 'bad' models</span>
<span id="cb73-824"><a href="#cb73-824" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>random intercepts-only model (overconfident)</span>
<span id="cb73-825"><a href="#cb73-825" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>maximal model (underconfident)</span>
<span id="cb73-826"><a href="#cb73-826" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-827"><a href="#cb73-827" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random-intercepts only</span></span>
<span id="cb73-828"><a href="#cb73-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-831"><a href="#cb73-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-832"><a href="#cb73-832" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb73-833"><a href="#cb73-833" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: true</span></span>
<span id="cb73-834"><a href="#cb73-834" aria-hidden="true" tabindex="-1"></a><span class="co">#| output-location: fragment</span></span>
<span id="cb73-835"><a href="#cb73-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-836"><a href="#cb73-836" aria-hidden="true" tabindex="-1"></a>fit_verb_fp_intercepts <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(fp) <span class="sc">~</span> verb_t<span class="sc">*</span>gramm <span class="sc">+</span> </span>
<span id="cb73-837"><a href="#cb73-837" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span>sj) <span class="sc">+</span></span>
<span id="cb73-838"><a href="#cb73-838" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span>item),</span>
<span id="cb73-839"><a href="#cb73-839" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_biondo,</span>
<span id="cb73-840"><a href="#cb73-840" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subset =</span> roi <span class="sc">==</span> <span class="dv">4</span></span>
<span id="cb73-841"><a href="#cb73-841" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-842"><a href="#cb73-842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-843"><a href="#cb73-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-844"><a href="#cb73-844" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>converges</span>
<span id="cb73-845"><a href="#cb73-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-848"><a href="#cb73-848" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-849"><a href="#cb73-849" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-850"><a href="#cb73-850" aria-hidden="true" tabindex="-1"></a>sum_fit_verb_fp <span class="ot">&lt;-</span></span>
<span id="cb73-851"><a href="#cb73-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(fit_verb_fp,</span>
<span id="cb73-852"><a href="#cb73-852" aria-hidden="true" tabindex="-1"></a>     <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-853"><a href="#cb73-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-854"><a href="#cb73-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_value =</span> p.value,</span>
<span id="cb73-855"><a href="#cb73-855" aria-hidden="true" tabindex="-1"></a>         <span class="at">model =</span> <span class="st">"parsimonious"</span>) </span>
<span id="cb73-856"><a href="#cb73-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-857"><a href="#cb73-857" aria-hidden="true" tabindex="-1"></a>sum_fit_verb_fp_mm <span class="ot">&lt;-</span></span>
<span id="cb73-858"><a href="#cb73-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(fit_verb_fp_mm,</span>
<span id="cb73-859"><a href="#cb73-859" aria-hidden="true" tabindex="-1"></a>     <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-860"><a href="#cb73-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-861"><a href="#cb73-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_value =</span> p.value,</span>
<span id="cb73-862"><a href="#cb73-862" aria-hidden="true" tabindex="-1"></a>         <span class="at">model =</span> <span class="st">"maximal"</span>) </span>
<span id="cb73-863"><a href="#cb73-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-864"><a href="#cb73-864" aria-hidden="true" tabindex="-1"></a>sum_fit_verb_fp_intercepts <span class="ot">&lt;-</span></span>
<span id="cb73-865"><a href="#cb73-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(fit_verb_fp_intercepts,</span>
<span id="cb73-866"><a href="#cb73-866" aria-hidden="true" tabindex="-1"></a>     <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-867"><a href="#cb73-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-868"><a href="#cb73-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_value =</span> p.value,</span>
<span id="cb73-869"><a href="#cb73-869" aria-hidden="true" tabindex="-1"></a>         <span class="at">model =</span> <span class="st">"intercepts"</span>)</span>
<span id="cb73-870"><a href="#cb73-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-871"><a href="#cb73-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-872"><a href="#cb73-872" aria-hidden="true" tabindex="-1"></a><span class="fu">### coefficient estimates {.smaller}</span></span>
<span id="cb73-873"><a href="#cb73-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-876"><a href="#cb73-876" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-877"><a href="#cb73-877" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-estimates</span></span>
<span id="cb73-878"><a href="#cb73-878" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-879"><a href="#cb73-879" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Coefficient estimates for our parsimonious model, a random-intercepts only model, and a maximal model"</span></span>
<span id="cb73-880"><a href="#cb73-880" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sum_fit_verb_fp, sum_fit_verb_fp_intercepts, sum_fit_verb_fp_mm) <span class="sc">|&gt;</span> </span>
<span id="cb73-881"><a href="#cb73-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, model) <span class="sc">|&gt;</span></span>
<span id="cb73-882"><a href="#cb73-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">round</span>(estimate,<span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb73-883"><a href="#cb73-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb73-884"><a href="#cb73-884" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(term),</span>
<span id="cb73-885"><a href="#cb73-885" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> model,</span>
<span id="cb73-886"><a href="#cb73-886" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> estimate</span>
<span id="cb73-887"><a href="#cb73-887" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb73-888"><a href="#cb73-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"estimate"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-889"><a href="#cb73-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-890"><a href="#cb73-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb73-891"><a href="#cb73-891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-892"><a href="#cb73-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-893"><a href="#cb73-893" aria-hidden="true" tabindex="-1"></a><span class="fu">### standard error {.smaller}</span></span>
<span id="cb73-894"><a href="#cb73-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-897"><a href="#cb73-897" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-898"><a href="#cb73-898" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-std_error</span></span>
<span id="cb73-899"><a href="#cb73-899" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-900"><a href="#cb73-900" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Standard error of coefficient estimates for our parsimonious model, a random-intercepts only model, and a maximal model"</span></span>
<span id="cb73-901"><a href="#cb73-901" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sum_fit_verb_fp, sum_fit_verb_fp_intercepts, sum_fit_verb_fp_mm) <span class="sc">|&gt;</span> </span>
<span id="cb73-902"><a href="#cb73-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, std.error, model) <span class="sc">|&gt;</span></span>
<span id="cb73-903"><a href="#cb73-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">std.error =</span> <span class="fu">round</span>(std.error,<span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb73-904"><a href="#cb73-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb73-905"><a href="#cb73-905" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(term),</span>
<span id="cb73-906"><a href="#cb73-906" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> model,</span>
<span id="cb73-907"><a href="#cb73-907" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> std.error</span>
<span id="cb73-908"><a href="#cb73-908" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb73-909"><a href="#cb73-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"std.error"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-910"><a href="#cb73-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-911"><a href="#cb73-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb73-912"><a href="#cb73-912" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-913"><a href="#cb73-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-914"><a href="#cb73-914" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>standard error (<span class="sc">\\</span>$SE = \frac{\sigma}{\sqrt{n}}<span class="sc">\\</span>$) is a measure of uncertainty</span>
<span id="cb73-915"><a href="#cb73-915" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>larger values reflect greater uncertainty</span>
<span id="cb73-916"><a href="#cb73-916" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>because $n$ is in the denominator, SE gets smaller with more observations</span>
<span id="cb73-917"><a href="#cb73-917" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>compared to our parsimonious model with by-item varying <span class="in">`verb_t`</span> slopes:</span>
<span id="cb73-918"><a href="#cb73-918" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>smaller SE for our overconfident (intercepts) model</span>
<span id="cb73-919"><a href="#cb73-919" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>larger SE for our underconfident (maximal) model</span>
<span id="cb73-920"><a href="#cb73-920" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>but only for the estimate also included in the random effects</span>
<span id="cb73-921"><a href="#cb73-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-922"><a href="#cb73-922" aria-hidden="true" tabindex="-1"></a><span class="fu">### t-values {.smaller}</span></span>
<span id="cb73-923"><a href="#cb73-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-926"><a href="#cb73-926" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-927"><a href="#cb73-927" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-t_value</span></span>
<span id="cb73-928"><a href="#cb73-928" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-929"><a href="#cb73-929" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "t-values of each estimates for our parsimonious model, a random-intercepts only model, and a maximal model"</span></span>
<span id="cb73-930"><a href="#cb73-930" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sum_fit_verb_fp, sum_fit_verb_fp_intercepts, sum_fit_verb_fp_mm) <span class="sc">|&gt;</span> </span>
<span id="cb73-931"><a href="#cb73-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, statistic, model) <span class="sc">|&gt;</span></span>
<span id="cb73-932"><a href="#cb73-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">statistic =</span> <span class="fu">round</span>(statistic,<span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb73-933"><a href="#cb73-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb73-934"><a href="#cb73-934" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(term),</span>
<span id="cb73-935"><a href="#cb73-935" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> model,</span>
<span id="cb73-936"><a href="#cb73-936" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> statistic</span>
<span id="cb73-937"><a href="#cb73-937" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb73-938"><a href="#cb73-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"statistic"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-939"><a href="#cb73-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-940"><a href="#cb73-940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb73-941"><a href="#cb73-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-942"><a href="#cb73-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-943"><a href="#cb73-943" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>t-value (<span class="sc">\\</span>$t = \frac{\bar{x}_1 - \bar{x}_2}{SE}<span class="sc">\\</span>$) is a measure of uncertainty</span>
<span id="cb73-944"><a href="#cb73-944" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>larger values reflect greater effect</span>
<span id="cb73-945"><a href="#cb73-945" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>more $n$ increases $t$</span>
<span id="cb73-946"><a href="#cb73-946" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>again, <span class="in">`verb_t`</span>: $t_{max}$ &lt; $t_{pars}$ &lt; $t_{int}$</span>
<span id="cb73-947"><a href="#cb73-947" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-948"><a href="#cb73-948" aria-hidden="true" tabindex="-1"></a><span class="fu">### degrees of freedom {.smaller}</span></span>
<span id="cb73-949"><a href="#cb73-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-952"><a href="#cb73-952" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-953"><a href="#cb73-953" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-df</span></span>
<span id="cb73-954"><a href="#cb73-954" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-955"><a href="#cb73-955" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Degrees of freedom of each estimates for our parsimonious model, a random-intercepts only model, and a maximal model"</span></span>
<span id="cb73-956"><a href="#cb73-956" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sum_fit_verb_fp, sum_fit_verb_fp_intercepts, sum_fit_verb_fp_mm) <span class="sc">|&gt;</span> </span>
<span id="cb73-957"><a href="#cb73-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, df, model) <span class="sc">|&gt;</span></span>
<span id="cb73-958"><a href="#cb73-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">df =</span> <span class="fu">round</span>(df,<span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb73-959"><a href="#cb73-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb73-960"><a href="#cb73-960" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(term),</span>
<span id="cb73-961"><a href="#cb73-961" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> model,</span>
<span id="cb73-962"><a href="#cb73-962" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> df</span>
<span id="cb73-963"><a href="#cb73-963" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb73-964"><a href="#cb73-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"df"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-965"><a href="#cb73-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-966"><a href="#cb73-966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb73-967"><a href="#cb73-967" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-968"><a href="#cb73-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-969"><a href="#cb73-969" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>degrees of freedom: not trivially defined in mixed models; we're using Satterthwaite approximiation (default in <span class="in">`lmerTest::lmer()`</span>)</span>
<span id="cb73-970"><a href="#cb73-970" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>larger degrees of freedom corresponds to larger $n$</span>
<span id="cb73-971"><a href="#cb73-971" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>including more random effects reduces our $n$ and therefore reduces $df$</span>
<span id="cb73-972"><a href="#cb73-972" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>again, <span class="in">`verb_t`</span>: $df_{max}$ &lt; $df_{pars}$ &lt; $df_{int}$</span>
<span id="cb73-973"><a href="#cb73-973" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>and large differences between our maximal model and the other two for other terms</span>
<span id="cb73-974"><a href="#cb73-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-975"><a href="#cb73-975" aria-hidden="true" tabindex="-1"></a><span class="fu">### p-values {.smaller}</span></span>
<span id="cb73-976"><a href="#cb73-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-979"><a href="#cb73-979" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-980"><a href="#cb73-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-p_value</span></span>
<span id="cb73-981"><a href="#cb73-981" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-982"><a href="#cb73-982" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "p-values of coefficient estimates for our parsimonious model, a random-intercepts only model, and a maximal model"</span></span>
<span id="cb73-983"><a href="#cb73-983" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sum_fit_verb_fp, sum_fit_verb_fp_intercepts, sum_fit_verb_fp_mm) <span class="sc">|&gt;</span> </span>
<span id="cb73-984"><a href="#cb73-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, p.value, model) <span class="sc">|&gt;</span></span>
<span id="cb73-985"><a href="#cb73-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">round</span>(p.value, <span class="dv">8</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb73-986"><a href="#cb73-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb73-987"><a href="#cb73-987" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(term),</span>
<span id="cb73-988"><a href="#cb73-988" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> model,</span>
<span id="cb73-989"><a href="#cb73-989" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> p.value</span>
<span id="cb73-990"><a href="#cb73-990" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb73-991"><a href="#cb73-991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">measure =</span> <span class="st">"p.value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-992"><a href="#cb73-992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-993"><a href="#cb73-993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb73-994"><a href="#cb73-994" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-995"><a href="#cb73-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-996"><a href="#cb73-996" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p-values: inversely related to t-values (larger t-values = smaller p-values)</span>
<span id="cb73-997"><a href="#cb73-997" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>again, <span class="in">`verb_t`</span>: $p_{max}$ &lt; $p_{pars}$ &lt; $p_{int}$</span>
<span id="cb73-998"><a href="#cb73-998" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>this would be important for 'signicance' if the values were closer to the convential alpha-levels (p &lt; .05, p &lt; .01, p &lt; .001)</span>
<span id="cb73-999"><a href="#cb73-999" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>but here the different random effects structures don't qualitatively change (all are &lt; .001)</span>
<span id="cb73-1000"><a href="#cb73-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>this is not always the case, however!</span>
<span id="cb73-1001"><a href="#cb73-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>this is why we do not peek at the fixed effects until we have our final model</span>
<span id="cb73-1002"><a href="#cb73-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>we don't want to be influenced (consciously or not) by seeing small p-values in one model but not another</span>
<span id="cb73-1003"><a href="#cb73-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1004"><a href="#cb73-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reporting</span></span>
<span id="cb73-1005"><a href="#cb73-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1006"><a href="#cb73-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>in Data Analysis section, e.g., </span>
<span id="cb73-1007"><a href="#cb73-1007" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-1008"><a href="#cb73-1008" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; We included Time Reference (past, future), and Verb Match (match, mismatch) as fixed-effect factors in the models used to investigate the processing of past–future violations (Q1), by adopting sum contrast coding (Schad et al., 2020): past and match conditions were coded as –.5. while future and mismatch conditions were coded as .5. </span><span class="co">[</span><span class="ot">...</span><span class="co">]</span><span class="at"> Moreover, we included crossed random intercepts and random slopes for all fixed-effect parameters for subject and item grouping factors (Barr et al., 2013) in all models. </span></span>
<span id="cb73-1009"><a href="#cb73-1009" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb73-1010"><a href="#cb73-1010" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; We reduced the complexity of the random effect structure of the maximal model by performing a principal component analysis so as to identify the most parsimonious model properly supported by the data (Bates et al., 2015). </span><span class="co">[</span><span class="ot">...</span><span class="co">]</span><span class="at"> all reading time data were log transformed before performing the analyses.</span></span>
<span id="cb73-1011"><a href="#cb73-1011" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb73-1012"><a href="#cb73-1012" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; --- @biondo_yesterday_2022, p. 9</span></span>
<span id="cb73-1013"><a href="#cb73-1013" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-1014"><a href="#cb73-1014" aria-hidden="true" tabindex="-1"></a><span class="fu">### Formatted p-values</span></span>
<span id="cb73-1015"><a href="#cb73-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1016"><a href="#cb73-1016" aria-hidden="true" tabindex="-1"></a>We can create our own function, which we will call <span class="in">`format_pval()`</span>, to produce formatted p-values. Here we use the <span class="in">`case_when()`</span> function to print <span class="in">`&lt; .05`</span>, <span class="in">`&lt; .01`</span> or <span class="in">`&lt; .001`</span> when the p-value is smaller than these values (which is a convention). Otherwise (<span class="in">`TRUE`</span>), round the p-value to 3 decimal points.</span>
<span id="cb73-1017"><a href="#cb73-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1020"><a href="#cb73-1020" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1021"><a href="#cb73-1021" aria-hidden="true" tabindex="-1"></a><span class="do">## function to format p-values to APA7 guidelines</span></span>
<span id="cb73-1022"><a href="#cb73-1022" aria-hidden="true" tabindex="-1"></a>format_pval <span class="ot">&lt;-</span> <span class="cf">function</span>(pval){</span>
<span id="cb73-1023"><a href="#cb73-1023" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb73-1024"><a href="#cb73-1024" aria-hidden="true" tabindex="-1"></a>        pval <span class="sc">&lt;</span> .<span class="dv">001</span> <span class="sc">~</span> <span class="st">"&lt; .001"</span>,</span>
<span id="cb73-1025"><a href="#cb73-1025" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">str_remove</span>(<span class="fu">round</span>(pval, <span class="dv">3</span>), <span class="st">"^0+"</span>)</span>
<span id="cb73-1026"><a href="#cb73-1026" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb73-1027"><a href="#cb73-1027" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-1028"><a href="#cb73-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1029"><a href="#cb73-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1030"><a href="#cb73-1030" aria-hidden="true" tabindex="-1"></a>We can now use our <span class="in">`format_pval()`</span> function to format our p-values and print them in a table, as in @tbl-format_pval. </span>
<span id="cb73-1031"><a href="#cb73-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1034"><a href="#cb73-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1035"><a href="#cb73-1035" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-format_pval</span></span>
<span id="cb73-1036"><a href="#cb73-1036" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Table with formatted p-values from `format_pval()`"</span></span>
<span id="cb73-1037"><a href="#cb73-1037" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-1038"><a href="#cb73-1038" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb73-1039"><a href="#cb73-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(fit_verb_fp,</span>
<span id="cb73-1040"><a href="#cb73-1040" aria-hidden="true" tabindex="-1"></a>     <span class="at">effects =</span> <span class="st">"fixed"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-1041"><a href="#cb73-1041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-1042"><a href="#cb73-1042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_value =</span> <span class="fu">format_pval</span>(p.value)) <span class="sc">|&gt;</span> </span>
<span id="cb73-1043"><a href="#cb73-1043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>p.value) <span class="sc">|&gt;</span> </span>
<span id="cb73-1044"><a href="#cb73-1044" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-1045"><a href="#cb73-1045" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span>
<span id="cb73-1046"><a href="#cb73-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1047"><a href="#cb73-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1048"><a href="#cb73-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1049"><a href="#cb73-1049" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb73-1050"><a href="#cb73-1050" aria-hidden="true" tabindex="-1"></a><span class="fu"># APA 7 guidelines: formatting p-values</span></span>
<span id="cb73-1051"><a href="#cb73-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1052"><a href="#cb73-1052" aria-hidden="true" tabindex="-1"></a>The guidelines from the 7th edition from the American Psychological Association pertaining to numbers and statistics define how we should be formatting *p*-values, summarised in the <span class="co">[</span><span class="ot">Guide for Numbers and Statistics</span><span class="co">](https://apastyle.apa.org/instructional-aids/numbers-statistics-guide.pdf)</span> <span class="co">[</span><span class="ot">@apa_numbers_2022</span><span class="co">]</span>. A summary:</span>
<span id="cb73-1053"><a href="#cb73-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1054"><a href="#cb73-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Don't use leading 0's (i.e., zero before a decimal) when the statistic cannot be greater than 1 (proportion, correlation, level of statistical significance).</span>
<span id="cb73-1055"><a href="#cb73-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report exact *p*-values to two or three decimals (e.g., p = .006, p = .03). i.e., no trailing 0's</span>
<span id="cb73-1056"><a href="#cb73-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report *p*-values less than .001 as "p &lt; .001". </span>
<span id="cb73-1057"><a href="#cb73-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Do not repeat statistics in both the text and a table or figure</span>
<span id="cb73-1058"><a href="#cb73-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1059"><a href="#cb73-1059" aria-hidden="true" tabindex="-1"></a>We used the <span class="in">`round()`</span> function from base R to round *p*-values to 3 decimal points. This function drops trailing 0's, so <span class="in">`0.030`</span> will become <span class="in">`0.03`</span>. We also use the <span class="in">`str_remove()`</span> function from the <span class="in">`stringr`</span> package (Tidyverse), which takes the results from <span class="in">`round()`</span> and removes any leading 0's (i.e., those before the decimal) as defined by the regular expression (<span class="in">`regex`</span>) <span class="in">`^0+`</span>. This will take <span class="in">`0.03`</span> and print <span class="in">`.03`</span>.</span>
<span id="cb73-1060"><a href="#cb73-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1061"><a href="#cb73-1061" aria-hidden="true" tabindex="-1"></a>Here is some example output using <span class="in">`round()`</span>:</span>
<span id="cb73-1062"><a href="#cb73-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1065"><a href="#cb73-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1066"><a href="#cb73-1066" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fl">0.020001</span>,<span class="dv">3</span>)</span>
<span id="cb73-1067"><a href="#cb73-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1068"><a href="#cb73-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1069"><a href="#cb73-1069" aria-hidden="true" tabindex="-1"></a>And removing the leading 0 using <span class="in">`str_remove()`</span>:</span>
<span id="cb73-1070"><a href="#cb73-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1073"><a href="#cb73-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1074"><a href="#cb73-1074" aria-hidden="true" tabindex="-1"></a><span class="fu">str_remove</span>(<span class="fu">round</span>(<span class="fl">0.020001</span>,<span class="dv">3</span>), <span class="st">"^0+"</span>)</span>
<span id="cb73-1075"><a href="#cb73-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1076"><a href="#cb73-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1077"><a href="#cb73-1077" aria-hidden="true" tabindex="-1"></a>If our *p*-value is smaller than .001, then it will be written as <span class="in">`&lt; .001`</span>:</span>
<span id="cb73-1078"><a href="#cb73-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1081"><a href="#cb73-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1082"><a href="#cb73-1082" aria-hidden="true" tabindex="-1"></a><span class="fu">format_pval</span>(<span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.02</span>, <span class="fl">0.002</span>, <span class="fl">0.0002</span>))</span>
<span id="cb73-1083"><a href="#cb73-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1084"><a href="#cb73-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1085"><a href="#cb73-1085" aria-hidden="true" tabindex="-1"></a>So now our *p*-values are formatted according to APA 7 guidelines, as long as we pass them through <span class="in">`format_pval()`</span>.</span>
<span id="cb73-1086"><a href="#cb73-1086" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-1087"><a href="#cb73-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1088"><a href="#cb73-1088" aria-hidden="true" tabindex="-1"></a><span class="fu"># Alternatives to `lme4`</span></span>
<span id="cb73-1089"><a href="#cb73-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1090"><a href="#cb73-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>other alternatives that have fewer convergence issues:</span>
<span id="cb73-1091"><a href="#cb73-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>Julia</span>
<span id="cb73-1092"><a href="#cb73-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>e.g., in VS Code IDE</span>
<span id="cb73-1093"><a href="#cb73-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>Bayesian framework (e.g., <span class="in">`brms`</span> R package)</span>
<span id="cb73-1094"><a href="#cb73-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>also run (G)LMMs, but abandons arbitrary p-values</span>
<span id="cb73-1095"><a href="#cb73-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>instead quantifies uncertainty</span>
<span id="cb73-1096"><a href="#cb73-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>both are more more computationally powerful</span>
<span id="cb73-1097"><a href="#cb73-1097" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>the are not (yet) as widely used in the field</span>
<span id="cb73-1098"><a href="#cb73-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1099"><a href="#cb73-1099" aria-hidden="true" tabindex="-1"></a><span class="fu"># Learning objectives 🏁 {.unnumbered .unlisted .uncounted}</span></span>
<span id="cb73-1100"><a href="#cb73-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1101"><a href="#cb73-1101" aria-hidden="true" tabindex="-1"></a>Today we learned...</span>
<span id="cb73-1102"><a href="#cb73-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1103"><a href="#cb73-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the history of mixed models (again)  ✅</span>
<span id="cb73-1104"><a href="#cb73-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>strategies for model selection  ✅</span>
<span id="cb73-1105"><a href="#cb73-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>variability in model selection  ✅</span>
<span id="cb73-1106"><a href="#cb73-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1107"><a href="#cb73-1107" aria-hidden="true" tabindex="-1"></a>and how to...</span>
<span id="cb73-1108"><a href="#cb73-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1109"><a href="#cb73-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>apply remedies for nonconvergence ✅</span>
<span id="cb73-1110"><a href="#cb73-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>reduce our RES with a data-driven approach  ✅</span>
<span id="cb73-1111"><a href="#cb73-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>compare a parsimonious model to maximal and intercept-only models  ✅</span>
<span id="cb73-1112"><a href="#cb73-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1113"><a href="#cb73-1113" aria-hidden="true" tabindex="-1"></a><span class="fu"># Important terms {.unnumbered .smaller .uncounted}</span></span>
<span id="cb73-1114"><a href="#cb73-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1115"><a href="#cb73-1115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r terms}</span></span>
<span id="cb73-1116"><a href="#cb73-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-1117"><a href="#cb73-1117" aria-hidden="true" tabindex="-1"></a>content <span class="ot">&lt;-</span> </span>
<span id="cb73-1118"><a href="#cb73-1118" aria-hidden="true" tabindex="-1"></a>  googlesheets4<span class="sc">::</span><span class="fu">read_sheet</span>(<span class="st">"https://docs.google.com/spreadsheets/d/17CqdxKL9lyy-PbTB2ZnfWNWs4oV--CcBvrqlh_aEPGQ/edit?usp=sharing"</span>)</span>
<span id="cb73-1119"><a href="#cb73-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1120"><a href="#cb73-1120" aria-hidden="true" tabindex="-1"></a>content <span class="sc">|&gt;</span> </span>
<span id="cb73-1121"><a href="#cb73-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Lecture topic</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"08 - LMMs 1: random intercepts"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-1122"><a href="#cb73-1122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Lecture topic</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-1123"><a href="#cb73-1123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() </span>
<span id="cb73-1124"><a href="#cb73-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1125"><a href="#cb73-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1126"><a href="#cb73-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1127"><a href="#cb73-1127" aria-hidden="true" tabindex="-1"></a><span class="fu"># References {.unlisted .unnumbered visibility="uncounted"}</span></span>
<span id="cb73-1128"><a href="#cb73-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1129"><a href="#cb73-1129" aria-hidden="true" tabindex="-1"></a>::: {#refs custom-style="Bibliography"}</span>
<span id="cb73-1130"><a href="#cb73-1130" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-1131"><a href="#cb73-1131" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>