<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniela Palleschi">
<meta name="dcterms.date" content="2023-10-11">

<title>Regression for Linguists - 5&nbsp; Categorical predictors</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-logistic_regression.html" rel="next">
<link href="./04-multiple_regression.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: {autoNumber: "AMS"} },
  tex2jax: {inlineMath: [ ['$','$'], ["\\(","\\)"] ]}
});
</script>

<!-- This is what works with Quarto -->
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Regression for Linguists - 5&nbsp; Categorical predictors">
<meta name="twitter:description" content="Regression for Linguists">
<meta name="twitter:image" content="05-categorical_predictors_files/figure-html/unnamed-chunk-5-1.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Regression for Linguists</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://daniela-palleschi.github.io/" rel="" target=""><i class="bi bi-home" role="img">
</i> 
 <span class="menu-text">D. Palleschi</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/daniela-palleschi/reg4ling" rel="" target=""><i class="bi bi-github" role="img" aria-label="Source Code">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://moodle.hu-berlin.de/course/view.php?id=121978" rel="" target=""><i class="bi bi-life-preserver" role="img" aria-label="Course Moodle">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
    <a href="./Regression-for-Linguists.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-multiple_regression.html">Day 2: Multiple regression</a></li><li class="breadcrumb-item"><a href="./05-categorical_predictors.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Categorical predictors</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-course_overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources and Set-up</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Day 1: Simple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-equation_of_a_line.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Understanding straight lines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-simple_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-continuous_predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Continuous predictors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Day 2: Multiple regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-multiple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multiple Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-categorical_predictors.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Categorical predictors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Day 3: Logistic regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-logistic_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Report 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reports/report 1/report1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Report 1</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Mixed models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-independence_assumption.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Independence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-mixed_models1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Random intercepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-mixed_models2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Random slopes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-shrinkage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Shrinkage and Partial Pooling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-model_selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model selection</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Report 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reports/report 2/report2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Report 2</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#set-up-environment" id="toc-set-up-environment" class="nav-link active" data-scroll-target="#set-up-environment">Set-up environment</a></li>
  <li><a href="#categorical-predictors" id="toc-categorical-predictors" class="nav-link" data-scroll-target="#categorical-predictors"><span class="header-section-number">5.1</span> Categorical predictors</a>
  <ul class="collapse">
  <li><a href="#including-a-categorical-predictor" id="toc-including-a-categorical-predictor" class="nav-link" data-scroll-target="#including-a-categorical-predictor"><span class="header-section-number">5.1.1</span> Including a categorical predictor</a></li>
  </ul></li>
  <li><a href="#sum-contrasts" id="toc-sum-contrasts" class="nav-link" data-scroll-target="#sum-contrasts"><span class="header-section-number">5.2</span> Sum contrasts</a>
  <ul class="collapse">
  <li><a href="#exploring-predicted-values" id="toc-exploring-predicted-values" class="nav-link" data-scroll-target="#exploring-predicted-values"><span class="header-section-number">5.2.1</span> Exploring predicted values</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">5.3</span> Summary</a>
  <ul class="collapse">
  <li><a href="#important-terms" id="toc-important-terms" class="nav-link" data-scroll-target="#important-terms">Important terms</a></li>
  </ul></li>
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task"><span class="header-section-number">5.4</span> Task</a>
  <ul class="collapse">
  <li><a href="#treatment-contrasts" id="toc-treatment-contrasts" class="nav-link" data-scroll-target="#treatment-contrasts"><span class="header-section-number">5.4.1</span> Treatment contrasts</a></li>
  <li><a href="#sum-contrasts-1" id="toc-sum-contrasts-1" class="nav-link" data-scroll-target="#sum-contrasts-1"><span class="header-section-number">5.4.2</span> Sum contrasts</a></li>
  <li><a href="#multiple-regression" id="toc-multiple-regression" class="nav-link" data-scroll-target="#multiple-regression"><span class="header-section-number">5.4.3</span> Multiple regression</a></li>
  </ul></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session Info</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Categorical predictors</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">Regression for Linguists</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Daniela Palleschi </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Humboldt-Universität zu Berlin
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 11, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">January 5, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="learning-objectives" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<p>Today we will learn…</p>
<ul>
<li>about cateogorical predictors</li>
<li>how to interpret different contrast coding</li>
</ul>
</section>
<section id="set-up-environment" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="set-up-environment">Set-up environment</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># suppress scientific notation</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll also need to load in our required packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>               tidyverse,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>               here,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>               broom,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>               lme4,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>               janitor,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>               languageR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-data" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="load-data">Load data</h3>
<p>Let’s continue working with the <code>english</code> dataset from the <code>languageR</code> package. Let’s just call it <code>df_freq_eng</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="ot">&lt;-</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(english) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(RTlexdec, RTnaming, Word, LengthInLetters, AgeSubject, WrittenFrequency) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rt_lexdec =</span> RTlexdec,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">rt_naming =</span> RTnaming,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">freq_written =</span> WrittenFrequency) <span class="sc">|&gt;</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># standardize continuous predictors</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">freq_z =</span> <span class="fu">scale</span>(freq_written),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">length_z =</span> <span class="fu">scale</span>(length_in_letters)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(word) <span class="sc">|&gt;</span> </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(word)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In your exploratory data analysis, you might’ve noticed a <em>bimodal</em> distribution.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-categorical_predictors_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This looks like a <em>bimodal</em> distribution, i.e., there are two <em>modes</em> (most frequent value, i.e., peak in a histogram). What might be driving this? We know that there were two subject groups: old and young. How does the distribution of these two groups look?</p>
<p>Running our model of the log reaction times as predicted by frequency and length, we see:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fit_freq_length <span class="ot">&lt;-</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(rt_lexdec <span class="sc">~</span> freq_z<span class="sc">*</span>length_z,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df_freq_eng)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_freq_length)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1896649</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_freq_length)<span class="sc">$</span>adj.r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1891323</code></pre>
</div>
</div>
<p>Seems like we don’t have any overfitting in our model (<span class="math inline">\(R^2\)</span> and adjusted <span class="math inline">\(R^2\)</span> are comparable). Let’s look at our coeffiecients.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_freq_length) <span class="sc">|&gt;</span> <span class="fu">select</span>(term, estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  term            estimate
  &lt;chr&gt;              &lt;dbl&gt;
1 (Intercept)      6.55   
2 freq_z          -0.0682 
3 length_z         0.00328
4 freq_z:length_z -0.00196</code></pre>
</div>
</div>
<p>There is a negative slope for frequency, indicating shorter reaction times for words with higher frequency (when holding length constant). There is a positive slope for length, indicating longer reaction times for longer words (holding frequency constant). There is also a negative interaction estimate, indicating that when both length and frequency increase, reaction times decrease. This seems similar to the dataset we explored in the previous sections. But, this bimodal distribution is suggesting we should include age group as a predictor, since the two groups seem to pattern differently in their reading times. Could it be that the effect of frequency and length also differ as a function of age group?</p>
</section>
</section>
<section id="categorical-predictors" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="categorical-predictors"><span class="header-section-number">5.1</span> Categorical predictors</h2>
<p>In linguistic research we often want to compare the effect of <em>groups</em> or categories, such as native or non-native speakers, or grammatical or ungrammatical stimuli. We might expect longer reading times for non-native (compared to native) speakers of a language, or for ungrammatical (versus grammatical) sentences. With our current dataset, we’d predict longer reading times for older participants than younger participants (although we should hypothesise <em>before</em> collecting and visualising our data!). How might these age effects interact with effects of word frequency and length?</p>
<section id="including-a-categorical-predictor" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="including-a-categorical-predictor"><span class="header-section-number">5.1.1</span> Including a categorical predictor</h3>
<p>What would happen if we just include <code>age_subject</code> in our model?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fit_age <span class="ot">&lt;-</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(rt_lexdec <span class="sc">~</span> freq_z<span class="sc">*</span>length_z <span class="sc">+</span> age_subject,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df_freq_eng)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First, we see that adding age to our model results in a large increase in variance explained, and that the <span class="math inline">\(R^2\)</span> and adjusted <span class="math inline">\(R^2\)</span> values are comparable. In addition, the VIF values for all coefficients are near 1. This indicates that our predictors all contribute to the variance explained by the model and are not correlated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_age)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6888949</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_age)<span class="sc">$</span>adj.r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6886222</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(fit_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         freq_z        length_z     age_subject freq_z:length_z 
       1.012553        1.004461        1.000000        1.008108 </code></pre>
</div>
</div>
<p>Now that we see that our model is not overfit and that our predictors are not correlatd, let’s take a look at our model estimates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_age) <span class="sc">|&gt;</span> <span class="fu">select</span>(term,estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  term             estimate
  &lt;chr&gt;               &lt;dbl&gt;
1 (Intercept)       6.66   
2 freq_z           -0.0682 
3 length_z          0.00328
4 age_subjectyoung -0.222  
5 freq_z:length_z  -0.00196</code></pre>
</div>
</div>
<p>In addition to the effects we observed in our earlier model, we see that there is a negative slope for <code>age_subjectyoung</code>, indicating that reaction times decrease when…what? How do we interpret a slope for a categorical variable? Regression works with numerical values, so how does a categorical variable get fit to a line? If we feed a categorical variable into the <code>lm()</code> function, the factor levels (i.e., the categories in a categorical variable) are given numerical values. We need to know what these values are in order to know how to interpret our model estimates. We call these numerical values mapped onto factor levels contrast coding, and we can check the contrasts of a given factor using the function <code>contrasts()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_freq_eng<span class="sc">$</span>age_subject)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      young
old       0
young     1</code></pre>
</div>
</div>
<p>We see that <code>old</code> was coded at <span class="math inline">\(0\)</span> and <code>young</code> as <span class="math inline">\(1\)</span>. This means that our slope for <code>age_subjectyoung</code> represents the change in reaction times when we move from <code>old</code> to <code>young</code>, which corresponds to a 1-unit change in our predictor (because the difference between 0 and 1 is 1). This is called treatment coding, or dummy coding, where one factor level is coded as 0 and the other as 1. Let’s remove the continuous variable for now and focus on <code>age_subject</code>. Let’s also look at raw reaction times, to more easily interpret the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fit_age <span class="ot">&lt;-</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">exp</span>(rt_lexdec) <span class="sc">~</span> age_subject,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df_freq_eng)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_age)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4682224</code></pre>
</div>
</div>
<p>Our <span class="math inline">\(R^2\)</span> value is lower than when we included frequency and length, but higher still than our model with frequeny and length but no age.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_age) <span class="sc">|&gt;</span> <span class="fu">select</span>(term, estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  term             estimate
  &lt;chr&gt;               &lt;dbl&gt;
1 (Intercept)          787.
2 age_subjectyoung    -157.</code></pre>
</div>
</div>
<p>We see that there is an estimated decrease in reaction times of 157ms for the young group compared to the old group. But what does the intercept represent here? Let’s look at our data again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rt_lexdec, age_subject) <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt_lexdec =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">|&gt;</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   rt_lexdec      age_subject 
 Min.   : 495.4   old  :2284  
 1st Qu.: 617.4   young:2284  
 Median : 699.6               
 Mean   : 708.1               
 3rd Qu.: 775.3               
 Max.   :1323.2               </code></pre>
</div>
</div>
<p>And how does <code>rt_lexdec</code> differ between the groups?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rt_lexdec, age_subject) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt_lexdec =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">|&gt;</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(rt_lexdec),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(rt_lexdec),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(rt_lexdec),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="st">"age_subject"</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  age_subject     mean    min    max
1       young 629.5473 495.38  971.8
2         old 786.7200 603.77 1323.2</code></pre>
</div>
</div>
<p>We see here that the intercept for our model actually corresponds to the mean reaction time for the old group. Why is this? Recall that the intercept corresponds to the <span class="math inline">\(y\)</span> value (reaction time) when <span class="math inline">\(x\)</span> is <span class="math inline">\(0\)</span>. In treatment/dummy coding, one factor level is coded as <span class="math inline">\(0\)</span>. In our case this was <code>old</code>, and so the intercept corresponds to the mean reaction time for participants in the old group. How does R choose which variable to code as <span class="math inline">\(0\)</span>? It simply takes the first level name alphabetically: <code>old</code> comes before <code>young</code>, so <code>old</code> was automatically taken as the ‘baseline’ to which <code>young</code> was compared.</p>
<p>And if we were to add the slope to the intercept, we would get the mean for the <span class="math inline">\(young\)</span> group. Why is this?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit_age)[<span class="st">'(Intercept)'</span>] <span class="sc">+</span> <span class="fu">coef</span>(fit_age)[<span class="st">'age_subjectyoung'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   629.5473 </code></pre>
</div>
</div>
<p>Why are the means for the two groups used? The mean is the value closest to all values in a univariate dataset, and regression aims to inimise residuals (recall the line of best fit). So, a line is fit between the means of these two factor levels to achieve minimal residuals. This actually is the same thing as a <em>t</em>-test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">exp</span>(rt_lexdec) <span class="sc">~</span> age_subject, <span class="at">data =</span> df_freq_eng)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  exp(rt_lexdec) by age_subject
t = 63.406, df = 4144.6, p-value &lt; 0.00000000000000022
alternative hypothesis: true difference in means between group old and group young is not equal to 0
95 percent confidence interval:
 152.3128 162.0325
sample estimates:
  mean in group old mean in group young 
           786.7200            629.5473 </code></pre>
</div>
</div>
<p>If we compare this to our model, we see that the <em>t</em>- and <em>p</em>-values are identical (more on these later).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term             estimate std.error statistic p.value
  &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)          787.      1.75     449.        0
2 age_subjectyoung    -157.      2.48     -63.4       0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fig_nocontrasts <span class="ot">&lt;-</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age_subject, <span class="at">y =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"No contrasts"</span>) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_vline(xintercept = 0, linetype="dashed", size = .5) +  </span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="fu">aes</span>(<span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>fig_treatment <span class="ot">&lt;-</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_subject =</span> <span class="fu">if_else</span>(age_subject<span class="sc">==</span><span class="st">"young"</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age_subject, <span class="at">y =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">+</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Treatment contrasts"</span>) <span class="sc">+</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="fu">aes</span>(<span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>fig_nocontrasts <span class="sc">+</span> fig_treatment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-categorical_predictors_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="sum-contrasts" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sum-contrasts"><span class="header-section-number">5.2</span> Sum contrasts</h2>
<p>Treatment/dummy coding is the default contrast coding scheme. Sum coding is another frequently used coding scheme, which is essentially centring categorical variables. Just as with continuous variables, the motivation for sum contrast coding mainly lies in the interpretation of interaction effects. How can we tell R we want to use sum contrast coding, and not dummy coding? There are different ways to do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first, make sure your variable is a factor</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df_freq_eng<span class="sc">$</span>age_subject <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df_freq_eng<span class="sc">$</span>age_subject)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df_freq_eng<span class="sc">$</span>age_subject)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># next, you could use the contr.sum() function</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_freq_eng<span class="sc">$</span>age_subject) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>) <span class="co"># where 2 means we have 2 levels</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_freq_eng<span class="sc">$</span>age_subject)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]
old      1
young   -1</code></pre>
</div>
</div>
<p>Here we see that <code>old</code> is coded as <span class="math inline">\(-1\)</span> and <code>young</code> as <span class="math inline">\(+1\)</span>. I prefer to use +/-0.5 for reasons we don’t need to go into here. I would also prefer to have <code>young</code> coded in the negative value, and <code>old</code> in the positive value. This aids in the way I interpret the slope: a change in reaction times for the older group compared to the younger group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#or, you could manually control the sum contrasts</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="do">## check the order of the levels</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df_freq_eng<span class="sc">$</span>age_subject)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "old"   "young"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## code 'old' as +.5 and 'young' as -.5</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_freq_eng<span class="sc">$</span>age_subject) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">+</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_freq_eng<span class="sc">$</span>age_subject)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]
old    0.5
young -0.5</code></pre>
</div>
</div>
<p>You could also choose to store the contrast values in their own variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="ot">&lt;-</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_numeric =</span> <span class="fu">ifelse</span>(age_subject <span class="sc">==</span> <span class="st">"young"</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">+</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age_subject, age_numeric) <span class="sc">|&gt;</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     age_subject age_numeric
338        young        -0.5
1790         old         0.5
3125       young        -0.5
3957         old         0.5
3313       young        -0.5
4145         old         0.5</code></pre>
</div>
</div>
<p>Now, we can run our model using either <code>age_subject</code> or <code>age_numeric</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>fit_age_sum <span class="ot">&lt;-</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">exp</span>(rt_lexdec) <span class="sc">~</span> age_subject,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df_freq_eng)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_age_sum)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4682224</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_age)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4682224</code></pre>
</div>
</div>
<p>No difference in variance account for by our model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_age_sum) <span class="sc">|&gt;</span> <span class="fu">select</span>(term,estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  term         estimate
  &lt;chr&gt;           &lt;dbl&gt;
1 (Intercept)      708.
2 age_subject1     157.</code></pre>
</div>
</div>
<p>But there is a difference in the intercept, and a change in sign in our slope. Why is this?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>fig_sum1 <span class="ot">&lt;-</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_subject =</span> <span class="fu">if_else</span>(age_subject<span class="sc">==</span><span class="st">"young"</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age_subject, <span class="at">y =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sum contrasts"</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="fu">aes</span>(<span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>fig_sum5 <span class="ot">&lt;-</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_subject =</span> <span class="fu">if_else</span>(age_subject<span class="sc">==</span><span class="st">"young"</span>,<span class="sc">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>)) <span class="sc">|&gt;</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age_subject, <span class="at">y =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">+</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sum contrasts"</span>) <span class="sc">+</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="fu">aes</span>(<span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>fig_treatment <span class="sc">+</span> fig_sum5 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-contrasts" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05-categorical_predictors_files/figure-html/fig-contrasts-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5.1: The difference in slope corresponds to which level is coded as 0 (dummy coding) or -5/-1 (sum coding)</figcaption>
</figure>
</div>
</div>
</div>
<p>As we see in <a href="#fig-contrasts">Figure&nbsp;<span>5.1</span></a>, the sign of the slope depends on how we’ve contrast coded our factor levels. In <a href="#fig-contrasts">Figure&nbsp;<span>5.1</span></a> A, the <code>old</code> group is coded as <span class="math inline">\(0\)</span> and <code>young</code> as <span class="math inline">\(1\)</span>. In <a href="#fig-contrasts">Figure&nbsp;<span>5.1</span></a> B, the <code>young</code> group is coded as <span class="math inline">\(-.5\)</span> and the <code>old</code> group as <span class="math inline">\(+.5\)</span>.</p>
<p>The intercept value is also now the overall mean of all observed reaction times, because now the <span class="math inline">\(y\)</span> value when <span class="math inline">\(x\)</span> equals zero lies in the middle of the two groups. The slope magnitude (i.e., size of the value) hasn’t changed, because the difference betwen the two group means has not changed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">exp</span>(df_freq_eng<span class="sc">$</span>rt_lexdec))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 708.1336</code></pre>
</div>
</div>
<section id="exploring-predicted-values" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="exploring-predicted-values"><span class="header-section-number">5.2.1</span> Exploring predicted values</h3>
<p>Let’s also explore the predicted values of our model with a categorical variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">fitted</span>(fit_age), <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     338     1790     3125     3957     3313     4145      337     1789 
629.5473 786.7200 629.5473 786.7200 629.5473 786.7200 629.5473 786.7200 
    3513     4345 
629.5473 786.7200 </code></pre>
</div>
</div>
<p>We see that there are only 2 values, 630 and 787. These correspond to the means for each group that we saw above. They also seem to be in a pattern: young-mean, old-mean, young-mean, old-mean, etc. How does this correspond to the age group of the participant for the first ten observations?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_freq_eng<span class="sc">$</span>age_subject, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] young old   young old   young old   young old   young old  
attr(,"contrasts")
      [,1]
old    0.5
young -0.5
Levels: old young</code></pre>
</div>
</div>
<p>The first ten observations in our data are in young-old pairs. What are the first values in the raw data?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">exp</span>(df_freq_eng<span class="sc">$</span>rt_lexdec), <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 623.61 775.67 617.10 715.52 575.70 742.19 592.42 748.37 541.67 824.76</code></pre>
</div>
</div>
<p>And what is the difference between these reaction times and the fitted values?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">exp</span>(df_freq_eng<span class="sc">$</span>rt_lexdec), <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">-</span> <span class="fu">head</span>(<span class="fu">fitted</span>(fit_age), <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       338       1790       3125       3957       3313       4145        337 
 -5.937299 -11.049991 -12.447299 -71.199991 -53.847299 -44.529991 -37.127299 
      1789       3513       4345 
-38.349991 -87.877299  38.040009 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">residuals</span>(fit_age))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       338       1790       3125       3957       3313       4145 
 -5.937299 -11.049991 -12.447299 -71.199991 -53.847299 -44.529991 </code></pre>
</div>
</div>
</section>
</section>
<section id="summary" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="summary"><span class="header-section-number">5.3</span> Summary</h2>
<ul>
<li><p>we saw that the equation for a straight line boils down to its intercept and slope</p></li>
<li><p>we fit our first linear model with a categorical predictor</p></li>
</ul>
<section id="important-terms" class="level3 unnumbered smaller">
<h3 class="unnumbered smaller anchored" data-anchor-id="important-terms">Important terms</h3>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">description/other terms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th></th>
<th></th>
</tr>

</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="learning-objectives-1" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="learning-objectives-1">Learning Objectives</h2>
<p>Today we learned…</p>
</section>
<section id="task" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="task"><span class="header-section-number">5.4</span> Task</h2>
<p>We’ll use a dataset from <span class="citation" data-cites="biondo_yesterday_2022">Biondo et al. (<a href="00-course_overview.html#ref-biondo_yesterday_2022" role="doc-biblioref">2022</a>)</span>, an eye-tracking reading study exploring the processing of adverb-tense concord in Spanish past and future tenses. Participants read sentences that began with a temporal adverb (e.g., yesterday/tomorrow), and had a verb marked with the congruent or incongruent tense (past/future).</p>
<p>Load in the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df_tense <span class="ot">&lt;-</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"Biondo.Soilemezidi.Mancini_dataset_ET.csv"</span>),</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">"Latin1"</span>) <span class="co"># for special characters in Spanish</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">|&gt;</span> </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gramm =</span> <span class="fu">ifelse</span>(gramm <span class="sc">==</span> <span class="st">"0"</span>, <span class="st">"ungramm"</span>, <span class="st">"gramm"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="treatment-contrasts" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="treatment-contrasts"><span class="header-section-number">5.4.1</span> Treatment contrasts</h3>
<p>We will look at the measure <em>total reading time</em> (<code>tt</code>) at the <em>verb</em> region (<code>roi == 4</code>). Subset the data to only include the verb region.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>df_verb <span class="ot">&lt;-</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  df_tense <span class="sc">|&gt;</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li><p>Run a simple linear model with (log-transformed) total reading time (<code>tt</code>) as an independent variable and grammaticality (<code>gramm</code>) as a dependent variable. Use treatment contrasts.</p></li>
<li><p>Inspect your coefficients again. What conclusions do you draw?</p></li>
<li><p>Run model diagnostics:</p>
<ul>
<li>check model assumptions where relevant (normality, constant variance, collinearity)</li>
<li>check model fit (<span class="math inline">\(R^2\)</span>)</li>
</ul></li>
</ol>
</section>
<section id="sum-contrasts-1" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="sum-contrasts-1"><span class="header-section-number">5.4.2</span> Sum contrasts</h3>
<ol type="1">
<li><p>Re-run your model with sum contrasts.</p></li>
<li><p>Inspect your coefficients again. Do your conclusions change?</p></li>
<li><p>Re-run your model diagnostics. How does it compare to your first model?</p></li>
</ol>
</section>
<section id="multiple-regression" class="level3" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="multiple-regression"><span class="header-section-number">5.4.3</span> Multiple regression</h3>
<ol type="1">
<li><p>Add verb tense (<code>verb_t</code>: past, future) as a predictor, including an interaction term. Use sum contrasts.</p></li>
<li><p>Inspect your coefficients again. Do your conclusions change?</p></li>
<li><p>Re-run your model diagnostics. How does it compare to the last models?</p></li>
</ol>
</section>
</section>
<section id="session-info" class="level2 unnumbered" data-visibility="uncounted">
<h2 class="unnumbered anchored" data-visibility="uncounted" data-anchor-id="session-info">Session Info</h2>
<p>Developed with Quarto using R version 4.3.0 (2023-04-21) (Already Tomorrow) and RStudio version 2023.9.0.463 (Desert Sunflower), and the following packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.0 (2023-04-21)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Ventura 13.2.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Berlin
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] kableExtra_1.3.4 knitr_1.44       patchwork_1.1.3  languageR_1.5.0 
 [5] janitor_2.2.0    lme4_1.1-33      Matrix_1.5-4     broom_1.0.5     
 [9] here_1.0.1       lubridate_1.9.2  forcats_1.0.0    stringr_1.5.0   
[13] dplyr_1.1.3      purrr_1.0.2      readr_2.1.4      tidyr_1.3.0     
[17] tibble_3.2.1     ggplot2_3.4.3    tidyverse_2.0.0 

loaded via a namespace (and not attached):
 [1] gtable_0.3.4      xfun_0.39         htmlwidgets_1.6.2 lattice_0.21-8   
 [5] tzdb_0.4.0        vctrs_0.6.3       tools_4.3.0       generics_0.1.3   
 [9] parallel_4.3.0    fansi_1.0.4       highr_0.10        pacman_0.5.1     
[13] pkgconfig_2.0.3   webshot_0.5.4     lifecycle_1.0.3   farver_2.1.1     
[17] compiler_4.3.0    munsell_0.5.0     carData_3.0-5     snakecase_0.11.0 
[21] htmltools_0.5.5   yaml_2.3.7        crayon_1.5.2      car_3.1-2        
[25] pillar_1.9.0      nloptr_2.0.3      MASS_7.3-58.4     abind_1.4-5      
[29] boot_1.3-28.1     nlme_3.1-162      tidyselect_1.2.0  rvest_1.0.3      
[33] digest_0.6.33     stringi_1.7.12    labeling_0.4.3    splines_4.3.0    
[37] rprojroot_2.0.3   fastmap_1.1.1     grid_4.3.0        colorspace_2.1-0 
[41] cli_3.6.1         magrittr_2.0.3    utf8_1.2.3        withr_2.5.0      
[45] scales_1.2.1      backports_1.4.1   bit64_4.0.5       timechange_0.2.0 
[49] rmarkdown_2.22    httr_1.4.6        bit_4.0.5         hms_1.1.3        
[53] evaluate_0.21     viridisLite_0.4.2 mgcv_1.8-42       rlang_1.1.3      
[57] Rcpp_1.0.11       glue_1.6.2        xml2_1.3.4        vroom_1.6.3      
[61] svglite_2.1.1     rstudioapi_0.14   minqa_1.2.5       jsonlite_1.8.7   
[65] R6_2.5.1          systemfonts_1.0.4</code></pre>
</div>
</div>
</section>
<section id="references" class="level2 unlisted unnumbered" data-visibility="uncounted">
<h2 class="unlisted unnumbered anchored" data-visibility="uncounted" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-custom-style="Bibliography" data-line-spacing="2" role="list" style="display: none">
<div id="ref-biondo_yesterday_2022" class="csl-entry" role="listitem">
Biondo, N., Soilemezidi, M., &amp; Mancini, S. (2022). Yesterday is history, tomorrow is a mystery: <span>An</span> eye-tracking investigation of the processing of past and future time reference during sentence reading. <em>Journal of Experimental Psychology: Learning, Memory, and Cognition</em>, <em>48</em>(7), 1001–1018. <a href="https://doi.org/10.1037/xlm0001053">https://doi.org/10.1037/xlm0001053</a>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script>
var custom_title = document.querySelectorAll('.custom .theorem-title');

for (let i = 0; i < custom_title.length; i++ ) {
   var mod_name = custom_title[i].innerHTML;
   custom_title[i].innerHTML = mod_name.replace("Example", "");
};
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./04-multiple_regression.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multiple Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-logistic_regression.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb73" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Categorical predictors"</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Regression for Linguists"</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Daniela Palleschi"</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="an">institute:</span><span class="co"> Humboldt-Universität zu Berlin</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># footer: "Lecture 1.1 - R und RStudio"</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="an">lang:</span><span class="co"> en</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "10/11/2023"</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> last-modified</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning Objectives {.unnumbered .unlisted}</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>Today we will learn...</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>about cateogorical predictors</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>how to interpret different contrast coding</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Set-up environment  {.unnumbered}</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="co"># suppress scientific notation</span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>We'll also need to load in our required packages. </span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>               tidyverse,</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>               here,</span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>               broom,</span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>               lme4,</span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>               janitor,</span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>               languageR)</span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a><span class="co"># extra packages for the lecture notes/slides</span></span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a>               patchwork,</span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a>               knitr,</span>
<span id="cb73-52"><a href="#cb73-52" aria-hidden="true" tabindex="-1"></a>               kableExtra)</span>
<span id="cb73-53"><a href="#cb73-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true" tabindex="-1"></a><span class="fu">### Load data {.unnumbered .unlisted}</span></span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true" tabindex="-1"></a>Let's continue working with the <span class="in">`english`</span> dataset from the <span class="in">`languageR`</span> package. Let's just call it <span class="in">`df_freq_eng`</span>.</span>
<span id="cb73-58"><a href="#cb73-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-61"><a href="#cb73-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-62"><a href="#cb73-62" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="ot">&lt;-</span></span>
<span id="cb73-63"><a href="#cb73-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(english) <span class="sc">|&gt;</span> </span>
<span id="cb73-64"><a href="#cb73-64" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(RTlexdec, RTnaming, Word, LengthInLetters, AgeSubject, WrittenFrequency) <span class="sc">|&gt;</span> </span>
<span id="cb73-65"><a href="#cb73-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rt_lexdec =</span> RTlexdec,</span>
<span id="cb73-66"><a href="#cb73-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">rt_naming =</span> RTnaming,</span>
<span id="cb73-67"><a href="#cb73-67" aria-hidden="true" tabindex="-1"></a>         <span class="at">freq_written =</span> WrittenFrequency) <span class="sc">|&gt;</span> </span>
<span id="cb73-68"><a href="#cb73-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-69"><a href="#cb73-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># standardize continuous predictors</span></span>
<span id="cb73-70"><a href="#cb73-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb73-71"><a href="#cb73-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">freq_z =</span> <span class="fu">scale</span>(freq_written),</span>
<span id="cb73-72"><a href="#cb73-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">length_z =</span> <span class="fu">scale</span>(length_in_letters)</span>
<span id="cb73-73"><a href="#cb73-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb73-74"><a href="#cb73-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(word) <span class="sc">|&gt;</span> </span>
<span id="cb73-75"><a href="#cb73-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(word)</span>
<span id="cb73-76"><a href="#cb73-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-77"><a href="#cb73-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-78"><a href="#cb73-78" aria-hidden="true" tabindex="-1"></a>In your exploratory data analysis, you might've noticed a *bimodal* distribution.</span>
<span id="cb73-79"><a href="#cb73-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-80"><a href="#cb73-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-83"><a href="#cb73-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-84"><a href="#cb73-84" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-85"><a href="#cb73-85" aria-hidden="true" tabindex="-1"></a>fig_hist_log <span class="ot">&lt;-</span> </span>
<span id="cb73-86"><a href="#cb73-86" aria-hidden="true" tabindex="-1"></a>  df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-87"><a href="#cb73-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb73-88"><a href="#cb73-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> rt_lexdec) <span class="sc">+</span></span>
<span id="cb73-89"><a href="#cb73-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() </span>
<span id="cb73-90"><a href="#cb73-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-91"><a href="#cb73-91" aria-hidden="true" tabindex="-1"></a>fig_dens_log <span class="ot">&lt;-</span> </span>
<span id="cb73-92"><a href="#cb73-92" aria-hidden="true" tabindex="-1"></a>  df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-93"><a href="#cb73-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb73-94"><a href="#cb73-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> rt_lexdec) <span class="sc">+</span></span>
<span id="cb73-95"><a href="#cb73-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() </span>
<span id="cb73-96"><a href="#cb73-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-97"><a href="#cb73-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-98"><a href="#cb73-98" aria-hidden="true" tabindex="-1"></a>fig_hist <span class="ot">&lt;-</span></span>
<span id="cb73-99"><a href="#cb73-99" aria-hidden="true" tabindex="-1"></a>  df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-100"><a href="#cb73-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb73-101"><a href="#cb73-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> rt_lexdec, <span class="at">fill =</span> age_subject) <span class="sc">+</span></span>
<span id="cb73-102"><a href="#cb73-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb73-103"><a href="#cb73-103" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_grid(.~age_subject) +</span></span>
<span id="cb73-104"><a href="#cb73-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb73-105"><a href="#cb73-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-106"><a href="#cb73-106" aria-hidden="true" tabindex="-1"></a>fig_dens <span class="ot">&lt;-</span></span>
<span id="cb73-107"><a href="#cb73-107" aria-hidden="true" tabindex="-1"></a>  df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-108"><a href="#cb73-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb73-109"><a href="#cb73-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> rt_lexdec, <span class="at">colour =</span> age_subject, <span class="at">fill =</span> age_subject) <span class="sc">+</span></span>
<span id="cb73-110"><a href="#cb73-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb73-111"><a href="#cb73-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb73-112"><a href="#cb73-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-113"><a href="#cb73-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-114"><a href="#cb73-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-115"><a href="#cb73-115" aria-hidden="true" tabindex="-1"></a>  (fig_hist_log <span class="sc">+</span> fig_dens_log) <span class="sc">/</span></span>
<span id="cb73-116"><a href="#cb73-116" aria-hidden="true" tabindex="-1"></a>  (fig_hist <span class="sc">+</span> fig_dens)</span>
<span id="cb73-117"><a href="#cb73-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-118"><a href="#cb73-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-119"><a href="#cb73-119" aria-hidden="true" tabindex="-1"></a>This looks like a *bimodal* distribution, i.e., there are two *modes* (most frequent value, i.e., peak in a histogram). What might be driving this? We know that there were two subject groups: old and young. How does the distribution of these two groups look?</span>
<span id="cb73-120"><a href="#cb73-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-121"><a href="#cb73-121" aria-hidden="true" tabindex="-1"></a>Running our model of the log reaction times as predicted by frequency and length, we see:</span>
<span id="cb73-122"><a href="#cb73-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-125"><a href="#cb73-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-126"><a href="#cb73-126" aria-hidden="true" tabindex="-1"></a>fit_freq_length <span class="ot">&lt;-</span></span>
<span id="cb73-127"><a href="#cb73-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(rt_lexdec <span class="sc">~</span> freq_z<span class="sc">*</span>length_z,</span>
<span id="cb73-128"><a href="#cb73-128" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df_freq_eng)</span>
<span id="cb73-129"><a href="#cb73-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-130"><a href="#cb73-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-133"><a href="#cb73-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-134"><a href="#cb73-134" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_freq_length)<span class="sc">$</span>r.squared</span>
<span id="cb73-135"><a href="#cb73-135" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_freq_length)<span class="sc">$</span>adj.r.squared</span>
<span id="cb73-136"><a href="#cb73-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-137"><a href="#cb73-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-138"><a href="#cb73-138" aria-hidden="true" tabindex="-1"></a>Seems like we don't have any overfitting in our model ($R^2$ and adjusted $R^2$ are comparable). Let's look at our coeffiecients.</span>
<span id="cb73-139"><a href="#cb73-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-142"><a href="#cb73-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-143"><a href="#cb73-143" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_freq_length) <span class="sc">|&gt;</span> <span class="fu">select</span>(term, estimate)</span>
<span id="cb73-144"><a href="#cb73-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-145"><a href="#cb73-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-146"><a href="#cb73-146" aria-hidden="true" tabindex="-1"></a>There is a negative slope for frequency, indicating shorter reaction times for words with higher frequency (when holding length constant). There is a positive slope for length, indicating longer reaction times for longer words (holding frequency constant). There is also a negative interaction estimate, indicating that when both length and frequency increase, reaction times decrease. This seems similar to the dataset we explored in the previous sections. But, this bimodal distribution is suggesting we should include age group as a predictor, since the two groups seem to pattern differently in their reading times. Could it be that the effect of frequency and length also differ as a function of age group?</span>
<span id="cb73-147"><a href="#cb73-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-148"><a href="#cb73-148" aria-hidden="true" tabindex="-1"></a><span class="fu">## Categorical predictors</span></span>
<span id="cb73-149"><a href="#cb73-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-150"><a href="#cb73-150" aria-hidden="true" tabindex="-1"></a>In linguistic research we often want to compare the effect of *groups* or categories, such as native or non-native speakers, or grammatical or ungrammatical stimuli. We might expect longer reading times for non-native (compared to native) speakers of a language, or for ungrammatical (versus grammatical) sentences. With our current dataset, we'd predict longer reading times for older participants than younger participants (although we should hypothesise *before* collecting and visualising our data!). How might these age effects interact with effects of word frequency and length?</span>
<span id="cb73-151"><a href="#cb73-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-152"><a href="#cb73-152" aria-hidden="true" tabindex="-1"></a><span class="fu">### Including a categorical predictor</span></span>
<span id="cb73-153"><a href="#cb73-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-154"><a href="#cb73-154" aria-hidden="true" tabindex="-1"></a>What would happen if we just include <span class="in">`age_subject`</span> in our model?</span>
<span id="cb73-155"><a href="#cb73-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-158"><a href="#cb73-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-159"><a href="#cb73-159" aria-hidden="true" tabindex="-1"></a>fit_age <span class="ot">&lt;-</span></span>
<span id="cb73-160"><a href="#cb73-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(rt_lexdec <span class="sc">~</span> freq_z<span class="sc">*</span>length_z <span class="sc">+</span> age_subject,</span>
<span id="cb73-161"><a href="#cb73-161" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df_freq_eng)</span>
<span id="cb73-162"><a href="#cb73-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-163"><a href="#cb73-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-164"><a href="#cb73-164" aria-hidden="true" tabindex="-1"></a>First, we see that adding age to our model results in a large increase in variance explained, and that the $R^2$ and adjusted $R^2$ values are comparable. In addition, the VIF values for all coefficients are near 1. This indicates that our predictors all contribute to the variance explained by the model and are not correlated.</span>
<span id="cb73-165"><a href="#cb73-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-168"><a href="#cb73-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-169"><a href="#cb73-169" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_age)<span class="sc">$</span>r.squared</span>
<span id="cb73-170"><a href="#cb73-170" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_age)<span class="sc">$</span>adj.r.squared</span>
<span id="cb73-171"><a href="#cb73-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-172"><a href="#cb73-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-175"><a href="#cb73-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-176"><a href="#cb73-176" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(fit_age)</span>
<span id="cb73-177"><a href="#cb73-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-178"><a href="#cb73-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-179"><a href="#cb73-179" aria-hidden="true" tabindex="-1"></a>Now that we see that our model is not overfit and that our predictors are not correlatd, let's take a look at our model estimates.</span>
<span id="cb73-180"><a href="#cb73-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-183"><a href="#cb73-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-184"><a href="#cb73-184" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_age) <span class="sc">|&gt;</span> <span class="fu">select</span>(term,estimate)</span>
<span id="cb73-185"><a href="#cb73-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-186"><a href="#cb73-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-187"><a href="#cb73-187" aria-hidden="true" tabindex="-1"></a>In addition to the effects we observed in our earlier model, we see that there is a negative slope for <span class="in">`age_subjectyoung`</span>, indicating that reaction times decrease when...what? How do we interpret a slope for a categorical variable? Regression works with numerical values, so how does a categorical variable get fit to a line? If we feed a categorical variable into the <span class="in">`lm()`</span> function, the factor levels (i.e., the categories in a categorical variable) are given numerical values. We need to know what these values are in order to know how to interpret our model estimates. We call these numerical values mapped onto factor levels contrast coding, and we can check the contrasts of a given factor using the function <span class="in">`contrasts()`</span>.</span>
<span id="cb73-188"><a href="#cb73-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-191"><a href="#cb73-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-192"><a href="#cb73-192" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_freq_eng<span class="sc">$</span>age_subject)</span>
<span id="cb73-193"><a href="#cb73-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-194"><a href="#cb73-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-195"><a href="#cb73-195" aria-hidden="true" tabindex="-1"></a>We see that <span class="in">`old`</span> was coded at $0$ and <span class="in">`young`</span> as $1$. This means that our slope for <span class="in">`age_subjectyoung`</span> represents the change in reaction times when we move from <span class="in">`old`</span> to <span class="in">`young`</span>, which corresponds to a 1-unit change in our predictor (because the difference between 0 and 1 is 1). This is called treatment coding, or dummy coding, where one factor level is coded as 0 and the other as 1. Let's remove the continuous variable for now and focus on <span class="in">`age_subject`</span>. Let's also look at raw reaction times, to more easily interpret the results.</span>
<span id="cb73-196"><a href="#cb73-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-199"><a href="#cb73-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-200"><a href="#cb73-200" aria-hidden="true" tabindex="-1"></a>fit_age <span class="ot">&lt;-</span></span>
<span id="cb73-201"><a href="#cb73-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">exp</span>(rt_lexdec) <span class="sc">~</span> age_subject,</span>
<span id="cb73-202"><a href="#cb73-202" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df_freq_eng)</span>
<span id="cb73-203"><a href="#cb73-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-204"><a href="#cb73-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-207"><a href="#cb73-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-208"><a href="#cb73-208" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_age)<span class="sc">$</span>r.squared</span>
<span id="cb73-209"><a href="#cb73-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-210"><a href="#cb73-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-211"><a href="#cb73-211" aria-hidden="true" tabindex="-1"></a>Our $R^2$ value is lower than when we included frequency and length, but higher still than our model with frequeny and length but no age.</span>
<span id="cb73-212"><a href="#cb73-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-215"><a href="#cb73-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-216"><a href="#cb73-216" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_age) <span class="sc">|&gt;</span> <span class="fu">select</span>(term, estimate)</span>
<span id="cb73-217"><a href="#cb73-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-218"><a href="#cb73-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-219"><a href="#cb73-219" aria-hidden="true" tabindex="-1"></a>We see that there is an estimated decrease in reaction times of 157ms for the young group compared to the old group. But what does the intercept represent here? Let's look at our data again.</span>
<span id="cb73-220"><a href="#cb73-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-223"><a href="#cb73-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-224"><a href="#cb73-224" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-225"><a href="#cb73-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rt_lexdec, age_subject) <span class="sc">|&gt;</span> </span>
<span id="cb73-226"><a href="#cb73-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt_lexdec =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">|&gt;</span> </span>
<span id="cb73-227"><a href="#cb73-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb73-228"><a href="#cb73-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-229"><a href="#cb73-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-230"><a href="#cb73-230" aria-hidden="true" tabindex="-1"></a>And how does <span class="in">`rt_lexdec`</span> differ between the groups?</span>
<span id="cb73-231"><a href="#cb73-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-234"><a href="#cb73-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-235"><a href="#cb73-235" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-236"><a href="#cb73-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rt_lexdec, age_subject) <span class="sc">|&gt;</span> </span>
<span id="cb73-237"><a href="#cb73-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt_lexdec =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">|&gt;</span> </span>
<span id="cb73-238"><a href="#cb73-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(rt_lexdec),</span>
<span id="cb73-239"><a href="#cb73-239" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(rt_lexdec),</span>
<span id="cb73-240"><a href="#cb73-240" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(rt_lexdec),</span>
<span id="cb73-241"><a href="#cb73-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="st">"age_subject"</span></span>
<span id="cb73-242"><a href="#cb73-242" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb73-243"><a href="#cb73-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-244"><a href="#cb73-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-245"><a href="#cb73-245" aria-hidden="true" tabindex="-1"></a>We see here that the intercept for our model actually corresponds to the mean reaction time for the old group. Why is this? Recall that the intercept corresponds to the $y$ value (reaction time) when $x$ is $0$. In treatment/dummy coding, one factor level is coded as $0$. In our case this was <span class="in">`old`</span>, and so the intercept corresponds to the mean reaction time for participants in the old group. How does R choose which variable to code as $0$? It simply takes the first level name alphabetically: <span class="in">`old`</span> comes before <span class="in">`young`</span>, so <span class="in">`old`</span> was automatically taken as the 'baseline' to which <span class="in">`young`</span> was compared.</span>
<span id="cb73-246"><a href="#cb73-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-247"><a href="#cb73-247" aria-hidden="true" tabindex="-1"></a>And if we were to add the slope to the intercept, we would get the mean for the $young$ group. Why is this?</span>
<span id="cb73-248"><a href="#cb73-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-251"><a href="#cb73-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-252"><a href="#cb73-252" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit_age)[<span class="st">'(Intercept)'</span>] <span class="sc">+</span> <span class="fu">coef</span>(fit_age)[<span class="st">'age_subjectyoung'</span>]</span>
<span id="cb73-253"><a href="#cb73-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-254"><a href="#cb73-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-255"><a href="#cb73-255" aria-hidden="true" tabindex="-1"></a>Why are the means for the two groups used? The mean is the value closest to all values in a univariate dataset, and regression aims to inimise residuals (recall the line of best fit). So, a line is fit between the means of these two factor levels to achieve minimal residuals. This actually is the same thing as a *t*-test:</span>
<span id="cb73-256"><a href="#cb73-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-259"><a href="#cb73-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-260"><a href="#cb73-260" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">exp</span>(rt_lexdec) <span class="sc">~</span> age_subject, <span class="at">data =</span> df_freq_eng)</span>
<span id="cb73-261"><a href="#cb73-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-262"><a href="#cb73-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-263"><a href="#cb73-263" aria-hidden="true" tabindex="-1"></a>If we compare this to our model, we see that the *t*- and *p*-values are identical (more on these later).</span>
<span id="cb73-264"><a href="#cb73-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-267"><a href="#cb73-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-268"><a href="#cb73-268" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_age)</span>
<span id="cb73-269"><a href="#cb73-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-270"><a href="#cb73-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-273"><a href="#cb73-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-274"><a href="#cb73-274" aria-hidden="true" tabindex="-1"></a>fig_nocontrasts <span class="ot">&lt;-</span></span>
<span id="cb73-275"><a href="#cb73-275" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-276"><a href="#cb73-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb73-277"><a href="#cb73-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age_subject, <span class="at">y =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">+</span></span>
<span id="cb73-278"><a href="#cb73-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"No contrasts"</span>) <span class="sc">+</span></span>
<span id="cb73-279"><a href="#cb73-279" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_vline(xintercept = 0, linetype="dashed", size = .5) +  </span></span>
<span id="cb73-280"><a href="#cb73-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb73-281"><a href="#cb73-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="fu">aes</span>(<span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb73-282"><a href="#cb73-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb73-283"><a href="#cb73-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-284"><a href="#cb73-284" aria-hidden="true" tabindex="-1"></a>fig_treatment <span class="ot">&lt;-</span></span>
<span id="cb73-285"><a href="#cb73-285" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-286"><a href="#cb73-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_subject =</span> <span class="fu">if_else</span>(age_subject<span class="sc">==</span><span class="st">"young"</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb73-287"><a href="#cb73-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb73-288"><a href="#cb73-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age_subject, <span class="at">y =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">+</span></span>
<span id="cb73-289"><a href="#cb73-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Treatment contrasts"</span>) <span class="sc">+</span></span>
<span id="cb73-290"><a href="#cb73-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb73-291"><a href="#cb73-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb73-292"><a href="#cb73-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="fu">aes</span>(<span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb73-293"><a href="#cb73-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb73-294"><a href="#cb73-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-295"><a href="#cb73-295" aria-hidden="true" tabindex="-1"></a>fig_nocontrasts <span class="sc">+</span> fig_treatment</span>
<span id="cb73-296"><a href="#cb73-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-297"><a href="#cb73-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-298"><a href="#cb73-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-299"><a href="#cb73-299" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sum contrasts</span></span>
<span id="cb73-300"><a href="#cb73-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-301"><a href="#cb73-301" aria-hidden="true" tabindex="-1"></a>Treatment/dummy coding is the default contrast coding scheme. Sum coding is another frequently used coding scheme, which is essentially centring categorical variables. Just as with continuous variables, the motivation for sum contrast coding mainly lies in the interpretation of interaction effects. How can we tell R we want to use sum contrast coding, and not dummy coding? There are different ways to do this:</span>
<span id="cb73-302"><a href="#cb73-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-305"><a href="#cb73-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-306"><a href="#cb73-306" aria-hidden="true" tabindex="-1"></a><span class="co"># first, make sure your variable is a factor</span></span>
<span id="cb73-307"><a href="#cb73-307" aria-hidden="true" tabindex="-1"></a>df_freq_eng<span class="sc">$</span>age_subject <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df_freq_eng<span class="sc">$</span>age_subject)</span>
<span id="cb73-308"><a href="#cb73-308" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb73-309"><a href="#cb73-309" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df_freq_eng<span class="sc">$</span>age_subject)</span>
<span id="cb73-310"><a href="#cb73-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-311"><a href="#cb73-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-314"><a href="#cb73-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-315"><a href="#cb73-315" aria-hidden="true" tabindex="-1"></a><span class="co"># next, you could use the contr.sum() function</span></span>
<span id="cb73-316"><a href="#cb73-316" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_freq_eng<span class="sc">$</span>age_subject) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="dv">2</span>) <span class="co"># where 2 means we have 2 levels</span></span>
<span id="cb73-317"><a href="#cb73-317" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_freq_eng<span class="sc">$</span>age_subject)</span>
<span id="cb73-318"><a href="#cb73-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-319"><a href="#cb73-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-320"><a href="#cb73-320" aria-hidden="true" tabindex="-1"></a>Here we see that <span class="in">`old`</span> is coded as $-1$ and <span class="in">`young`</span> as $+1$. I prefer to use +/-0.5 for reasons we don't need to go into here. I would also prefer to have <span class="in">`young`</span> coded in the negative value, and <span class="in">`old`</span> in the positive value. This aids in the way I interpret the slope: a change in reaction times for the older group compared to the younger group.</span>
<span id="cb73-321"><a href="#cb73-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-324"><a href="#cb73-324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-325"><a href="#cb73-325" aria-hidden="true" tabindex="-1"></a><span class="co">#or, you could manually control the sum contrasts</span></span>
<span id="cb73-326"><a href="#cb73-326" aria-hidden="true" tabindex="-1"></a><span class="do">## check the order of the levels</span></span>
<span id="cb73-327"><a href="#cb73-327" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df_freq_eng<span class="sc">$</span>age_subject)</span>
<span id="cb73-328"><a href="#cb73-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-329"><a href="#cb73-329" aria-hidden="true" tabindex="-1"></a><span class="do">## code 'old' as +.5 and 'young' as -.5</span></span>
<span id="cb73-330"><a href="#cb73-330" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_freq_eng<span class="sc">$</span>age_subject) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">+</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb73-331"><a href="#cb73-331" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_freq_eng<span class="sc">$</span>age_subject)</span>
<span id="cb73-332"><a href="#cb73-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-333"><a href="#cb73-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-334"><a href="#cb73-334" aria-hidden="true" tabindex="-1"></a>You could also choose to store the contrast values in their own variable.</span>
<span id="cb73-335"><a href="#cb73-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-338"><a href="#cb73-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-339"><a href="#cb73-339" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="ot">&lt;-</span> </span>
<span id="cb73-340"><a href="#cb73-340" aria-hidden="true" tabindex="-1"></a>  df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-341"><a href="#cb73-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_numeric =</span> <span class="fu">ifelse</span>(age_subject <span class="sc">==</span> <span class="st">"young"</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">+</span><span class="fl">0.5</span>))</span>
<span id="cb73-342"><a href="#cb73-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-343"><a href="#cb73-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-346"><a href="#cb73-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-347"><a href="#cb73-347" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-348"><a href="#cb73-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age_subject, age_numeric) <span class="sc">|&gt;</span> </span>
<span id="cb73-349"><a href="#cb73-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb73-350"><a href="#cb73-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-351"><a href="#cb73-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-352"><a href="#cb73-352" aria-hidden="true" tabindex="-1"></a>Now, we can run our model using either <span class="in">`age_subject`</span> or <span class="in">`age_numeric`</span>.</span>
<span id="cb73-353"><a href="#cb73-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-356"><a href="#cb73-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-357"><a href="#cb73-357" aria-hidden="true" tabindex="-1"></a>fit_age_sum <span class="ot">&lt;-</span></span>
<span id="cb73-358"><a href="#cb73-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">exp</span>(rt_lexdec) <span class="sc">~</span> age_subject,</span>
<span id="cb73-359"><a href="#cb73-359" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> df_freq_eng)</span>
<span id="cb73-360"><a href="#cb73-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-361"><a href="#cb73-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-364"><a href="#cb73-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-365"><a href="#cb73-365" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_age_sum)<span class="sc">$</span>r.squared</span>
<span id="cb73-366"><a href="#cb73-366" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit_age)<span class="sc">$</span>r.squared</span>
<span id="cb73-367"><a href="#cb73-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-368"><a href="#cb73-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-369"><a href="#cb73-369" aria-hidden="true" tabindex="-1"></a>No difference in variance account for by our model.</span>
<span id="cb73-370"><a href="#cb73-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-373"><a href="#cb73-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-374"><a href="#cb73-374" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fit_age_sum) <span class="sc">|&gt;</span> <span class="fu">select</span>(term,estimate)</span>
<span id="cb73-375"><a href="#cb73-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-376"><a href="#cb73-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-377"><a href="#cb73-377" aria-hidden="true" tabindex="-1"></a>But there is a difference in the intercept, and a change in sign in our slope. Why is this?</span>
<span id="cb73-378"><a href="#cb73-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-381"><a href="#cb73-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-382"><a href="#cb73-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-contrasts</span></span>
<span id="cb73-383"><a href="#cb73-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: The difference in slope corresponds to which level is coded as 0 (dummy coding) or -5/-1 (sum coding)</span></span>
<span id="cb73-384"><a href="#cb73-384" aria-hidden="true" tabindex="-1"></a>fig_sum1 <span class="ot">&lt;-</span></span>
<span id="cb73-385"><a href="#cb73-385" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-386"><a href="#cb73-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_subject =</span> <span class="fu">if_else</span>(age_subject<span class="sc">==</span><span class="st">"young"</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb73-387"><a href="#cb73-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb73-388"><a href="#cb73-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age_subject, <span class="at">y =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">+</span></span>
<span id="cb73-389"><a href="#cb73-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sum contrasts"</span>) <span class="sc">+</span></span>
<span id="cb73-390"><a href="#cb73-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb73-391"><a href="#cb73-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb73-392"><a href="#cb73-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="fu">aes</span>(<span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb73-393"><a href="#cb73-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb73-394"><a href="#cb73-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-395"><a href="#cb73-395" aria-hidden="true" tabindex="-1"></a>fig_sum5 <span class="ot">&lt;-</span></span>
<span id="cb73-396"><a href="#cb73-396" aria-hidden="true" tabindex="-1"></a>df_freq_eng <span class="sc">|&gt;</span> </span>
<span id="cb73-397"><a href="#cb73-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_subject =</span> <span class="fu">if_else</span>(age_subject<span class="sc">==</span><span class="st">"young"</span>,<span class="sc">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>)) <span class="sc">|&gt;</span></span>
<span id="cb73-398"><a href="#cb73-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb73-399"><a href="#cb73-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age_subject, <span class="at">y =</span> <span class="fu">exp</span>(rt_lexdec)) <span class="sc">+</span></span>
<span id="cb73-400"><a href="#cb73-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sum contrasts"</span>) <span class="sc">+</span></span>
<span id="cb73-401"><a href="#cb73-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb73-402"><a href="#cb73-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(.<span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb73-403"><a href="#cb73-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="fu">aes</span>(<span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb73-404"><a href="#cb73-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb73-405"><a href="#cb73-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-406"><a href="#cb73-406" aria-hidden="true" tabindex="-1"></a>fig_treatment <span class="sc">+</span> fig_sum5 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb73-407"><a href="#cb73-407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-408"><a href="#cb73-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-409"><a href="#cb73-409" aria-hidden="true" tabindex="-1"></a>As we see in @fig-contrasts, the sign of the slope depends on how we've contrast coded our factor levels. In @fig-contrasts A, the <span class="in">`old`</span> group is coded as $0$ and <span class="in">`young`</span> as $1$. In @fig-contrasts B, the <span class="in">`young`</span> group is coded as $-.5$ and the <span class="in">`old`</span> group as $+.5$.</span>
<span id="cb73-410"><a href="#cb73-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-411"><a href="#cb73-411" aria-hidden="true" tabindex="-1"></a>The intercept value is also now the overall mean of all observed reaction times, because now the $y$ value when $x$ equals zero lies in the middle of the two groups. The slope magnitude (i.e., size of the value) hasn't changed, because the difference betwen the two group means has not changed.</span>
<span id="cb73-412"><a href="#cb73-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-415"><a href="#cb73-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-416"><a href="#cb73-416" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">exp</span>(df_freq_eng<span class="sc">$</span>rt_lexdec))</span>
<span id="cb73-417"><a href="#cb73-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-418"><a href="#cb73-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-419"><a href="#cb73-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-420"><a href="#cb73-420" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exploring predicted values</span></span>
<span id="cb73-421"><a href="#cb73-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-422"><a href="#cb73-422" aria-hidden="true" tabindex="-1"></a>Let's also explore the predicted values of our model with a categorical variable.</span>
<span id="cb73-423"><a href="#cb73-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-426"><a href="#cb73-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-427"><a href="#cb73-427" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">fitted</span>(fit_age), <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb73-428"><a href="#cb73-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-429"><a href="#cb73-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-430"><a href="#cb73-430" aria-hidden="true" tabindex="-1"></a>We see that there are only 2 values, 630 and 787. These correspond to the means for each group that we saw above. They also seem to be in a pattern: young-mean, old-mean, young-mean, old-mean, etc. How does this correspond to the age group of the participant for the first ten observations?</span>
<span id="cb73-431"><a href="#cb73-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-434"><a href="#cb73-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-435"><a href="#cb73-435" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_freq_eng<span class="sc">$</span>age_subject, <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb73-436"><a href="#cb73-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-437"><a href="#cb73-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-438"><a href="#cb73-438" aria-hidden="true" tabindex="-1"></a>The first ten observations in our data are in young-old pairs. What are the first values in the raw data?</span>
<span id="cb73-439"><a href="#cb73-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-442"><a href="#cb73-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-443"><a href="#cb73-443" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">exp</span>(df_freq_eng<span class="sc">$</span>rt_lexdec), <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb73-444"><a href="#cb73-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-445"><a href="#cb73-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-446"><a href="#cb73-446" aria-hidden="true" tabindex="-1"></a>And what is the difference between these reaction times and the fitted values?</span>
<span id="cb73-447"><a href="#cb73-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-450"><a href="#cb73-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-451"><a href="#cb73-451" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">exp</span>(df_freq_eng<span class="sc">$</span>rt_lexdec), <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">-</span> <span class="fu">head</span>(<span class="fu">fitted</span>(fit_age), <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb73-452"><a href="#cb73-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-453"><a href="#cb73-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-456"><a href="#cb73-456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-457"><a href="#cb73-457" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">residuals</span>(fit_age))</span>
<span id="cb73-458"><a href="#cb73-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-459"><a href="#cb73-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-460"><a href="#cb73-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-461"><a href="#cb73-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-462"><a href="#cb73-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-463"><a href="#cb73-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-464"><a href="#cb73-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-465"><a href="#cb73-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-466"><a href="#cb73-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-467"><a href="#cb73-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-468"><a href="#cb73-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-469"><a href="#cb73-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-470"><a href="#cb73-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-471"><a href="#cb73-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-472"><a href="#cb73-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-473"><a href="#cb73-473" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb73-474"><a href="#cb73-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-475"><a href="#cb73-475" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>we saw that the equation for a straight line boils down to its intercept and slope</span>
<span id="cb73-476"><a href="#cb73-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-477"><a href="#cb73-477" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>we fit our first linear model with a categorical predictor</span>
<span id="cb73-478"><a href="#cb73-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-479"><a href="#cb73-479" aria-hidden="true" tabindex="-1"></a><span class="fu">### Important terms {.unnumbered .smaller}</span></span>
<span id="cb73-480"><a href="#cb73-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-483"><a href="#cb73-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-484"><a href="#cb73-484" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-485"><a href="#cb73-485" aria-hidden="true" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb73-486"><a href="#cb73-486" aria-hidden="true" tabindex="-1"></a> <span class="sc">~</span><span class="st">"term"</span>, <span class="sc">~</span><span class="st">"description/other terms"</span>,</span>
<span id="cb73-487"><a href="#cb73-487" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb73-488"><a href="#cb73-488" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>()</span>
<span id="cb73-489"><a href="#cb73-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-490"><a href="#cb73-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-491"><a href="#cb73-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-492"><a href="#cb73-492" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learning Objectives {.unnumbered .unlisted}</span></span>
<span id="cb73-493"><a href="#cb73-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-494"><a href="#cb73-494" aria-hidden="true" tabindex="-1"></a>Today we learned...</span>
<span id="cb73-495"><a href="#cb73-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-496"><a href="#cb73-496" aria-hidden="true" tabindex="-1"></a><span class="fu">## Task</span></span>
<span id="cb73-497"><a href="#cb73-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-498"><a href="#cb73-498" aria-hidden="true" tabindex="-1"></a>We'll use a dataset from @biondo_yesterday_2022, an eye-tracking reading study exploring the processing of adverb-tense concord in Spanish past and future tenses. Participants read sentences that began with a temporal adverb (e.g., yesterday/tomorrow), and had a verb marked with the congruent or incongruent tense (past/future).</span>
<span id="cb73-499"><a href="#cb73-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-500"><a href="#cb73-500" aria-hidden="true" tabindex="-1"></a>Load in the data.</span>
<span id="cb73-501"><a href="#cb73-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-504"><a href="#cb73-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-505"><a href="#cb73-505" aria-hidden="true" tabindex="-1"></a>df_tense <span class="ot">&lt;-</span></span>
<span id="cb73-506"><a href="#cb73-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"Biondo.Soilemezidi.Mancini_dataset_ET.csv"</span>),</span>
<span id="cb73-507"><a href="#cb73-507" aria-hidden="true" tabindex="-1"></a>           <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">"Latin1"</span>) <span class="co"># for special characters in Spanish</span></span>
<span id="cb73-508"><a href="#cb73-508" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">|&gt;</span> </span>
<span id="cb73-509"><a href="#cb73-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gramm =</span> <span class="fu">ifelse</span>(gramm <span class="sc">==</span> <span class="st">"0"</span>, <span class="st">"ungramm"</span>, <span class="st">"gramm"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb73-510"><a href="#cb73-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb73-511"><a href="#cb73-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-512"><a href="#cb73-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-513"><a href="#cb73-513" aria-hidden="true" tabindex="-1"></a><span class="fu">### Treatment contrasts</span></span>
<span id="cb73-514"><a href="#cb73-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-515"><a href="#cb73-515" aria-hidden="true" tabindex="-1"></a>We will look at the measure *total reading time* (`tt`) at the *verb* region (<span class="in">`roi == 4`</span>). Subset the data to only include the verb region.</span>
<span id="cb73-516"><a href="#cb73-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-519"><a href="#cb73-519" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-520"><a href="#cb73-520" aria-hidden="true" tabindex="-1"></a>df_verb <span class="ot">&lt;-</span></span>
<span id="cb73-521"><a href="#cb73-521" aria-hidden="true" tabindex="-1"></a>  df_tense <span class="sc">|&gt;</span> </span>
<span id="cb73-522"><a href="#cb73-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(roi <span class="sc">==</span> <span class="dv">4</span>)</span>
<span id="cb73-523"><a href="#cb73-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-524"><a href="#cb73-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-525"><a href="#cb73-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-526"><a href="#cb73-526" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Run a simple linear model with (log-transformed) total reading time (<span class="in">`tt`</span>) as an independent variable and grammaticality (<span class="in">`gramm`</span>) as a dependent variable. Use treatment contrasts.</span>
<span id="cb73-527"><a href="#cb73-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-528"><a href="#cb73-528" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Inspect your coefficients again. What conclusions do you draw?</span>
<span id="cb73-529"><a href="#cb73-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-530"><a href="#cb73-530" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Run model diagnostics:</span>
<span id="cb73-531"><a href="#cb73-531" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>check model assumptions where relevant (normality, constant variance, collinearity)</span>
<span id="cb73-532"><a href="#cb73-532" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>check model fit ($R^2$)</span>
<span id="cb73-533"><a href="#cb73-533" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb73-534"><a href="#cb73-534" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sum contrasts</span></span>
<span id="cb73-535"><a href="#cb73-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-536"><a href="#cb73-536" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Re-run your model with sum contrasts.</span>
<span id="cb73-537"><a href="#cb73-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-538"><a href="#cb73-538" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Inspect your coefficients again. Do your conclusions change?</span>
<span id="cb73-539"><a href="#cb73-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-540"><a href="#cb73-540" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Re-run your model diagnostics. How does it compare to your first model?</span>
<span id="cb73-541"><a href="#cb73-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-542"><a href="#cb73-542" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multiple regression</span></span>
<span id="cb73-543"><a href="#cb73-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-544"><a href="#cb73-544" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Add verb tense (<span class="in">`verb_t`</span>: past, future) as a predictor, including an interaction term. Use sum contrasts.</span>
<span id="cb73-545"><a href="#cb73-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-546"><a href="#cb73-546" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Inspect your coefficients again. Do your conclusions change?</span>
<span id="cb73-547"><a href="#cb73-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-548"><a href="#cb73-548" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Re-run your model diagnostics.  How does it compare to the last models?</span>
<span id="cb73-549"><a href="#cb73-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-550"><a href="#cb73-550" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session Info {.unnumbered visibility="uncounted"}</span></span>
<span id="cb73-551"><a href="#cb73-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-554"><a href="#cb73-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-555"><a href="#cb73-555" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb73-556"><a href="#cb73-556" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-557"><a href="#cb73-557" aria-hidden="true" tabindex="-1"></a><span class="fu">RStudio.Version</span>()<span class="sc">$</span>version</span>
<span id="cb73-558"><a href="#cb73-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-559"><a href="#cb73-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-560"><a href="#cb73-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-561"><a href="#cb73-561" aria-hidden="true" tabindex="-1"></a>Developed with Quarto using <span class="in">`r R.version.string`</span> (<span class="in">`r R.version$nickname`</span>) and RStudio version 2023.9.0.463 (Desert Sunflower), and the following packages:</span>
<span id="cb73-562"><a href="#cb73-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-565"><a href="#cb73-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-566"><a href="#cb73-566" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb73-567"><a href="#cb73-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-568"><a href="#cb73-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-569"><a href="#cb73-569" aria-hidden="true" tabindex="-1"></a><span class="fu">## References {.unlisted .unnumbered visibility="uncounted"}</span></span>
<span id="cb73-570"><a href="#cb73-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-571"><a href="#cb73-571" aria-hidden="true" tabindex="-1"></a>::: {#refs custom-style="Bibliography"}</span>
<span id="cb73-572"><a href="#cb73-572" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>